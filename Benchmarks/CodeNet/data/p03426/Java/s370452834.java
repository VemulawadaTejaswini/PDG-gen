import java.util.*;public class Main{public static void main(String[] z){Scanner s=new Scanner(System.in);int H=s.nextInt();int W=s.nextInt();int D=s.nextInt();int[] h=new int[H*W*W];int[] w=new int[H*W*W];for(int c=0;c<H;c++){for(int d =0;d<W;d++){int A=s.nextInt();h[A]=c;w[A]=d;}}ArrayList<ArrayList<Integer>> e=new ArrayList<ArrayList<Integer>>();for(int d=1;d<=D;d++){ArrayList<Integer> f=new ArrayList<Integer>();f.add(0);int p=0;int g=1;if(d>H*W%D){g++;}for(int a=0;a<(H*W)/D+g;a++){int u=d+a*D;int x=h[u];int y=w[u];int i=h[u+D];int j=w[u+D];p=p+Math.abs(x-i)+Math.abs(y-j);f.add(p);}e.add(f);}int Q=s.nextInt();for(int i=0;i<Q;i++){int L=s.nextInt()-1;int R=s.nextInt()-1;System.out.println(e.get(L%D).get(R/D)-e.get(L%D).get(L/D));}}}