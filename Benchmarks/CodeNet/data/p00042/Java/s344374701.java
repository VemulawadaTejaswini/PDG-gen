import java.util.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);for(int c=1,n,m,i,w;(n=s.nextInt()+1)>1;++c){int[][]d=new int[m=s.nextInt()+1][n],t=new int[m][2];for(i=1;i<m;t[i][0]=new Integer(z[0]),t[i++][1]=new Integer(z[1]))z=s.next().split(",");for(i=1;i<m;i++)for(w=t[i][1];w<n;w++)d[i][w]=Math.max(d[i-1][w-t[i][1]]+t[i][0],d[i-1][w]);System.out.printf("Case %d:\n%d\n%d\n",c,n=d[--m][--n],Arrays.binarySearch(d[m],n));}}}