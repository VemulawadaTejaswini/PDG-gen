import java.util.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);for(int n,m,i,k,c=1;(n=s.nextInt()+1)>1;++c){int[]d=new int[n],v;int[][]a=new int[m=s.nextInt()][2];for(;m-->0;a[m][0]=new Integer(z[0]),a[m][1]=new Integer(z[1]))z=s.next().split(",");for(int[]b:a)for(v=new int[n],i=b[1];i<n;++i)if(d[i]<(m=d[k=i-b[1]]+b[0])&&v[k]<1){d[i]=m;++v[i];}for(i=0,--n;d[i]!=d[n];++i);System.out.println("Case "+c+":\n"+d[n]+"\n"+i);}}}