import java.util.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);int n=s.nextInt()+1,l,i,j,c;int[][]a=new int[n][n];for(int[]b:a)Arrays.fill(b,n);for(i=1;i<n;++i)a[i][i]=0;for(i=1;i<n;++i)for(s.next(),j=s.nextInt();j-->0;)a[i][s.nextInt()]=1;for(c=1;c<n;++c)for(i=1;i<n;++i)for(j=1;j<n;++j)if((l=a[i][c]+a[c][j])<a[i][j])a[i][j]=l;for(n=s.nextInt();n-->0;)System.out.println((l=a[s.nextInt()][s.nextInt()])<s.nextInt()&&l>=0?l+1:"NA");}}