import java.util.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);for(int t=1,W,v,w,i,n;(W=s.nextInt())>0;System.out.printf("Case %d:\n%d\n%d\n",t++,v,w)){int[]d=new int[W+1];for(n=s.nextInt();n-->0;)for(z=s.next().split(","),v=new Integer(z[0]),i=w=new Integer(z[1]),d[w]=d[w]>v?d[w]:v;i++<W-w;)if(d[i]>0)d[i+w]=Math.max(d[i+w],d[i]+v);for(v=w=0,W++;W-->0;)if(v<=d[W]){v=d[W];w=W;}}}}