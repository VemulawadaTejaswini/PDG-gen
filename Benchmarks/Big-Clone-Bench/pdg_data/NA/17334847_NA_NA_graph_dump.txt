Line_0 $$ Entry-->Line_1 $$ public class dummy [ CD ]
Line_1 $$ public class dummy -->Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException [ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_3 $$ String value = cookie.getValue()[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_3 $$ String value = cookie.getValue()[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_3 $$ String value = cookie.getValue()[ FD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_4 $$ System.out.println("original cookie: " + value)[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_5 $$ value = value.replace("%3A", ":")[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_5 $$ value = value.replace("%3A", ":")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_5 $$ value = value.replace("%3A", ":")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_5 $$ value = value.replace("%3A", ":")[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_5 $$ value = value.replace("%3A", ":")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_5 $$ value = value.replace("%3A", ":")[ FD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_6 $$ value = value.replace("%40", "@")[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_6 $$ value = value.replace("%40", "@")-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_6 $$ value = value.replace("%40", "@")-->Line_6 $$ value = value.replace("%40", "@")[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_6 $$ value = value.replace("%40", "@")-->Line_6 $$ value = value.replace("%40", "@")[ FD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_7 $$ System.out.println("cookie after replacement: " + value)[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_8 $$ String[] parts = value.split(":")[ CD ]
Line_8 $$ String[] parts = value.split(":")-->Line_8 $$ String[] parts = value.split(":")[ CD ]
Line_3 $$ String value = cookie.getValue()-->Line_8 $$ String[] parts = value.split(":")[ FD ]
Line_5 $$ value = value.replace("%3A", ":")-->Line_8 $$ String[] parts = value.split(":")[ FD ]
Line_6 $$ value = value.replace("%40", "@")-->Line_8 $$ String[] parts = value.split(":")[ FD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_9 $$ if (parts.length < 4)[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_10 $$ String email = parts[0][ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_11 $$ String nickname = parts[1][ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_12 $$ boolean admin = Boolean.getBoolean(parts[2].toLowerCase())[ CD ]
Line_12 $$ boolean admin = Boolean.getBoolean(parts[2].toLowerCase())-->Line_12 $$ boolean admin = Boolean.getBoolean(parts[2].toLowerCase())[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_13 $$ String hsh = parts[3][ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_14 $$ boolean valid_cookie = true[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_15 $$ String cookie_secret = System.getProperty("COOKIE_SECRET")[ CD ]
Line_15 $$ String cookie_secret = System.getProperty("COOKIE_SECRET")-->Line_15 $$ String cookie_secret = System.getProperty("COOKIE_SECRET")[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_16 $$ if (cookie_secret == "")[ CD ]
Line_15 $$ String cookie_secret = System.getProperty("COOKIE_SECRET")-->Line_16 $$ if (cookie_secret == "")[ FD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_17 $$ if (email.equals("")) [ CD ]
Line_10 $$ String email = parts[0]-->Line_17 $$ if (email.equals("")) [ FD ]
Line_17 $$ if (email.equals("")) -->Line_17 $$ if (email.equals("")) [ CD ]
Line_10 $$ String email = parts[0]-->Line_17 $$ if (email.equals("")) [ FD ]
Line_17 $$ if (email.equals("")) -->Line_18 $$ System.out.println("email is empty!")[ CD ]
Line_17 $$ if (email.equals("")) -->Line_19 $$ nickname = ""[ CD ]
Line_11 $$ String nickname = parts[1]-->Line_19 $$ nickname = ""[ FD ]
Line_19 $$ nickname = ""-->Line_19 $$ nickname = ""[ FD ]
Line_17 $$ if (email.equals("")) -->Line_20 $$ admin = false[ CD ]
Line_12 $$ boolean admin = Boolean.getBoolean(parts[2].toLowerCase())-->Line_20 $$ admin = false[ FD ]
Line_20 $$ admin = false-->Line_20 $$ admin = false[ FD ]
Line_23 $$ MessageDigest sha = MessageDigest.getInstance("SHA")-->Line_23 $$ MessageDigest sha = MessageDigest.getInstance("SHA")[ CD ]
Line_23 $$ MessageDigest sha = MessageDigest.getInstance("SHA")-->Line_24 $$ sha.update((email + nickname + admin + cookie_secret).getBytes())[ FD ]
Line_23 $$ MessageDigest sha = MessageDigest.getInstance("SHA")-->Line_26 $$ for (byte b : sha.digest()) [ FD ]
Line_27 $$ byte tmphigh = (byte) (b >> 4)-->Line_28 $$ tmphigh = (byte) (tmphigh & 0xf)[ FD ]
Line_28 $$ tmphigh = (byte) (tmphigh & 0xf)-->Line_28 $$ tmphigh = (byte) (tmphigh & 0xf)[ FD ]
Line_25 $$ StringBuilder builder = new StringBuilder()-->Line_29 $$ builder.append(hextab.charAt(tmphigh))[ FD ]
Line_27 $$ byte tmphigh = (byte) (b >> 4)-->Line_29 $$ builder.append(hextab.charAt(tmphigh))[ FD ]
Line_28 $$ tmphigh = (byte) (tmphigh & 0xf)-->Line_29 $$ builder.append(hextab.charAt(tmphigh))[ FD ]
Line_25 $$ StringBuilder builder = new StringBuilder()-->Line_31 $$ builder.append(hextab.charAt(tmplow))[ FD ]
Line_30 $$ byte tmplow = (byte) (b & 0xf)-->Line_31 $$ builder.append(hextab.charAt(tmplow))[ FD ]
Line_34 $$ String vhsh = builder.toString()-->Line_34 $$ String vhsh = builder.toString()[ CD ]
Line_25 $$ StringBuilder builder = new StringBuilder()-->Line_34 $$ String vhsh = builder.toString()[ FD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_35 $$ if (!vhsh.equals(hsh)) [ CD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_35 $$ if (!vhsh.equals(hsh)) [ CD ]
Line_34 $$ String vhsh = builder.toString()-->Line_35 $$ if (!vhsh.equals(hsh)) [ FD ]
Line_13 $$ String hsh = parts[3]-->Line_35 $$ if (!vhsh.equals(hsh)) [ FD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_36 $$ System.out.println("hash not same!")[ CD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_37 $$ System.out.println("hash passed in: " + hsh)[ CD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_38 $$ System.out.println("hash generated: " + vhsh)[ CD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_39 $$ valid_cookie = false[ CD ]
Line_14 $$ boolean valid_cookie = true-->Line_39 $$ valid_cookie = false[ FD ]
Line_39 $$ valid_cookie = false-->Line_39 $$ valid_cookie = false[ FD ]
Line_35 $$ if (!vhsh.equals(hsh)) -->Line_40 $$ System.out.println("cookie match!")[ CD ]
Line_2 $$ private static MyCookieData parseCookie(Cookie cookie) throws CookieException -->Line_44 $$ return new MyCookieData(email, admin, nickname, valid_cookie)[ CD ]
