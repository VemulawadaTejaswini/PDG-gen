Line_0 $$ Entry-->Line_1 $$ public class dummy [ CD ]
Line_1 $$ public class dummy -->Line_2 $$ protected long incrementInDatabase(Object type) [ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_3 $$ long current_value[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_4 $$ long new_value[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_5 $$ String entry[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_6 $$ if (global_entry != null)[ CD ]
Line_6 $$ if (global_entry != null)-->Line_6 $$ entry = global_entry[ CD ]
Line_5 $$ String entry-->Line_6 $$ entry = global_entry[ FD ]
Line_6 $$ entry = global_entry-->Line_6 $$ entry = global_entry[ FD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_7 $$ String lkw = (String) properties.get("net.ontopia.topicmaps.impl.rdbms.HighLowKeyGenerator.SelectSuffix")[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_8 $$ String sql_select[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_9 $$ if (lkw == null && (database.equals("sqlserver"))) [ CD ]
Line_9 $$ if (lkw == null && (database.equals("sqlserver"))) -->Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"[ CD ]
Line_8 $$ String sql_select-->Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"[ FD ]
Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"-->Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"[ FD ]
Line_9 $$ if (lkw == null && (database.equals("sqlserver"))) -->Line_12 $$ if (lkw == null) [ CD ]
Line_7 $$ String lkw = (String) properties.get("net.ontopia.topicmaps.impl.rdbms.HighLowKeyGenerator.SelectSuffix")-->Line_12 $$ if (lkw == null) [ FD ]
Line_12 $$ if (lkw == null) -->Line_13 $$ if (database.equals("sapdb"))[ CD ]
Line_13 $$ if (database.equals("sapdb"))-->Line_13 $$ if (database.equals("sapdb"))[ CD ]
Line_13 $$ if (database.equals("sapdb"))-->Line_13 $$ lkw = "with lock"[ CD ]
Line_7 $$ String lkw = (String) properties.get("net.ontopia.topicmaps.impl.rdbms.HighLowKeyGenerator.SelectSuffix")-->Line_13 $$ lkw = "with lock"[ FD ]
Line_13 $$ lkw = "with lock"-->Line_13 $$ lkw = "with lock"[ FD ]
Line_13 $$ if (database.equals("sapdb"))-->Line_13 $$ lkw = "for update"[ CD ]
Line_7 $$ String lkw = (String) properties.get("net.ontopia.topicmaps.impl.rdbms.HighLowKeyGenerator.SelectSuffix")-->Line_13 $$ lkw = "for update"[ FD ]
Line_13 $$ lkw = "with lock"-->Line_13 $$ lkw = "for update"[ FD ]
Line_13 $$ lkw = "for update"-->Line_13 $$ lkw = "for update"[ FD ]
Line_9 $$ if (lkw == null && (database.equals("sqlserver"))) -->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ CD ]
Line_8 $$ String sql_select-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_7 $$ String lkw = (String) properties.get("net.ontopia.topicmaps.impl.rdbms.HighLowKeyGenerator.SelectSuffix")-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_13 $$ lkw = "with lock"-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_13 $$ lkw = "for update"-->Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw[ FD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_17 $$ if (log.isDebugEnabled())[ CD ]
Line_17 $$ if (log.isDebugEnabled())-->Line_17 $$ if (log.isDebugEnabled())[ CD ]
Line_17 $$ if (log.isDebugEnabled())-->Line_17 $$ log.debug("KeyGenerator: retrieving: " + sql_select)[ CD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_18 $$ Connection conn = null[ CD ]
Line_18 $$ Connection conn = null-->Line_20 $$ conn = connfactory.requestConnection()[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_20 $$ conn = connfactory.requestConnection()[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_20 $$ conn = connfactory.requestConnection()[ CD ]
Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ CD ]
Line_18 $$ Connection conn = null-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ FD ]
Line_8 $$ String sql_select-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ FD ]
Line_10 $$ sql_select = "select " + valcol + " from " + table + " with (XLOCK) where " + keycol + " = ?"-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ FD ]
Line_15 $$ sql_select = "select " + valcol + " from " + table + " where " + keycol + " = ? " + lkw-->Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)[ FD ]
Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)-->Line_23 $$ stm1.setString(1, entry)[ FD ]
Line_5 $$ String entry-->Line_23 $$ stm1.setString(1, entry)[ FD ]
Line_6 $$ entry = global_entry-->Line_23 $$ stm1.setString(1, entry)[ FD ]
Line_24 $$ ResultSet rs = stm1.executeQuery()-->Line_24 $$ ResultSet rs = stm1.executeQuery()[ CD ]
Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)-->Line_24 $$ ResultSet rs = stm1.executeQuery()[ FD ]
Line_25 $$ if (!rs.next())-->Line_25 $$ if (!rs.next())[ CD ]
Line_25 $$ if (!rs.next())-->Line_25 $$ if (!rs.next())[ CD ]
Line_24 $$ ResultSet rs = stm1.executeQuery()-->Line_25 $$ if (!rs.next())[ FD ]
Line_3 $$ long current_value-->Line_26 $$ current_value = rs.getLong(1)[ FD ]
Line_26 $$ current_value = rs.getLong(1)-->Line_26 $$ current_value = rs.getLong(1)[ FD ]
Line_26 $$ current_value = rs.getLong(1)-->Line_26 $$ current_value = rs.getLong(1)[ CD ]
Line_24 $$ ResultSet rs = stm1.executeQuery()-->Line_26 $$ current_value = rs.getLong(1)[ FD ]
Line_24 $$ ResultSet rs = stm1.executeQuery()-->Line_27 $$ rs.close()[ FD ]
Line_21 $$ PreparedStatement stm1 = conn.prepareStatement(sql_select)-->Line_29 $$ stm1.close()[ FD ]
Line_4 $$ long new_value-->Line_31 $$ new_value = current_value + grabsize[ FD ]
Line_31 $$ new_value = current_value + grabsize-->Line_31 $$ new_value = current_value + grabsize[ FD ]
Line_3 $$ long current_value-->Line_31 $$ new_value = current_value + grabsize[ FD ]
Line_26 $$ current_value = rs.getLong(1)-->Line_31 $$ new_value = current_value + grabsize[ FD ]
Line_33 $$ if (log.isDebugEnabled())-->Line_33 $$ if (log.isDebugEnabled())[ CD ]
Line_33 $$ if (log.isDebugEnabled())-->Line_33 $$ log.debug("KeyGenerator: incrementing: " + sql_update)[ CD ]
Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)-->Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)[ CD ]
Line_18 $$ Connection conn = null-->Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)[ FD ]
Line_32 $$ String sql_update = "update " + table + " set " + valcol + " = ? where " + keycol + " = ?"-->Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)[ FD ]
Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)-->Line_36 $$ stm2.setLong(1, new_value)[ FD ]
Line_4 $$ long new_value-->Line_36 $$ stm2.setLong(1, new_value)[ FD ]
Line_31 $$ new_value = current_value + grabsize-->Line_36 $$ stm2.setLong(1, new_value)[ FD ]
Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)-->Line_37 $$ stm2.setString(2, entry)[ FD ]
Line_5 $$ String entry-->Line_37 $$ stm2.setString(2, entry)[ FD ]
Line_6 $$ entry = global_entry-->Line_37 $$ stm2.setString(2, entry)[ FD ]
Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)-->Line_38 $$ stm2.executeUpdate()[ FD ]
Line_34 $$ PreparedStatement stm2 = conn.prepareStatement(sql_update)-->Line_40 $$ stm2.close()[ FD ]
Line_18 $$ Connection conn = null-->Line_42 $$ conn.commit()[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_42 $$ conn.commit()[ FD ]
Line_18 $$ Connection conn = null-->Line_45 $$ if (conn != null)[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_45 $$ if (conn != null)[ FD ]
Line_45 $$ if (conn != null)-->Line_45 $$ conn.rollback()[ CD ]
Line_18 $$ Connection conn = null-->Line_45 $$ conn.rollback()[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_45 $$ conn.rollback()[ FD ]
Line_18 $$ Connection conn = null-->Line_50 $$ if (conn != null) [ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_50 $$ if (conn != null) [ FD ]
Line_18 $$ Connection conn = null-->Line_52 $$ conn.close()[ FD ]
Line_20 $$ conn = connfactory.requestConnection()-->Line_52 $$ conn.close()[ FD ]
Line_2 $$ protected long incrementInDatabase(Object type) -->Line_60 $$ return value[ CD ]
