Line_0 $$ Entry-->Line_1 $$ public class dummy [ CD ]
Line_1 $$ public class dummy -->Line_2 $$ protected boolean checkLogin(String username, String password) [ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_3 $$ log.debug("Called checkLogin with " + username)[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_4 $$ String urlIn = GeoNetworkContext.url + "/" + GeoNetworkContext.loginService + "?username=" + username + "&password=" + password[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_5 $$ Element results = null[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_6 $$ String cookieValue = null[ CD ]
Line_9 $$ URLConnection conn = url.openConnection()-->Line_9 $$ URLConnection conn = url.openConnection()[ CD ]
Line_8 $$ URL url = new URL(urlIn)-->Line_9 $$ URLConnection conn = url.openConnection()[ FD ]
Line_9 $$ URLConnection conn = url.openConnection()-->Line_10 $$ conn.setConnectTimeout(1000)[ FD ]
Line_9 $$ URLConnection conn = url.openConnection()-->Line_11 $$ BufferedInputStream in = new BufferedInputStream(conn.getInputStream())[ FD ]
Line_5 $$ Element results = null-->Line_13 $$ results = Xml.loadStream(in)[ FD ]
Line_13 $$ results = Xml.loadStream(in)-->Line_13 $$ results = Xml.loadStream(in)[ FD ]
Line_13 $$ results = Xml.loadStream(in)-->Line_13 $$ results = Xml.loadStream(in)[ CD ]
Line_11 $$ BufferedInputStream in = new BufferedInputStream(conn.getInputStream())-->Line_13 $$ results = Xml.loadStream(in)[ FD ]
Line_5 $$ Element results = null-->Line_14 $$ log.debug("CheckLogin to GeoNetwork returned " + Xml.getString(results))[ FD ]
Line_13 $$ results = Xml.loadStream(in)-->Line_14 $$ log.debug("CheckLogin to GeoNetwork returned " + Xml.getString(results))[ FD ]
Line_11 $$ BufferedInputStream in = new BufferedInputStream(conn.getInputStream())-->Line_16 $$ in.close()[ FD ]
Line_18 $$ Map<String, List<String>> headers = conn.getHeaderFields()-->Line_18 $$ Map<String, List<String>> headers = conn.getHeaderFields()[ CD ]
Line_9 $$ URLConnection conn = url.openConnection()-->Line_18 $$ Map<String, List<String>> headers = conn.getHeaderFields()[ FD ]
Line_19 $$ List<String> values = headers.get("Set-Cookie")-->Line_19 $$ List<String> values = headers.get("Set-Cookie")[ CD ]
Line_18 $$ Map<String, List<String>> headers = conn.getHeaderFields()-->Line_19 $$ List<String> values = headers.get("Set-Cookie")[ FD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) [ CD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) [ CD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) [ CD ]
Line_19 $$ List<String> values = headers.get("Set-Cookie")-->Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) [ FD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_21 $$ String v = (String) iter.next()[ CD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_21 $$ String v = (String) iter.next()[ FD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_22 $$ if (cookieValue == null) [ CD ]
Line_6 $$ String cookieValue = null-->Line_22 $$ if (cookieValue == null) [ FD ]
Line_22 $$ if (cookieValue == null) -->Line_23 $$ cookieValue = v[ CD ]
Line_23 $$ cookieValue = v-->Line_23 $$ cookieValue = v[ FD ]
Line_6 $$ String cookieValue = null-->Line_23 $$ cookieValue = v[ FD ]
Line_21 $$ String v = (String) iter.next()-->Line_23 $$ cookieValue = v[ FD ]
Line_22 $$ if (cookieValue == null) -->Line_25 $$ cookieValue = cookieValue + ";" + v[ CD ]
Line_23 $$ cookieValue = v-->Line_25 $$ cookieValue = cookieValue + ";" + v[ FD ]
Line_25 $$ cookieValue = cookieValue + ";" + v-->Line_25 $$ cookieValue = cookieValue + ";" + v[ FD ]
Line_6 $$ String cookieValue = null-->Line_25 $$ cookieValue = cookieValue + ";" + v[ FD ]
Line_21 $$ String v = (String) iter.next()-->Line_25 $$ cookieValue = cookieValue + ";" + v[ FD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_31 $$ if (!results.getName().equals("ok"))[ CD ]
Line_31 $$ if (!results.getName().equals("ok"))-->Line_31 $$ if (!results.getName().equals("ok"))[ CD ]
Line_31 $$ if (!results.getName().equals("ok"))-->Line_31 $$ if (!results.getName().equals("ok"))[ CD ]
Line_5 $$ Element results = null-->Line_31 $$ if (!results.getName().equals("ok"))[ FD ]
Line_13 $$ results = Xml.loadStream(in)-->Line_31 $$ if (!results.getName().equals("ok"))[ FD ]
Line_31 $$ if (!results.getName().equals("ok"))-->Line_31 $$ return false[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_32 $$ Session session = getConnection().getSession()[ CD ]
Line_32 $$ Session session = getConnection().getSession()-->Line_32 $$ Session session = getConnection().getSession()[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_33 $$ session.removeAttribute("usercookie.object")[ CD ]
Line_32 $$ Session session = getConnection().getSession()-->Line_33 $$ session.removeAttribute("usercookie.object")[ FD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_34 $$ session.setAttribute("usercookie.object", cookieValue)[ CD ]
Line_32 $$ Session session = getConnection().getSession()-->Line_34 $$ session.setAttribute("usercookie.object", cookieValue)[ FD ]
Line_23 $$ cookieValue = v-->Line_34 $$ session.setAttribute("usercookie.object", cookieValue)[ FD ]
Line_25 $$ cookieValue = cookieValue + ";" + v-->Line_34 $$ session.setAttribute("usercookie.object", cookieValue)[ FD ]
Line_6 $$ String cookieValue = null-->Line_34 $$ session.setAttribute("usercookie.object", cookieValue)[ FD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_35 $$ log.debug("Cookie set is " + cookieValue)[ CD ]
Line_2 $$ protected boolean checkLogin(String username, String password) -->Line_36 $$ return true[ CD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) [ FD ]
Line_20 $$ for (Iterator iter = values.iterator(); iter.hasNext(); ) -->Line_21 $$ String v = (String) iter.next()[ FD ]
Line_23 $$ cookieValue = v-->Line_22 $$ if (cookieValue == null) [ FD ]
Line_25 $$ cookieValue = cookieValue + ";" + v-->Line_22 $$ if (cookieValue == null) [ FD ]
Line_21 $$ String v = (String) iter.next()-->Line_23 $$ cookieValue = v[ FD ]
Line_21 $$ String v = (String) iter.next()-->Line_25 $$ cookieValue = cookieValue + ";" + v[ FD ]
