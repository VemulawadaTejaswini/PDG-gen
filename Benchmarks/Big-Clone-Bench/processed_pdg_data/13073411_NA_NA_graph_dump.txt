Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_3 $$ Writer out = null [CD]
Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_4 $$ PreparedStatement ps = null [CD]
Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_5 $$ DatabaseAdapter dbDyn = null [CD]
Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_7 $$ AuthSession auth_ = (AuthSession) renderRequest.getUserPrincipal() [FD]
Line_7 $$ AuthSession auth_ = (AuthSession) renderRequest.getUserPrincipal() --> Line_8 $$ if (auth_ == null || !auth_.isUserInRole("webmill.upload_image")) [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_12 $$ dbDyn = DatabaseAdapter.getInstance() [FD]
Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_13 $$ String index_page = PortletService.url("mill.image.index", renderRequest, renderResponse) [FD]
Line_7 $$ AuthSession auth_ = (AuthSession) renderRequest.getUserPrincipal() --> Line_14 $$ log.debug("right to commit image - " + auth_.isUserInRole("webmill.upload_image")) [FD]
Line_2 $$ public void render(RenderRequest renderRequest, RenderResponse renderResponse) throws PortletException --> Line_15 $$ PortletSession sess = renderRequest.getPortletSession(true) [FD]
Line_15 $$ PortletSession sess = renderRequest.getPortletSession(true) --> Line_16 $$ if ((sess.getAttribute("MILL.IMAGE.ID_MAIN") == null) || (sess.getAttribute("MILL.IMAGE.DESC_IMAGE") == null)) [FD]
Line_16 $$ if ((sess.getAttribute("MILL.IMAGE.ID_MAIN") == null) || (sess.getAttribute("MILL.IMAGE.DESC_IMAGE") == null)) --> Line_17 $$ out.write("Not all parametrs initialized") [CD]
Line_3 $$ Writer out = null --> Line_17 $$ out.write("Not all parametrs initialized") [FD]
Line_16 $$ if ((sess.getAttribute("MILL.IMAGE.ID_MAIN") == null) || (sess.getAttribute("MILL.IMAGE.DESC_IMAGE") == null)) --> Line_18 $$ return [CD]
Line_15 $$ PortletSession sess = renderRequest.getPortletSession(true) --> Line_20 $$ Long id_main = (Long) sess.getAttribute("MILL.IMAGE.ID_MAIN") [FD]
Line_15 $$ PortletSession sess = renderRequest.getPortletSession(true) --> Line_21 $$ String desc = ((String) sess.getAttribute("MILL.IMAGE.DESC_IMAGE")) [FD]
Line_23 $$ CustomSequenceType seq = new CustomSequenceType() --> Line_24 $$ seq.setSequenceName("seq_image_number_file") [FD]
Line_23 $$ CustomSequenceType seq = new CustomSequenceType() --> Line_25 $$ seq.setTableName("MAIN_FORUM_THREADS") [FD]
Line_23 $$ CustomSequenceType seq = new CustomSequenceType() --> Line_26 $$ seq.setColumnName("ID_THREAD") [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_27 $$ Long currID = dbDyn.getSequenceNextValue(seq) [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_27 $$ Long currID = dbDyn.getSequenceNextValue(seq) [FD]
Line_23 $$ CustomSequenceType seq = new CustomSequenceType() --> Line_27 $$ Long currID = dbDyn.getSequenceNextValue(seq) [FD]
Line_3 $$ Writer out = null --> Line_37 $$ out.write("<html><head></head<body>" + "Error while processing this page:<br>" + ExceptionTools.getStackTrace(e, 20, "<br>") + "<br>" + "<p><a href=\"" + index_page + "\">continue</a></p>" + "</body></html>") [FD]
Line_7 $$ AuthSession auth_ = (AuthSession) renderRequest.getUserPrincipal() --> Line_41 $$ UserInfo userInfo = auth_.getUserInfo() [FD]
Line_42 $$ CustomSequenceType seqImageDir = new CustomSequenceType() --> Line_43 $$ seqImageDir.setSequenceName("seq_WM_image_dir") [FD]
Line_42 $$ CustomSequenceType seqImageDir = new CustomSequenceType() --> Line_44 $$ seqImageDir.setTableName("WM_IMAGE_DIR") [FD]
Line_42 $$ CustomSequenceType seqImageDir = new CustomSequenceType() --> Line_45 $$ seqImageDir.setColumnName("ID_IMAGE_DIR") [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_46 $$ Long seqValue = dbDyn.getSequenceNextValue(seqImageDir) [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_46 $$ Long seqValue = dbDyn.getSequenceNextValue(seqImageDir) [FD]
Line_42 $$ CustomSequenceType seqImageDir = new CustomSequenceType() --> Line_46 $$ Long seqValue = dbDyn.getSequenceNextValue(seqImageDir) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") [FD]
Line_4 $$ PreparedStatement ps = null --> Line_48 $$ RsetTools.setLong(ps, 1, seqValue) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_48 $$ RsetTools.setLong(ps, 1, seqValue) [FD]
Line_46 $$ Long seqValue = dbDyn.getSequenceNextValue(seqImageDir) --> Line_48 $$ RsetTools.setLong(ps, 1, seqValue) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_49 $$ RsetTools.setLong(ps, 2, userInfo.getCompanyId()) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_49 $$ RsetTools.setLong(ps, 2, userInfo.getCompanyId()) [FD]
Line_41 $$ UserInfo userInfo = auth_.getUserInfo() --> Line_49 $$ RsetTools.setLong(ps, 2, userInfo.getCompanyId()) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_50 $$ RsetTools.setLong(ps, 3, currID) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_50 $$ RsetTools.setLong(ps, 3, currID) [FD]
Line_27 $$ Long currID = dbDyn.getSequenceNextValue(seq) --> Line_50 $$ RsetTools.setLong(ps, 3, currID) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_51 $$ RsetTools.setLong(ps, 4, id_main) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_51 $$ RsetTools.setLong(ps, 4, id_main) [FD]
Line_20 $$ Long id_main = (Long) sess.getAttribute("MILL.IMAGE.ID_MAIN") --> Line_51 $$ RsetTools.setLong(ps, 4, id_main) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_52 $$ ps.setString(5, "/image/" + newFileName) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_52 $$ ps.setString(5, "/image/" + newFileName) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_53 $$ ps.setString(6, desc) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_53 $$ ps.setString(6, desc) [FD]
Line_21 $$ String desc = ((String) sess.getAttribute("MILL.IMAGE.DESC_IMAGE")) --> Line_53 $$ ps.setString(6, desc) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_54 $$ ps.executeUpdate() [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_54 $$ ps.executeUpdate() [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_55 $$ dbDyn.commit() [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_55 $$ dbDyn.commit() [FD]
Line_3 $$ Writer out = null --> Line_57 $$ out.write("Image successful uploaded") [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_61 $$ dbDyn.rollback() [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_61 $$ dbDyn.rollback() [FD]
Line_64 $$ final String es = "Error upload image" --> Line_65 $$ log.error(es, e) [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_68 $$ DatabaseManager.close(dbDyn, ps) [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_68 $$ DatabaseManager.close(dbDyn, ps) [FD]
Line_4 $$ PreparedStatement ps = null --> Line_68 $$ DatabaseManager.close(dbDyn, ps) [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_68 $$ DatabaseManager.close(dbDyn, ps) [FD]
Line_5 $$ DatabaseAdapter dbDyn = null --> Line_69 $$ dbDyn = null [FD]
Line_12 $$ dbDyn = DatabaseAdapter.getInstance() --> Line_69 $$ dbDyn = null [FD]
Line_4 $$ PreparedStatement ps = null --> Line_70 $$ ps = null [FD]
Line_47 $$ ps = dbDyn.prepareStatement("insert into WM_IMAGE_DIR " + "( ID_IMAGE_DIR, ID_FIRM, is_group, id, id_main, name_file, description )" + "(?, ?, 0, ?, ?, ?, ?") --> Line_70 $$ ps = null [FD]
