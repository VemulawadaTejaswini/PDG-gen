Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_3 $$ String target = null [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_4 $$ boolean allowedToAccess = false [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_6 $$ URL requestUrl = new URL("http:/" + request.getPathInfo()) [FD]
Line_7 $$ for (Enumeration en = allowedUrls.elements(); en.hasMoreElements(); ) --> Line_8 $$ URL nextUrl = (URL) en.nextElement() [CD]
Line_7 $$ for (Enumeration en = allowedUrls.elements(); en.hasMoreElements(); ) --> Line_8 $$ URL nextUrl = (URL) en.nextElement() [FD]
Line_7 $$ for (Enumeration en = allowedUrls.elements(); en.hasMoreElements(); ) --> Line_9 $$ if ((nextUrl).getHost().equalsIgnoreCase(requestUrl.getHost())) [CD]
Line_6 $$ URL requestUrl = new URL("http:/" + request.getPathInfo()) --> Line_9 $$ if ((nextUrl).getHost().equalsIgnoreCase(requestUrl.getHost())) [FD]
Line_9 $$ if ((nextUrl).getHost().equalsIgnoreCase(requestUrl.getHost())) --> Line_10 $$ allowedToAccess = true [CD]
Line_4 $$ boolean allowedToAccess = false --> Line_10 $$ allowedToAccess = true [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_14 $$ System.err.println("Error in url: " + "http:/" + request.getPathInfo()) [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_17 $$ if (!allowedToAccess) [CD]
Line_10 $$ allowedToAccess = true --> Line_17 $$ if (!allowedToAccess) [FD]
Line_4 $$ boolean allowedToAccess = false --> Line_17 $$ if (!allowedToAccess) [FD]
Line_17 $$ if (!allowedToAccess) --> Line_18 $$ response.setStatus(407) [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_18 $$ response.setStatus(407) [FD]
Line_17 $$ if (!allowedToAccess) --> Line_19 $$ return [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_21 $$ if (request.getPathInfo() != null && !request.getPathInfo().equals("")) [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_21 $$ if (request.getPathInfo() != null && !request.getPathInfo().equals("")) [FD]
Line_21 $$ if (request.getPathInfo() != null && !request.getPathInfo().equals("")) --> Line_22 $$ target = "http:/" + request.getPathInfo() + "?" + request.getQueryString() [CD]
Line_3 $$ String target = null --> Line_22 $$ target = "http:/" + request.getPathInfo() + "?" + request.getQueryString() [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_22 $$ target = "http:/" + request.getPathInfo() + "?" + request.getQueryString() [FD]
Line_21 $$ if (request.getPathInfo() != null && !request.getPathInfo().equals("")) --> Line_24 $$ response.setStatus(404) [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_24 $$ response.setStatus(404) [FD]
Line_21 $$ if (request.getPathInfo() != null && !request.getPathInfo().equals("")) --> Line_25 $$ return [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_27 $$ InputStream is = null [CD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_28 $$ ServletOutputStream out = null [CD]
Line_30 $$ URL url = new URL(target) --> Line_31 $$ URLConnection uc = url.openConnection() [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_32 $$ response.setContentType(uc.getContentType()) [FD]
Line_31 $$ URLConnection uc = url.openConnection() --> Line_32 $$ response.setContentType(uc.getContentType()) [FD]
Line_27 $$ InputStream is = null --> Line_33 $$ is = uc.getInputStream() [FD]
Line_31 $$ URLConnection uc = url.openConnection() --> Line_33 $$ is = uc.getInputStream() [FD]
Line_28 $$ ServletOutputStream out = null --> Line_34 $$ out = response.getOutputStream() [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_34 $$ out = response.getOutputStream() [FD]
Line_36 $$ int bytesRead --> Line_37 $$ while ((bytesRead = is.read(buf)) != -1) [FD]
Line_27 $$ InputStream is = null --> Line_37 $$ while ((bytesRead = is.read(buf)) != -1) [FD]
Line_33 $$ is = uc.getInputStream() --> Line_37 $$ while ((bytesRead = is.read(buf)) != -1) [FD]
Line_35 $$ byte[] buf = new byte[4096] --> Line_37 $$ while ((bytesRead = is.read(buf)) != -1) [FD]
Line_37 $$ while ((bytesRead = is.read(buf)) != -1) --> Line_38 $$ out.write(buf, 0, bytesRead) [CD]
Line_37 $$ while ((bytesRead = is.read(buf)) != -1) --> Line_38 $$ out.write(buf, 0, bytesRead) [FD]
Line_28 $$ ServletOutputStream out = null --> Line_38 $$ out.write(buf, 0, bytesRead) [FD]
Line_34 $$ out = response.getOutputStream() --> Line_38 $$ out.write(buf, 0, bytesRead) [FD]
Line_35 $$ byte[] buf = new byte[4096] --> Line_38 $$ out.write(buf, 0, bytesRead) [FD]
Line_36 $$ int bytesRead --> Line_38 $$ out.write(buf, 0, bytesRead) [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_41 $$ response.setStatus(404) [FD]
Line_2 $$ public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException --> Line_43 $$ response.setStatus(404) [FD]
Line_27 $$ InputStream is = null --> Line_45 $$ if (is != null) [FD]
Line_33 $$ is = uc.getInputStream() --> Line_45 $$ if (is != null) [FD]
Line_45 $$ if (is != null) --> Line_46 $$ is.close() [CD]
Line_27 $$ InputStream is = null --> Line_46 $$ is.close() [FD]
Line_33 $$ is = uc.getInputStream() --> Line_46 $$ is.close() [FD]
Line_28 $$ ServletOutputStream out = null --> Line_48 $$ if (out != null) [FD]
Line_34 $$ out = response.getOutputStream() --> Line_48 $$ if (out != null) [FD]
Line_48 $$ if (out != null) --> Line_49 $$ out.close() [CD]
Line_28 $$ ServletOutputStream out = null --> Line_49 $$ out.close() [FD]
Line_34 $$ out = response.getOutputStream() --> Line_49 $$ out.close() [FD]
