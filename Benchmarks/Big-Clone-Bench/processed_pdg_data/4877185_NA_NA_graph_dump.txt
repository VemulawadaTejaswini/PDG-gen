Line_2 $$ public byte[] getEncoded(X509Certificate checkCert, X509Certificate rootCert, String url) --> Line_5 $$ if (url == null) [FD]
Line_5 $$ if (url == null) --> Line_6 $$ url = PdfPKCS7.getOCSPURL(checkCert) [CD]
Line_2 $$ public byte[] getEncoded(X509Certificate checkCert, X509Certificate rootCert, String url) --> Line_6 $$ url = PdfPKCS7.getOCSPURL(checkCert) [FD]
Line_2 $$ public byte[] getEncoded(X509Certificate checkCert, X509Certificate rootCert, String url) --> Line_8 $$ if (url == null) [FD]
Line_6 $$ url = PdfPKCS7.getOCSPURL(checkCert) --> Line_8 $$ if (url == null) [FD]
Line_2 $$ public byte[] getEncoded(X509Certificate checkCert, X509Certificate rootCert, String url) --> Line_9 $$ OCSPReq request = generateOCSPRequest(rootCert, checkCert.getSerialNumber()) [FD]
Line_9 $$ OCSPReq request = generateOCSPRequest(rootCert, checkCert.getSerialNumber()) --> Line_10 $$ byte[] array = request.getEncoded() [FD]
Line_11 $$ URL urlt = new URL(url) --> Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_13 $$ con.setRequestProperty("Content-Type", "application/ocsp-request") [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_14 $$ con.setRequestProperty("Accept", "application/ocsp-response") [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_15 $$ con.setDoOutput(true) [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_16 $$ OutputStream out = con.getOutputStream() [FD]
Line_17 $$ DataOutputStream dataOut = new DataOutputStream(new BufferedOutputStream(out)) --> Line_18 $$ dataOut.write(array) [FD]
Line_10 $$ byte[] array = request.getEncoded() --> Line_18 $$ dataOut.write(array) [FD]
Line_17 $$ DataOutputStream dataOut = new DataOutputStream(new BufferedOutputStream(out)) --> Line_19 $$ dataOut.flush() [FD]
Line_17 $$ DataOutputStream dataOut = new DataOutputStream(new BufferedOutputStream(out)) --> Line_20 $$ dataOut.close() [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_21 $$ if (con.getResponseCode() / 100 != 2) [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_22 $$ throw new IOException(MessageLocalization.getComposedMessage("invalid.http.response.1", con.getResponseCode())) [FD]
Line_12 $$ HttpURLConnection con = (HttpURLConnection) urlt.openConnection() --> Line_24 $$ InputStream in = (InputStream) con.getContent() [FD]
Line_24 $$ InputStream in = (InputStream) con.getContent() --> Line_25 $$ OCSPResp ocspResponse = new OCSPResp(RandomAccessFileOrArray.InputStreamToArray(in)) [FD]
Line_25 $$ OCSPResp ocspResponse = new OCSPResp(RandomAccessFileOrArray.InputStreamToArray(in)) --> Line_26 $$ throw new IOException(MessageLocalization.getComposedMessage("invalid.status.1", ocspResponse.getStatus())) [FD]
Line_25 $$ OCSPResp ocspResponse = new OCSPResp(RandomAccessFileOrArray.InputStreamToArray(in)) --> Line_27 $$ BasicOCSPResp basicResponse = (BasicOCSPResp) ocspResponse.getResponseObject() [FD]
Line_27 $$ BasicOCSPResp basicResponse = (BasicOCSPResp) ocspResponse.getResponseObject() --> Line_28 $$ if (basicResponse != null) [FD]
Line_28 $$ if (basicResponse != null) --> Line_29 $$ SingleResp[] responses = basicResponse.getResponses() [CD]
Line_27 $$ BasicOCSPResp basicResponse = (BasicOCSPResp) ocspResponse.getResponseObject() --> Line_29 $$ SingleResp[] responses = basicResponse.getResponses() [FD]
Line_28 $$ if (basicResponse != null) --> Line_30 $$ if (responses.length == 1) [CD]
Line_30 $$ if (responses.length == 1) --> Line_31 $$ SingleResp resp = responses[0] [CD]
Line_30 $$ if (responses.length == 1) --> Line_32 $$ Object status = resp.getCertStatus() [CD]
Line_31 $$ SingleResp resp = responses[0] --> Line_32 $$ Object status = resp.getCertStatus() [FD]
Line_30 $$ if (responses.length == 1) --> Line_33 $$ if (status == CertificateStatus.GOOD) [CD]
Line_32 $$ Object status = resp.getCertStatus() --> Line_33 $$ if (status == CertificateStatus.GOOD) [FD]
Line_33 $$ if (status == CertificateStatus.GOOD) --> Line_34 $$ return basicResponse.getEncoded() [CD]
Line_27 $$ BasicOCSPResp basicResponse = (BasicOCSPResp) ocspResponse.getResponseObject() --> Line_34 $$ return basicResponse.getEncoded() [FD]
Line_33 $$ if (status == CertificateStatus.GOOD) --> Line_35 $$ if (status instanceof org.bouncycastle.ocsp.RevokedStatus) [CD]
Line_32 $$ Object status = resp.getCertStatus() --> Line_35 $$ if (status instanceof org.bouncycastle.ocsp.RevokedStatus) [FD]
Line_2 $$ public byte[] getEncoded(X509Certificate checkCert, X509Certificate rootCert, String url) --> Line_45 $$ return null [CD]
