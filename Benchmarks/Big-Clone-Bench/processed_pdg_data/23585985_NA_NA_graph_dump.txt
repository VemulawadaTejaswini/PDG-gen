Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_3 $$ StreamSource streamSource = new StreamSource() [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) [FD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_5 $$ LOG.debug("Streaming Java object") [CD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_6 $$ Object obj = ((JavaObjectValue) item).getObject() [CD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_7 $$ if (!(obj instanceof File)) [CD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_10 $$ File inputFile = (File) obj [CD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_11 $$ InputStream is = new FileInputStream(inputFile) [CD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_12 $$ streamSource.setInputStream(is) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_12 $$ streamSource.setInputStream(is) [FD]
Line_11 $$ InputStream is = new FileInputStream(inputFile) --> Line_12 $$ streamSource.setInputStream(is) [FD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_13 $$ streamSource.setSystemId(inputFile.toURI().toURL().toString()) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_13 $$ streamSource.setSystemId(inputFile.toURI().toURL().toString()) [FD]
Line_10 $$ File inputFile = (File) obj --> Line_13 $$ streamSource.setSystemId(inputFile.toURI().toURL().toString()) [FD]
Line_4 $$ if (item.getType() == Type.JAVA_OBJECT) --> Line_14 $$ if (item.getType() == Type.ANY_URI) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_14 $$ if (item.getType() == Type.ANY_URI) [FD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_15 $$ LOG.debug("Streaming xs:anyURI") [CD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_16 $$ String url = item.getStringValue() [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_16 $$ String url = item.getStringValue() [FD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_17 $$ if (url.startsWith("/")) [CD]
Line_16 $$ String url = item.getStringValue() --> Line_17 $$ if (url.startsWith("/")) [FD]
Line_17 $$ if (url.startsWith("/")) --> Line_18 $$ url = "xmldb:exist://" + url [CD]
Line_16 $$ String url = item.getStringValue() --> Line_18 $$ url = "xmldb:exist://" + url [FD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_20 $$ InputStream is = new URL(url).openStream() [CD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_21 $$ streamSource.setInputStream(is) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_21 $$ streamSource.setInputStream(is) [FD]
Line_11 $$ InputStream is = new FileInputStream(inputFile) --> Line_21 $$ streamSource.setInputStream(is) [FD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_22 $$ streamSource.setSystemId(url) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_22 $$ streamSource.setSystemId(url) [FD]
Line_16 $$ String url = item.getStringValue() --> Line_22 $$ streamSource.setSystemId(url) [FD]
Line_18 $$ url = "xmldb:exist://" + url --> Line_22 $$ streamSource.setSystemId(url) [FD]
Line_14 $$ if (item.getType() == Type.ANY_URI) --> Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) [FD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_24 $$ LOG.debug("Streaming element or document node") [CD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_25 $$ if (item instanceof NodeProxy) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_25 $$ if (item instanceof NodeProxy) [FD]
Line_25 $$ if (item instanceof NodeProxy) --> Line_26 $$ NodeProxy np = (NodeProxy) item [CD]
Line_26 $$ NodeProxy np = (NodeProxy) item --> Line_27 $$ String url = "xmldb:exist://" + np.getDocument().getBaseURI() [FD]
Line_25 $$ if (item instanceof NodeProxy) --> Line_28 $$ LOG.debug("Document detected, adding URL " + url) [CD]
Line_25 $$ if (item instanceof NodeProxy) --> Line_29 $$ streamSource.setSystemId(url) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_29 $$ streamSource.setSystemId(url) [FD]
Line_16 $$ String url = item.getStringValue() --> Line_29 $$ streamSource.setSystemId(url) [FD]
Line_18 $$ url = "xmldb:exist://" + url --> Line_29 $$ streamSource.setSystemId(url) [FD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_31 $$ Serializer serializer = context.getBroker().newSerializer() [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_31 $$ Serializer serializer = context.getBroker().newSerializer() [FD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_32 $$ NodeValue node = (NodeValue) item [CD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_34 $$ streamSource.setInputStream(is) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_34 $$ streamSource.setInputStream(is) [FD]
Line_11 $$ InputStream is = new FileInputStream(inputFile) --> Line_34 $$ streamSource.setInputStream(is) [FD]
Line_23 $$ if (item.getType() == Type.ELEMENT || item.getType() == Type.DOCUMENT) --> Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) [FD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_36 $$ LOG.debug("Streaming base64 binary") [CD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_37 $$ BinaryValue binary = (BinaryValue) item [CD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_38 $$ byte[] data = (byte[]) binary.toJavaObject(byte[].class) [CD]
Line_37 $$ BinaryValue binary = (BinaryValue) item --> Line_38 $$ byte[] data = (byte[]) binary.toJavaObject(byte[].class) [FD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_40 $$ streamSource.setInputStream(is) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_40 $$ streamSource.setInputStream(is) [FD]
Line_11 $$ InputStream is = new FileInputStream(inputFile) --> Line_40 $$ streamSource.setInputStream(is) [FD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_41 $$ if (item instanceof Base64BinaryDocument) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_41 $$ if (item instanceof Base64BinaryDocument) [FD]
Line_41 $$ if (item instanceof Base64BinaryDocument) --> Line_42 $$ Base64BinaryDocument b64doc = (Base64BinaryDocument) item [CD]
Line_42 $$ Base64BinaryDocument b64doc = (Base64BinaryDocument) item --> Line_43 $$ String url = "xmldb:exist://" + b64doc.getUrl() [FD]
Line_41 $$ if (item instanceof Base64BinaryDocument) --> Line_44 $$ LOG.debug("Base64BinaryDocument detected, adding URL " + url) [CD]
Line_41 $$ if (item instanceof Base64BinaryDocument) --> Line_45 $$ streamSource.setSystemId(url) [CD]
Line_3 $$ StreamSource streamSource = new StreamSource() --> Line_45 $$ streamSource.setSystemId(url) [FD]
Line_16 $$ String url = item.getStringValue() --> Line_45 $$ streamSource.setSystemId(url) [FD]
Line_18 $$ url = "xmldb:exist://" + url --> Line_45 $$ streamSource.setSystemId(url) [FD]
Line_35 $$ if (item.getType() == Type.BASE64_BINARY || item.getType() == Type.HEX_BINARY) --> Line_48 $$ LOG.error("Wrong item type " + Type.getTypeName(item.getType())) [CD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_48 $$ LOG.error("Wrong item type " + Type.getTypeName(item.getType())) [FD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_49 $$ throw new XPathException("wrong item type " + Type.getTypeName(item.getType())) [FD]
Line_2 $$ public static StreamSource getStreamSource(Item item, XQueryContext context) throws XPathException, MalformedURLException, IOException --> Line_51 $$ return streamSource [CD]
