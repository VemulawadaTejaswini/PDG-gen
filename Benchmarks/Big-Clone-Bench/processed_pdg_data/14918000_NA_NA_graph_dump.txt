Line_2 $$ public void invoke(MessageContext msgContext) throws AxisFault --> Line_3 $$ log.debug("Enter: MD5AttachHandler::invoke") [CD]
Line_2 $$ public void invoke(MessageContext msgContext) throws AxisFault --> Line_5 $$ Message msg = msgContext.getRequestMessage() [FD]
Line_2 $$ public void invoke(MessageContext msgContext) throws AxisFault --> Line_6 $$ SOAPConstants soapConstants = msgContext.getSOAPConstants() [FD]
Line_5 $$ Message msg = msgContext.getRequestMessage() --> Line_7 $$ org.apache.axis.message.SOAPEnvelope env = (org.apache.axis.message.SOAPEnvelope) msg.getSOAPEnvelope() [FD]
Line_7 $$ org.apache.axis.message.SOAPEnvelope env = (org.apache.axis.message.SOAPEnvelope) msg.getSOAPEnvelope() --> Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() [FD]
Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() --> Line_9 $$ org.w3c.dom.Element sbElement = sbe.getAsDOM() [FD]
Line_9 $$ org.w3c.dom.Element sbElement = sbe.getAsDOM() --> Line_10 $$ org.w3c.dom.Node n = sbElement.getFirstChild() [FD]
Line_10 $$ org.w3c.dom.Node n = sbElement.getFirstChild() --> Line_11 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) [FD]
Line_12 $$ org.w3c.dom.Element paramElement = (org.w3c.dom.Element) n --> Line_13 $$ String href = paramElement.getAttribute(soapConstants.getAttrHref()) [FD]
Line_6 $$ SOAPConstants soapConstants = msgContext.getSOAPConstants() --> Line_13 $$ String href = paramElement.getAttribute(soapConstants.getAttrHref()) [FD]
Line_13 $$ String href = paramElement.getAttribute(soapConstants.getAttrHref()) --> Line_14 $$ org.apache.axis.Part ap = msg.getAttachmentsImpl().getAttachmentByReference(href) [FD]
Line_5 $$ Message msg = msgContext.getRequestMessage() --> Line_14 $$ org.apache.axis.Part ap = msg.getAttachmentsImpl().getAttachmentByReference(href) [FD]
Line_14 $$ org.apache.axis.Part ap = msg.getAttachmentsImpl().getAttachmentByReference(href) --> Line_15 $$ javax.activation.DataHandler dh = org.apache.axis.attachments.AttachmentUtils.getActivationDataHandler(ap) [FD]
Line_12 $$ org.w3c.dom.Element paramElement = (org.w3c.dom.Element) n --> Line_16 $$ org.w3c.dom.Node timeNode = paramElement.getFirstChild() [FD]
Line_18 $$ if (timeNode != null && timeNode instanceof org.w3c.dom.Text) --> Line_19 $$ String startTimeStr = ((org.w3c.dom.Text) timeNode).getData() [CD]
Line_18 $$ if (timeNode != null && timeNode instanceof org.w3c.dom.Text) --> Line_20 $$ startTime = Long.parseLong(startTimeStr) [CD]
Line_17 $$ long startTime = -1 --> Line_20 $$ startTime = Long.parseLong(startTimeStr) [FD]
Line_19 $$ String startTimeStr = ((org.w3c.dom.Text) timeNode).getData() --> Line_20 $$ startTime = Long.parseLong(startTimeStr) [FD]
Line_17 $$ long startTime = -1 --> Line_24 $$ elapsedTime = receivedTime - startTime [FD]
Line_20 $$ startTime = Long.parseLong(startTimeStr) --> Line_24 $$ elapsedTime = receivedTime - startTime [FD]
Line_23 $$ long elapsedTime = -1 --> Line_24 $$ elapsedTime = receivedTime - startTime [FD]
Line_22 $$ long receivedTime = System.currentTimeMillis() --> Line_24 $$ elapsedTime = receivedTime - startTime [FD]
Line_15 $$ javax.activation.DataHandler dh = org.apache.axis.attachments.AttachmentUtils.getActivationDataHandler(ap) --> Line_27 $$ java.io.InputStream attachmentStream = dh.getInputStream() [FD]
Line_28 $$ int bread = 0 --> Line_30 $$ do [FD]
Line_30 $$ do --> Line_31 $$ bread = attachmentStream.read(buf) [CD]
Line_28 $$ int bread = 0 --> Line_31 $$ bread = attachmentStream.read(buf) [FD]
Line_27 $$ java.io.InputStream attachmentStream = dh.getInputStream() --> Line_31 $$ bread = attachmentStream.read(buf) [FD]
Line_29 $$ byte[] buf = new byte[64 * 1024] --> Line_31 $$ bread = attachmentStream.read(buf) [FD]
Line_30 $$ do --> Line_32 $$ if (bread > 0) [CD]
Line_31 $$ bread = attachmentStream.read(buf) --> Line_32 $$ if (bread > 0) [FD]
Line_28 $$ int bread = 0 --> Line_32 $$ if (bread > 0) [FD]
Line_32 $$ if (bread > 0) --> Line_33 $$ md.update(buf, 0, bread) [CD]
Line_26 $$ java.security.MessageDigest md = java.security.MessageDigest.getInstance("MD5") --> Line_33 $$ md.update(buf, 0, bread) [FD]
Line_29 $$ byte[] buf = new byte[64 * 1024] --> Line_33 $$ md.update(buf, 0, bread) [FD]
Line_31 $$ bread = attachmentStream.read(buf) --> Line_33 $$ md.update(buf, 0, bread) [FD]
Line_28 $$ int bread = 0 --> Line_33 $$ md.update(buf, 0, bread) [FD]
Line_27 $$ java.io.InputStream attachmentStream = dh.getInputStream() --> Line_36 $$ attachmentStream.close() [FD]
Line_29 $$ byte[] buf = new byte[64 * 1024] --> Line_37 $$ buf = null [FD]
Line_15 $$ javax.activation.DataHandler dh = org.apache.axis.attachments.AttachmentUtils.getActivationDataHandler(ap) --> Line_38 $$ String contentType = dh.getContentType() [FD]
Line_38 $$ String contentType = dh.getContentType() --> Line_39 $$ if (contentType != null && contentType.length() != 0) [FD]
Line_39 $$ if (contentType != null && contentType.length() != 0) --> Line_40 $$ md.update(contentType.getBytes("US-ASCII")) [CD]
Line_26 $$ java.security.MessageDigest md = java.security.MessageDigest.getInstance("MD5") --> Line_40 $$ md.update(contentType.getBytes("US-ASCII")) [FD]
Line_38 $$ String contentType = dh.getContentType() --> Line_40 $$ md.update(contentType.getBytes("US-ASCII")) [FD]
Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() --> Line_42 $$ sbe = env.getFirstBody() [FD]
Line_7 $$ org.apache.axis.message.SOAPEnvelope env = (org.apache.axis.message.SOAPEnvelope) msg.getSOAPEnvelope() --> Line_42 $$ sbe = env.getFirstBody() [FD]
Line_9 $$ org.w3c.dom.Element sbElement = sbe.getAsDOM() --> Line_43 $$ sbElement = sbe.getAsDOM() [FD]
Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() --> Line_43 $$ sbElement = sbe.getAsDOM() [FD]
Line_42 $$ sbe = env.getFirstBody() --> Line_43 $$ sbElement = sbe.getAsDOM() [FD]
Line_11 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) --> Line_44 $$ n = sbElement.getFirstChild() [FD]
Line_10 $$ org.w3c.dom.Node n = sbElement.getFirstChild() --> Line_44 $$ n = sbElement.getFirstChild() [FD]
Line_9 $$ org.w3c.dom.Element sbElement = sbe.getAsDOM() --> Line_44 $$ n = sbElement.getFirstChild() [FD]
Line_43 $$ sbElement = sbe.getAsDOM() --> Line_44 $$ n = sbElement.getFirstChild() [FD]
Line_11 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) --> Line_45 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) [FD]
Line_10 $$ org.w3c.dom.Node n = sbElement.getFirstChild() --> Line_45 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) [FD]
Line_44 $$ n = sbElement.getFirstChild() --> Line_45 $$ for (; n != null && !(n instanceof org.w3c.dom.Element); n = n.getNextSibling()) [FD]
Line_12 $$ org.w3c.dom.Element paramElement = (org.w3c.dom.Element) n --> Line_46 $$ paramElement = (org.w3c.dom.Element) n [FD]
Line_26 $$ java.security.MessageDigest md = java.security.MessageDigest.getInstance("MD5") --> Line_47 $$ String MD5String = org.apache.axis.encoding.Base64.encode(md.digest()) [FD]
Line_12 $$ org.w3c.dom.Element paramElement = (org.w3c.dom.Element) n --> Line_49 $$ paramElement.appendChild(paramElement.getOwnerDocument().createTextNode(senddata)) [FD]
Line_46 $$ paramElement = (org.w3c.dom.Element) n --> Line_49 $$ paramElement.appendChild(paramElement.getOwnerDocument().createTextNode(senddata)) [FD]
Line_48 $$ String senddata = " elapsedTime=" + elapsedTimeStr + " MD5=" + MD5String --> Line_49 $$ paramElement.appendChild(paramElement.getOwnerDocument().createTextNode(senddata)) [FD]
Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() --> Line_50 $$ sbe = new org.apache.axis.message.SOAPBodyElement(sbElement) [FD]
Line_42 $$ sbe = env.getFirstBody() --> Line_50 $$ sbe = new org.apache.axis.message.SOAPBodyElement(sbElement) [FD]
Line_7 $$ org.apache.axis.message.SOAPEnvelope env = (org.apache.axis.message.SOAPEnvelope) msg.getSOAPEnvelope() --> Line_51 $$ env.clearBody() [FD]
Line_7 $$ org.apache.axis.message.SOAPEnvelope env = (org.apache.axis.message.SOAPEnvelope) msg.getSOAPEnvelope() --> Line_52 $$ env.addBodyElement(sbe) [FD]
Line_8 $$ org.apache.axis.message.SOAPBodyElement sbe = env.getFirstBody() --> Line_52 $$ env.addBodyElement(sbe) [FD]
Line_42 $$ sbe = env.getFirstBody() --> Line_52 $$ env.addBodyElement(sbe) [FD]
Line_50 $$ sbe = new org.apache.axis.message.SOAPBodyElement(sbElement) --> Line_52 $$ env.addBodyElement(sbe) [FD]
Line_5 $$ Message msg = msgContext.getRequestMessage() --> Line_53 $$ msg = new Message(env) [FD]
Line_2 $$ public void invoke(MessageContext msgContext) throws AxisFault --> Line_54 $$ msgContext.setResponseMessage(msg) [FD]
Line_5 $$ Message msg = msgContext.getRequestMessage() --> Line_54 $$ msgContext.setResponseMessage(msg) [FD]
Line_53 $$ msg = new Message(env) --> Line_54 $$ msgContext.setResponseMessage(msg) [FD]
Line_2 $$ public void invoke(MessageContext msgContext) throws AxisFault --> Line_59 $$ log.debug("Exit: MD5AttachHandler::invoke") [CD]
Line_31 $$ bread = attachmentStream.read(buf) --> Line_30 $$ do [FD]
