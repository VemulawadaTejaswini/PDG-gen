Line_0 $$ Entry-->Line_2 $$ //11
public class func [ CD ]
Line_2 $$ //11
public class func -->Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) [ CD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_4 $$ if (!newt.getTableName().equalsIgnoreCase(name) || !newt.getDbName().equalsIgnoreCase(dbname)) [ CD ]
Line_4 $$ !newt.getTableName().equalsIgnoreCase(name)-->Line_4 $$ newt.getTableName().equalsIgnoreCase(name)[ CD ]
Line_5 $$ !newt.getDbName().equalsIgnoreCase(dbname)-->Line_5 $$ newt.getDbName().equalsIgnoreCase(dbname)[ CD ]
Line_4 $$ if (!newt.getTableName().equalsIgnoreCase(name) || !newt.getDbName().equalsIgnoreCase(dbname)) -->Line_6 $$ if (msdb.getTable(newt.getDbName(), newt.getTableName()) != null) [ CD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_12 $$ Table oldt = msdb.getTable(dbname, name)[ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_12 $$ msdb.getTable(dbname, name)[ CD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_13 $$ if (oldt == null) [ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_13 $$ if (oldt == null) [ FD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_17 $$ if (oldt.getPartitionKeys().size() != newt.getPartitionKeys().size() || !oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())) [ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_17 $$ oldt.getPartitionKeys()[ FD ]
Line_18 $$ !oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())-->Line_18 $$ oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())[ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_18 $$ oldt.getPartitionKeys()[ FD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) [ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_23 $$ oldt.getSd()[ FD ]
Line_25 $$ !MetaStoreUtils.isExternalTable(oldt)-->Line_25 $$ MetaStoreUtils.isExternalTable(oldt)[ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_25 $$ MetaStoreUtils.isExternalTable(oldt)[ FD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_29 $$ wh.getDefaultTablePath(newt.getDbName(), newt.getTableName()).toString()[ CD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_30 $$ newt.getSd().setLocation(newTblLoc)[ CD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_31 $$ oldt.getSd().getLocation()[ CD ]
Line_12 $$ Table oldt = msdb.getTable(dbname, name)-->Line_31 $$ oldt.getSd()[ FD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_36 $$ wh.getFs(srcPath)[ CD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_38 $$ wh.getFs(destPath)[ CD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_40 $$ // check that src and dest are on the same file system
if (srcFs != destFs) [ CD ]
Line_48 $$ // permissions necessary
if (destFs.exists(destPath)) -->Line_48 $$ destFs.exists(destPath)[ CD ]
Line_22 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_61 $$ List<Partition> parts = msdb.getPartitions(dbname, name, 0)[ CD ]
Line_61 $$ List<Partition> parts = msdb.getPartitions(dbname, name, 0)-->Line_61 $$ msdb.getPartitions(dbname, name, 0)[ CD ]
Line_63 $$ String oldPartLoc = part.getSd().getLocation()-->Line_63 $$ part.getSd().getLocation()[ CD ]
Line_62 $$ Partition part-->Line_63 $$ part.getSd()[ FD ]
Line_64 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_64 $$ new Path(oldTblLoc).toUri().getPath()[ CD ]
Line_65 $$ String newTblLocPath = new Path(newTblLoc).toUri().getPath()-->Line_65 $$ new Path(newTblLoc).toUri().getPath()[ CD ]
Line_63 $$ String oldPartLoc = part.getSd().getLocation()-->Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) [ FD ]
Line_64 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) [ FD ]
Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_66 $$ oldPartLoc.contains(oldTblLocPath)[ CD ]
Line_63 $$ String oldPartLoc = part.getSd().getLocation()-->Line_66 $$ oldPartLoc.contains(oldTblLocPath)[ FD ]
Line_64 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_66 $$ oldPartLoc.contains(oldTblLocPath)[ FD ]
Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_67 $$ URI newPartLocUri = null[ CD ]
Line_67 $$ URI newPartLocUri = null-->Line_70 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())[ FD ]
Line_70 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())-->Line_70 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_71 $$ oldPartLocUri.getScheme()[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_72 $$ oldPartLocUri.getUserInfo()[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_73 $$ oldPartLocUri.getHost()[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_74 $$ oldPartLocUri.getPort()[ FD ]
Line_64 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_75 $$ oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath)[ FD ]
Line_65 $$ String newTblLocPath = new Path(newTblLoc).toUri().getPath()-->Line_75 $$ oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath)[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_75 $$ oldPartLocUri.getPath()[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_76 $$ oldPartLocUri.getQuery()[ FD ]
Line_69 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_77 $$ oldPartLocUri.getFragment()[ FD ]
Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_82 $$ part.getSd().setLocation(newPartLocUri.toString())[ CD ]
Line_62 $$ Partition part-->Line_82 $$ part.getSd()[ FD ]
Line_67 $$ URI newPartLocUri = null-->Line_82 $$ newPartLocUri.toString()[ FD ]
Line_70 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())-->Line_82 $$ newPartLocUri.toString()[ FD ]
Line_66 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_83 $$ msdb.alterPartition(dbname, name, part)[ CD ]
Line_62 $$ Partition part-->Line_83 $$ msdb.alterPartition(dbname, name, part)[ FD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_87 $$ msdb.alterTable(dbname, name, newt)[ CD ]
Line_3 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_88 $$ msdb.commitTransaction()[ CD ]
