Line_0 $$ Entry-->Line_1 $$ public class func [ CD ]
Line_1 $$ public class func -->Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) [ CD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_3 $$ if (!newt.getTableName().equalsIgnoreCase(name) || !newt.getDbName().equalsIgnoreCase(dbname)) [ CD ]
Line_3 $$ !newt.getTableName().equalsIgnoreCase(name)-->Line_3 $$ newt.getTableName().equalsIgnoreCase(name)[ CD ]
Line_4 $$ !newt.getDbName().equalsIgnoreCase(dbname)-->Line_4 $$ newt.getDbName().equalsIgnoreCase(dbname)[ CD ]
Line_3 $$ if (!newt.getTableName().equalsIgnoreCase(name) || !newt.getDbName().equalsIgnoreCase(dbname)) -->Line_5 $$ if (msdb.getTable(newt.getDbName(), newt.getTableName()) != null) [ CD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_11 $$ Table oldt = msdb.getTable(dbname, name)[ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_11 $$ msdb.getTable(dbname, name)[ CD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_12 $$ if (oldt == null) [ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_12 $$ if (oldt == null) [ FD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_16 $$ if (oldt.getPartitionKeys().size() != newt.getPartitionKeys().size() || !oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())) [ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_16 $$ oldt.getPartitionKeys()[ FD ]
Line_17 $$ !oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())-->Line_17 $$ oldt.getPartitionKeys().containsAll(newt.getPartitionKeys())[ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_17 $$ oldt.getPartitionKeys()[ FD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) [ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_22 $$ oldt.getSd()[ FD ]
Line_24 $$ !MetaStoreUtils.isExternalTable(oldt)-->Line_24 $$ MetaStoreUtils.isExternalTable(oldt)[ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_24 $$ MetaStoreUtils.isExternalTable(oldt)[ FD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_25 $$ wh.getDefaultTablePath(newt.getDbName(), newt.getTableName()).toString()[ CD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_26 $$ newt.getSd().setLocation(newTblLoc)[ CD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_27 $$ oldt.getSd().getLocation()[ CD ]
Line_11 $$ Table oldt = msdb.getTable(dbname, name)-->Line_27 $$ oldt.getSd()[ FD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_30 $$ wh.getFs(srcPath)[ CD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_32 $$ wh.getFs(destPath)[ CD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_33 $$ if (srcFs != destFs) [ CD ]
Line_40 $$ if (destFs.exists(destPath)) -->Line_40 $$ destFs.exists(destPath)[ CD ]
Line_21 $$ if (rename && (oldt.getSd().getLocation().compareTo(newt.getSd().getLocation()) == 0 || StringUtils.isEmpty(newt.getSd().getLocation())) && !MetaStoreUtils.isExternalTable(oldt)) -->Line_52 $$ List<Partition> parts = msdb.getPartitions(dbname, name, 0)[ CD ]
Line_52 $$ List<Partition> parts = msdb.getPartitions(dbname, name, 0)-->Line_52 $$ msdb.getPartitions(dbname, name, 0)[ CD ]
Line_54 $$ String oldPartLoc = part.getSd().getLocation()-->Line_54 $$ part.getSd().getLocation()[ CD ]
Line_53 $$ Partition part-->Line_54 $$ part.getSd()[ FD ]
Line_55 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_55 $$ new Path(oldTblLoc).toUri().getPath()[ CD ]
Line_56 $$ String newTblLocPath = new Path(newTblLoc).toUri().getPath()-->Line_56 $$ new Path(newTblLoc).toUri().getPath()[ CD ]
Line_54 $$ String oldPartLoc = part.getSd().getLocation()-->Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) [ FD ]
Line_55 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) [ FD ]
Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_57 $$ oldPartLoc.contains(oldTblLocPath)[ CD ]
Line_54 $$ String oldPartLoc = part.getSd().getLocation()-->Line_57 $$ oldPartLoc.contains(oldTblLocPath)[ FD ]
Line_55 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_57 $$ oldPartLoc.contains(oldTblLocPath)[ FD ]
Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_58 $$ URI newPartLocUri = null[ CD ]
Line_58 $$ URI newPartLocUri = null-->Line_61 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())[ FD ]
Line_61 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())-->Line_61 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_62 $$ oldPartLocUri.getScheme()[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_63 $$ oldPartLocUri.getUserInfo()[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_64 $$ oldPartLocUri.getHost()[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_65 $$ oldPartLocUri.getPort()[ FD ]
Line_55 $$ String oldTblLocPath = new Path(oldTblLoc).toUri().getPath()-->Line_66 $$ oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath)[ FD ]
Line_56 $$ String newTblLocPath = new Path(newTblLoc).toUri().getPath()-->Line_66 $$ oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath)[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_66 $$ oldPartLocUri.getPath()[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_67 $$ oldPartLocUri.getQuery()[ FD ]
Line_60 $$ URI oldPartLocUri = new URI(oldPartLoc)-->Line_68 $$ oldPartLocUri.getFragment()[ FD ]
Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_73 $$ part.getSd().setLocation(newPartLocUri.toString())[ CD ]
Line_53 $$ Partition part-->Line_73 $$ part.getSd()[ FD ]
Line_58 $$ URI newPartLocUri = null-->Line_73 $$ newPartLocUri.toString()[ FD ]
Line_61 $$ newPartLocUri = new URI(oldPartLocUri.getScheme(), oldPartLocUri.getUserInfo(), oldPartLocUri.getHost(), oldPartLocUri.getPort(), oldPartLocUri.getPath().replace(oldTblLocPath, newTblLocPath), oldPartLocUri.getQuery(), oldPartLocUri.getFragment())-->Line_73 $$ newPartLocUri.toString()[ FD ]
Line_57 $$ if (oldPartLoc.contains(oldTblLocPath)) -->Line_74 $$ msdb.alterPartition(dbname, name, part)[ CD ]
Line_53 $$ Partition part-->Line_74 $$ msdb.alterPartition(dbname, name, part)[ FD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_78 $$ msdb.alterTable(dbname, name, newt)[ CD ]
Line_2 $$ public void alterTable(RawStore msdb, Warehouse wh, String dbname, String name, Table newt) -->Line_79 $$ msdb.commitTransaction()[ CD ]
