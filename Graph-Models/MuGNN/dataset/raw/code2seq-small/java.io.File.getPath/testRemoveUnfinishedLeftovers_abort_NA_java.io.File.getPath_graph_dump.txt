Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)-->Line_13 $$ sstableOld.selfRef().release()[ FD ]
Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)-->Line_10 $$ LogTransaction.SSTableTidier tidier = log.obsoleted(sstableOld)[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_20 $$ tidier.run()[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_19 $$ assertFiles(dataFolder.getPath(), new HashSet(sstableOld.getAllFilePaths()))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_10 $$ LogTransaction.SSTableTidier tidier = log.obsoleted(sstableOld)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_18 $$ assertEquals(1, sstables.size())[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_4 $$ File dataFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_11 $$ Set<File> tmpFiles = sstableNew.getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet())[ CD ]
Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)-->Line_9 $$ log.trackNew(sstableNew)[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_14 $$ Assert.assertEquals(tmpFiles, LogAwareFileLister.getTemporaryFiles(sstableNew.descriptor.directory))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_7 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)[ CD ]
Line_7 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_10 $$ LogTransaction.SSTableTidier tidier = log.obsoleted(sstableOld)[ FD ]
Line_16 $$ Directories directories = new Directories(cfs.metadata)-->Line_17 $$ Map<Descriptor, Set<Component>> sstables = directories.sstableLister(Directories.OnTxnErr.THROW).list()[ FD ]
Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)-->Line_11 $$ Set<File> tmpFiles = sstableNew.getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet())[ FD ]
Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)-->Line_12 $$ sstableNew.selfRef().release()[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_12 $$ sstableNew.selfRef().release()[ CD ]
Line_10 $$ LogTransaction.SSTableTidier tidier = log.obsoleted(sstableOld)-->Line_20 $$ tidier.run()[ FD ]
Line_7 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_8 $$ assertNotNull(log)[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_21 $$ log.close()[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_15 $$ LogTransaction.removeUnfinishedLeftovers(cfs.metadata)[ CD ]
Line_4 $$ File dataFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()-->Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_17 $$ Map<Descriptor, Set<Component>> sstables = directories.sstableLister(Directories.OnTxnErr.THROW).list()[ CD ]
Line_7 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_21 $$ log.close()[ FD ]
Line_7 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_9 $$ log.trackNew(sstableNew)[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_8 $$ assertNotNull(log)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_16 $$ Directories directories = new Directories(cfs.metadata)[ CD ]
Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)-->Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)[ FD ]
Line_4 $$ File dataFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()-->Line_19 $$ assertFiles(dataFolder.getPath(), new HashSet(sstableOld.getAllFilePaths()))[ FD ]
Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)-->Line_19 $$ assertFiles(dataFolder.getPath(), new HashSet(sstableOld.getAllFilePaths()))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_5 $$ SSTableReader sstableOld = sstable(dataFolder, cfs, 0, 128)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_13 $$ sstableOld.selfRef().release()[ CD ]
Line_11 $$ Set<File> tmpFiles = sstableNew.getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet())-->Line_14 $$ Assert.assertEquals(tmpFiles, LogAwareFileLister.getTemporaryFiles(sstableNew.descriptor.directory))[ FD ]
Line_17 $$ Map<Descriptor, Set<Component>> sstables = directories.sstableLister(Directories.OnTxnErr.THROW).list()-->Line_18 $$ assertEquals(1, sstables.size())[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort() throws Throwable -->Line_9 $$ log.trackNew(sstableNew)[ CD ]
Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)-->Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)[ FD ]
Line_4 $$ File dataFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()-->Line_6 $$ SSTableReader sstableNew = sstable(dataFolder, cfs, 1, 128)[ FD ]
