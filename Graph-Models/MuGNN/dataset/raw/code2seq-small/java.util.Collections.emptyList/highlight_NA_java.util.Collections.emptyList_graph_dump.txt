Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_19 $$ cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ FD ]
Line_33 $$ if (field.fieldOptions().boundaryMaxScan() != SimpleBoundaryScanner.DEFAULT_MAX_SCAN || field.fieldOptions().boundaryChars() != SimpleBoundaryScanner.DEFAULT_BOUNDARY_CHARS) -->Line_34 $$ boundaryScanner = new SimpleBoundaryScanner(field.fieldOptions().boundaryMaxScan(), field.fieldOptions().boundaryChars())[ CD ]
Line_29 $$ if (entry == null) -->Line_36 $$ boolean forceSource = context.highlight().forceSource(field)[ CD ]
Line_82 $$ int noMatchSize = highlighterContext.field.fieldOptions().noMatchSize()-->Line_83 $$ if (noMatchSize > 0) [ FD ]
Line_21 $$ fieldQuery = cache.fieldMatchFieldQuery-->Line_26 $$ fieldQuery = cache.noFieldMatchFieldQuery[ FD ]
Line_53 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_28 $$ MapperHighlightEntry entry = cache.mappers.get(mapper)-->Line_29 $$ if (entry == null) [ FD ]
Line_29 $$ if (entry == null) -->Line_32 $$ BoundaryScanner boundaryScanner = DEFAULT_BOUNDARY_SCANNER[ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_29 $$ if (entry == null) -->Line_64 $$ if (cache.fvh == null) [ CD ]
Line_64 $$ if (cache.fvh == null) -->Line_65 $$ cache.fvh = new org.apache.lucene.search.vectorhighlight.FastVectorHighlighter()[ CD ]
Line_26 $$ fieldQuery = cache.noFieldMatchFieldQuery-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_38 $$ fragListBuilder = new SingleFragListBuilder()-->Line_45 $$ fragListBuilder = field.fieldOptions().fragmentOffset() == -1 ? new SimpleFragListBuilder() : new SimpleFragListBuilder(field.fieldOptions().fragmentOffset())[ FD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_17 $$ if (field.fieldOptions().requireFieldMatch()) -->Line_23 $$ if (cache.noFieldMatchFieldQuery == null) [ CD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_28 $$ MapperHighlightEntry entry = cache.mappers.get(mapper)[ FD ]
Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_29 $$ if (entry == null) -->Line_62 $$ entry.fragListBuilder = fragListBuilder[ CD ]
Line_29 $$ if (entry == null) -->Line_61 $$ entry = new MapperHighlightEntry()[ CD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_72 $$ int numberOfFragments = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().numberOfFragments()-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_71 $$ String[] fragments-->Line_80 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_24 $$ cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ FD ]
Line_18 $$ if (cache.fieldMatchFieldQuery == null) -->Line_19 $$ cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ CD ]
Line_29 $$ if (entry == null) -->Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) [ CD ]
Line_72 $$ int numberOfFragments = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().numberOfFragments()-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_21 $$ fieldQuery = cache.fieldMatchFieldQuery-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_10 $$ Encoder encoder = field.fieldOptions().encoder().equals("html") ? HighlightUtils.Encoders.HTML : HighlightUtils.Encoders.DEFAULT-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_23 $$ if (cache.noFieldMatchFieldQuery == null) -->Line_24 $$ cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ CD ]
Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_88 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_29 $$ if (entry == null) -->Line_30 $$ FragListBuilder fragListBuilder[ CD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_7 $$ if (canHighlight(mapper) == false) [ CD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_16 $$ FieldQuery fieldQuery-->Line_21 $$ fieldQuery = cache.fieldMatchFieldQuery[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_6 $$ FieldMapper mapper = highlighterContext.mapper[ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_67 $$ CustomFieldQuery.highlightFilters.set(field.fieldOptions().highlightFilter())[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_73 $$ int fragmentCharSize = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().fragmentCharSize()[ FD ]
Line_10 $$ Encoder encoder = field.fieldOptions().encoder().equals("html") ? HighlightUtils.Encoders.HTML : HighlightUtils.Encoders.DEFAULT-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_83 $$ if (noMatchSize > 0) -->Line_85 $$ fieldFragList.add(0, noMatchSize, Collections.<WeightedPhraseInfo>emptyList())[ CD ]
Line_74 $$ if (field.fieldOptions().matchedFields() != null && !field.fieldOptions().matchedFields().isEmpty()) -->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ CD ]
Line_28 $$ MapperHighlightEntry entry = cache.mappers.get(mapper)-->Line_61 $$ entry = new MapperHighlightEntry()[ FD ]
Line_30 $$ FragListBuilder fragListBuilder-->Line_38 $$ fragListBuilder = new SingleFragListBuilder()[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_39 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) -->Line_39 $$ if (!forceSource && mapper.fieldType().stored()) [ CD ]
Line_74 $$ if (field.fieldOptions().matchedFields() != null && !field.fieldOptions().matchedFields().isEmpty()) -->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ CD ]
Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) -->Line_46 $$ if (field.fieldOptions().scoreOrdered()) [ CD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_17 $$ if (field.fieldOptions().requireFieldMatch()) -->Line_18 $$ if (cache.fieldMatchFieldQuery == null) [ CD ]
Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) -->Line_45 $$ fragListBuilder = field.fieldOptions().fragmentOffset() == -1 ? new SimpleFragListBuilder() : new SimpleFragListBuilder(field.fieldOptions().fragmentOffset())[ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_21 $$ fieldQuery = cache.fieldMatchFieldQuery-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_36 $$ boolean forceSource = context.highlight().forceSource(field)[ FD ]
Line_47 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_11 $$ if (!hitContext.cache().containsKey(CACHE_KEY)) [ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_24 $$ cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ FD ]
Line_39 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_26 $$ fieldQuery = cache.noFieldMatchFieldQuery-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_33 $$ if (field.fieldOptions().boundaryMaxScan() != SimpleBoundaryScanner.DEFAULT_MAX_SCAN || field.fieldOptions().boundaryChars() != SimpleBoundaryScanner.DEFAULT_BOUNDARY_CHARS) [ FD ]
Line_29 $$ if (entry == null) -->Line_31 $$ BaseFragmentsBuilder fragmentsBuilder[ CD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_47 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_83 $$ if (noMatchSize > 0) -->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ CD ]
Line_71 $$ String[] fragments-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_68 $$ cache.mappers.put(mapper, entry)[ FD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_7 $$ if (canHighlight(mapper) == false) [ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_39 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_88 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_29 $$ if (entry == null) -->Line_68 $$ cache.mappers.put(mapper, entry)[ CD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_47 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) -->Line_38 $$ fragListBuilder = new SingleFragListBuilder()[ CD ]
Line_73 $$ int fragmentCharSize = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().fragmentCharSize()-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_88 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_72 $$ int numberOfFragments = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().numberOfFragments()[ FD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_29 $$ if (entry == null) -->Line_33 $$ if (field.fieldOptions().boundaryMaxScan() != SimpleBoundaryScanner.DEFAULT_MAX_SCAN || field.fieldOptions().boundaryChars() != SimpleBoundaryScanner.DEFAULT_BOUNDARY_CHARS) [ CD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_11 $$ if (!hitContext.cache().containsKey(CACHE_KEY)) [ CD ]
Line_30 $$ FragListBuilder fragListBuilder-->Line_62 $$ entry.fragListBuilder = fragListBuilder[ FD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_74 $$ if (field.fieldOptions().matchedFields() != null && !field.fieldOptions().matchedFields().isEmpty()) [ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_14 $$ HighlighterEntry cache = (HighlighterEntry) hitContext.cache().get(CACHE_KEY)[ CD ]
Line_17 $$ if (field.fieldOptions().requireFieldMatch()) -->Line_26 $$ fieldQuery = cache.noFieldMatchFieldQuery[ CD ]
Line_16 $$ FieldQuery fieldQuery-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_10 $$ Encoder encoder = field.fieldOptions().encoder().equals("html") ? HighlightUtils.Encoders.HTML : HighlightUtils.Encoders.DEFAULT[ FD ]
Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_19 $$ cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query, hitContext.topLevelReader(), true, field.fieldOptions().requireFieldMatch())[ FD ]
Line_32 $$ BoundaryScanner boundaryScanner = DEFAULT_BOUNDARY_SCANNER-->Line_34 $$ boundaryScanner = new SimpleBoundaryScanner(field.fieldOptions().boundaryMaxScan(), field.fieldOptions().boundaryChars())[ FD ]
Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_87 $$ if (fragments != null && fragments.length > 0) -->Line_88 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ CD ]
Line_36 $$ boolean forceSource = context.highlight().forceSource(field)-->Line_53 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ FD ]
Line_10 $$ Encoder encoder = field.fieldOptions().encoder().equals("html") ? HighlightUtils.Encoders.HTML : HighlightUtils.Encoders.DEFAULT-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_71 $$ String[] fragments-->Line_88 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_17 $$ if (field.fieldOptions().requireFieldMatch()) [ FD ]
Line_73 $$ int fragmentCharSize = field.fieldOptions().numberOfFragments() == 0 ? Integer.MAX_VALUE : field.fieldOptions().fragmentCharSize()-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_80 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_17 $$ if (field.fieldOptions().requireFieldMatch()) -->Line_21 $$ fieldQuery = cache.fieldMatchFieldQuery[ CD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_16 $$ FieldQuery fieldQuery-->Line_26 $$ fieldQuery = cache.noFieldMatchFieldQuery[ FD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_14 $$ HighlighterEntry cache = (HighlighterEntry) hitContext.cache().get(CACHE_KEY)[ FD ]
Line_79 $$ if (fragments != null && fragments.length > 0) -->Line_80 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ CD ]
Line_46 $$ if (field.fieldOptions().scoreOrdered()) -->Line_47 $$ if (!forceSource && mapper.fieldType().stored()) [ CD ]
Line_48 $$ fragmentsBuilder = new ScoreOrderFragmentsBuilder(field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_29 $$ if (entry == null) -->Line_63 $$ entry.fragmentsBuilder = fragmentsBuilder[ CD ]
Line_83 $$ if (noMatchSize > 0) -->Line_84 $$ FieldFragList fieldFragList = new SimpleFieldFragList(-1)[ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_45 $$ fragListBuilder = field.fieldOptions().fragmentOffset() == -1 ? new SimpleFragListBuilder() : new SimpleFragListBuilder(field.fieldOptions().fragmentOffset())[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_46 $$ if (field.fieldOptions().scoreOrdered()) [ FD ]
Line_36 $$ boolean forceSource = context.highlight().forceSource(field)-->Line_47 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_71 $$ String[] fragments-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_4 $$ SearchContext context = highlighterContext.context-->Line_36 $$ boolean forceSource = context.highlight().forceSource(field)[ FD ]
Line_30 $$ FragListBuilder fragListBuilder-->Line_45 $$ fragListBuilder = field.fieldOptions().fragmentOffset() == -1 ? new SimpleFragListBuilder() : new SimpleFragListBuilder(field.fieldOptions().fragmentOffset())[ FD ]
Line_83 $$ if (noMatchSize > 0) -->Line_87 $$ if (fragments != null && fragments.length > 0) [ CD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_29 $$ if (entry == null) -->Line_67 $$ CustomFieldQuery.highlightFilters.set(field.fieldOptions().highlightFilter())[ CD ]
Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_10 $$ Encoder encoder = field.fieldOptions().encoder().equals("html") ? HighlightUtils.Encoders.HTML : HighlightUtils.Encoders.DEFAULT[ CD ]
Line_6 $$ FieldMapper mapper = highlighterContext.mapper-->Line_53 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_53 $$ if (!forceSource && mapper.fieldType().stored()) -->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ CD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_38 $$ fragListBuilder = new SingleFragListBuilder()-->Line_62 $$ entry.fragListBuilder = fragListBuilder[ FD ]
Line_28 $$ MapperHighlightEntry entry = cache.mappers.get(mapper)-->Line_68 $$ cache.mappers.put(mapper, entry)[ FD ]
Line_84 $$ FieldFragList fieldFragList = new SimpleFieldFragList(-1)-->Line_85 $$ fieldFragList.add(0, noMatchSize, Collections.<WeightedPhraseInfo>emptyList())[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_84 $$ FieldFragList fieldFragList = new SimpleFieldFragList(-1)-->Line_86 $$ fragments = entry.fragmentsBuilder.createFragments(hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fieldFragList, 1, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_50 $$ fragmentsBuilder = new SourceScoreOrderFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_80 $$ return new HighlightField(highlighterContext.fieldName, Text.convertFromStringArray(fragments))[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_37 $$ if (field.fieldOptions().numberOfFragments() == 0) [ FD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_56 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_4 $$ SearchContext context = highlighterContext.context[ CD ]
Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_45 $$ fragListBuilder = field.fieldOptions().fragmentOffset() == -1 ? new SimpleFragListBuilder() : new SimpleFragListBuilder(field.fieldOptions().fragmentOffset())-->Line_62 $$ entry.fragListBuilder = fragListBuilder[ FD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_70 $$ cache.fvh.setPhraseLimit(field.fieldOptions().phraseLimit())[ FD ]
Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_54 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext[ CD ]
Line_5 $$ FetchSubPhase.HitContext hitContext = highlighterContext.hitContext-->Line_12 $$ hitContext.cache().put(CACHE_KEY, new HighlighterEntry())[ FD ]
Line_40 $$ fragmentsBuilder = new SimpleFragmentsBuilder(mapper, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)-->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ FD ]
Line_31 $$ BaseFragmentsBuilder fragmentsBuilder-->Line_42 $$ fragmentsBuilder = new SourceSimpleFragmentsBuilder(mapper, context, hitContext, field.fieldOptions().preTags(), field.fieldOptions().postTags(), boundaryScanner)[ FD ]
Line_82 $$ int noMatchSize = highlighterContext.field.fieldOptions().noMatchSize()-->Line_85 $$ fieldFragList.add(0, noMatchSize, Collections.<WeightedPhraseInfo>emptyList())[ FD ]
Line_46 $$ if (field.fieldOptions().scoreOrdered()) -->Line_53 $$ if (!forceSource && mapper.fieldType().stored()) [ CD ]
Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field-->Line_34 $$ boundaryScanner = new SimpleBoundaryScanner(field.fieldOptions().boundaryMaxScan(), field.fieldOptions().boundaryChars())[ FD ]
Line_71 $$ String[] fragments-->Line_75 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), field.fieldOptions().matchedFields(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_16 $$ FieldQuery fieldQuery-->Line_77 $$ fragments = cache.fvh.getBestFragments(fieldQuery, hitContext.reader(), hitContext.docId(), mapper.fieldType().name(), fragmentCharSize, numberOfFragments, entry.fragListBuilder, entry.fragmentsBuilder, field.fieldOptions().preTags(), field.fieldOptions().postTags(), encoder)[ FD ]
Line_61 $$ entry = new MapperHighlightEntry()-->Line_68 $$ cache.mappers.put(mapper, entry)[ FD ]
Line_2 $$ public HighlightField highlight(HighlighterContext highlighterContext) -->Line_3 $$ SearchContextHighlight.Field field = highlighterContext.field[ CD ]
Line_11 $$ if (!hitContext.cache().containsKey(CACHE_KEY)) -->Line_12 $$ hitContext.cache().put(CACHE_KEY, new HighlighterEntry())[ CD ]
Line_36 $$ boolean forceSource = context.highlight().forceSource(field)-->Line_39 $$ if (!forceSource && mapper.fieldType().stored()) [ FD ]
Line_29 $$ if (entry == null) -->Line_60 $$ fragmentsBuilder.setDiscreteMultiValueHighlighting(termVectorMultiValue)[ CD ]
