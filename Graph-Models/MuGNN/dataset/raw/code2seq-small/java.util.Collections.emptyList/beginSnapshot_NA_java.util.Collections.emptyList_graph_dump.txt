Line_46 $$ if (entry.snapshotId().equals(snapshot.snapshotId())) -->Line_49 $$ if (!partial) [ CD ]
Line_61 $$ if (closed.isEmpty() == false) -->Line_65 $$ failureMessage.append("Indices are closed ")[ CD ]
Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) -->Line_68 $$ failure = failureMessage.toString()[ CD ]
Line_51 $$ Set<String> missing = indicesWithMissingShards.v1()-->Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) [ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_86 $$ logger.warn("[[ CD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_65 $$ failureMessage.append("Indices are closed ")[ FD ]
Line_49 $$ if (!partial) -->Line_50 $$ Tuple<Set<String>, Set<String>> indicesWithMissingShards = indicesWithMissingShards(shards, currentState.metaData())[ CD ]
Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) -->Line_61 $$ if (closed.isEmpty() == false) [ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_43 $$ SnapshotsInProgress snapshots = currentState.custom(SnapshotsInProgress.TYPE)[ CD ]
Line_44 $$ List<SnapshotsInProgress.Entry> entries = new ArrayList()-->Line_73 $$ entries.add(updatedSnapshot)[ FD ]
Line_44 $$ List<SnapshotsInProgress.Entry> entries = new ArrayList()-->Line_78 $$ entries.add(entry)[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_117 $$ repositoriesService.repository(snapshot.snapshotId().getRepository()).finalizeSnapshot(snapshot.snapshotId(), snapshot.indices(), snapshot.startTime(), ExceptionsHelper.detailedMessage(t), 0, Collections.<SnapshotShardFailure>emptyList())[ FD ]
Line_20 $$ for (String index : snapshot.indices()) -->Line_21 $$ builder.put(metaData.index(index), false)[ FD ]
Line_57 $$ if (missing.isEmpty() == false) -->Line_58 $$ failureMessage.append("Indices don't have primary shards ")[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_81 $$ return ClusterState.builder(currentState).putCustom(SnapshotsInProgress.TYPE, new SnapshotsInProgress(Collections.unmodifiableList(entries))).build()[ CD ]
Line_61 $$ if (closed.isEmpty() == false) -->Line_62 $$ if (failureMessage.length() > 0) [ CD ]
Line_44 $$ List<SnapshotsInProgress.Entry> entries = new ArrayList()-->Line_81 $$ return ClusterState.builder(currentState).putCustom(SnapshotsInProgress.TYPE, new SnapshotsInProgress(Collections.unmodifiableList(entries))).build()[ FD ]
Line_45 $$ for (SnapshotsInProgress.Entry entry : snapshots.entries()) -->Line_46 $$ if (entry.snapshotId().equals(snapshot.snapshotId())) [ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_86 $$ logger.warn("[[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_87 $$ removeSnapshotFromClusterState(snapshot.snapshotId(), null, t)[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_50 $$ Tuple<Set<String>, Set<String>> indicesWithMissingShards = indicesWithMissingShards(shards, currentState.metaData())[ FD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_59 $$ failureMessage.append(missing)[ FD ]
Line_62 $$ if (failureMessage.length() > 0) -->Line_63 $$ failureMessage.append("; ")[ CD ]
Line_51 $$ Set<String> missing = indicesWithMissingShards.v1()-->Line_57 $$ if (missing.isEmpty() == false) [ FD ]
Line_50 $$ Tuple<Set<String>, Set<String>> indicesWithMissingShards = indicesWithMissingShards(shards, currentState.metaData())-->Line_52 $$ Set<String> closed = indicesWithMissingShards.v2()[ FD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_66 $$ failureMessage.append(closed)[ FD ]
Line_16 $$ MetaData metaData = clusterState.metaData()-->Line_23 $$ metaData = builder.build()[ FD ]
Line_50 $$ Tuple<Set<String>, Set<String>> indicesWithMissingShards = indicesWithMissingShards(shards, currentState.metaData())-->Line_51 $$ Set<String> missing = indicesWithMissingShards.v1()[ FD ]
Line_46 $$ if (entry.snapshotId().equals(snapshot.snapshotId())) -->Line_73 $$ entries.add(updatedSnapshot)[ CD ]
Line_23 $$ metaData = builder.build()-->Line_25 $$ repository.initializeSnapshot(snapshot.snapshotId(), snapshot.indices(), metaData)[ FD ]
Line_74 $$ if (!completed(shards.values())) -->Line_75 $$ accepted = true[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_93 $$ userCreateSnapshotListener.onFailure(t)[ FD ]
Line_52 $$ Set<String> closed = indicesWithMissingShards.v2()-->Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) [ FD ]
Line_43 $$ SnapshotsInProgress snapshots = currentState.custom(SnapshotsInProgress.TYPE)-->Line_45 $$ for (SnapshotsInProgress.Entry entry : snapshots.entries()) [ FD ]
Line_49 $$ if (!partial) -->Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) [ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_89 $$ repositoriesService.repository(snapshot.snapshotId().getRepository()).finalizeSnapshot(snapshot.snapshotId(), snapshot.indices(), snapshot.startTime(), ExceptionsHelper.detailedMessage(t), 0, Collections.<SnapshotShardFailure>emptyList())[ FD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_58 $$ failureMessage.append("Indices don't have primary shards ")[ FD ]
Line_16 $$ MetaData metaData = clusterState.metaData()-->Line_25 $$ repository.initializeSnapshot(snapshot.snapshotId(), snapshot.indices(), metaData)[ FD ]
Line_15 $$ Repository repository = repositoriesService.repository(snapshot.snapshotId().getRepository())-->Line_25 $$ repository.initializeSnapshot(snapshot.snapshotId(), snapshot.indices(), metaData)[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_122 $$ userCreateSnapshotListener.onFailure(t)[ FD ]
Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) -->Line_57 $$ if (missing.isEmpty() == false) [ CD ]
Line_46 $$ if (entry.snapshotId().equals(snapshot.snapshotId())) -->Line_78 $$ entries.add(entry)[ CD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_68 $$ failure = failureMessage.toString()[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_87 $$ removeSnapshotFromClusterState(snapshot.snapshotId(), null, t)[ FD ]
Line_27 $$ if (snapshot.indices().isEmpty()) -->Line_30 $$ endSnapshot(snapshot)[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_81 $$ return ClusterState.builder(currentState).putCustom(SnapshotsInProgress.TYPE, new SnapshotsInProgress(Collections.unmodifiableList(entries))).build()[ FD ]
Line_52 $$ Set<String> closed = indicesWithMissingShards.v2()-->Line_66 $$ failureMessage.append(closed)[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_93 $$ userCreateSnapshotListener.onFailure(t)[ CD ]
Line_13 $$ boolean snapshotCreated = false-->Line_26 $$ snapshotCreated = true[ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_113 $$ logger.warn("failed to create snapshot [[ FD ]
Line_45 $$ for (SnapshotsInProgress.Entry entry : snapshots.entries()) -->Line_78 $$ entries.add(entry)[ FD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_62 $$ if (failureMessage.length() > 0) [ FD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_43 $$ SnapshotsInProgress snapshots = currentState.custom(SnapshotsInProgress.TYPE)[ FD ]
Line_49 $$ if (!partial) -->Line_52 $$ Set<String> closed = indicesWithMissingShards.v2()[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_44 $$ List<SnapshotsInProgress.Entry> entries = new ArrayList()[ CD ]
Line_46 $$ if (entry.snapshotId().equals(snapshot.snapshotId())) -->Line_74 $$ if (!completed(shards.values())) [ CD ]
Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) -->Line_56 $$ entries.add(updatedSnapshot)[ CD ]
Line_61 $$ if (closed.isEmpty() == false) -->Line_66 $$ failureMessage.append(closed)[ CD ]
Line_33 $$ clusterService.submitStateUpdateTask("update_snapshot [" + snapshot.snapshotId().getSnapshot() + "]", new ClusterStateUpdateTask() -->Line_114 $$ removeSnapshotFromClusterState(snapshot.snapshotId(), null, t)[ FD ]
Line_51 $$ Set<String> missing = indicesWithMissingShards.v1()-->Line_59 $$ failureMessage.append(missing)[ FD ]
Line_57 $$ if (missing.isEmpty() == false) -->Line_59 $$ failureMessage.append(missing)[ CD ]
Line_52 $$ Set<String> closed = indicesWithMissingShards.v2()-->Line_61 $$ if (closed.isEmpty() == false) [ FD ]
Line_49 $$ if (!partial) -->Line_51 $$ Set<String> missing = indicesWithMissingShards.v1()[ CD ]
Line_16 $$ MetaData metaData = clusterState.metaData()-->Line_21 $$ builder.put(metaData.index(index), false)[ FD ]
Line_17 $$ if (!snapshot.includeGlobalState()) -->Line_23 $$ metaData = builder.build()[ CD ]
Line_53 $$ if (missing.isEmpty() == false || closed.isEmpty() == false) -->Line_54 $$ StringBuilder failureMessage = new StringBuilder()[ CD ]
Line_54 $$ StringBuilder failureMessage = new StringBuilder()-->Line_63 $$ failureMessage.append("; ")[ FD ]
Line_27 $$ if (snapshot.indices().isEmpty()) -->Line_31 $$ return[ CD ]
Line_44 $$ List<SnapshotsInProgress.Entry> entries = new ArrayList()-->Line_56 $$ entries.add(updatedSnapshot)[ FD ]
