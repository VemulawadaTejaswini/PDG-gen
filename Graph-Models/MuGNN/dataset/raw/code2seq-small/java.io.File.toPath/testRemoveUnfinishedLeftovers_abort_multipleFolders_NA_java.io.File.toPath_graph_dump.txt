Line_9 $$ SSTableReader[] sstables = -->Line_18 $$ Arrays.stream(sstables).forEach( s -> s.selfRef().release())[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_22 $$ assertFiles(dataFolder1.getPath(), new HashSet(sstables[0].getAllFilePaths()))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_22 $$ assertFiles(dataFolder1.getPath(), new HashSet(sstables[0].getAllFilePaths()))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_17 $$ log.txnFile().abort()[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_24 $$ Arrays.stream(tidiers).forEach(LogTransaction.SSTableTidier::<>run)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)[ CD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_8 $$ Files.createDirectories(dataFolder2.toPath())[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_15 $$ Collection<File> logFiles = log.logFiles()[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_7 $$ Files.createDirectories(dataFolder1.toPath())[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_25 $$ assertNull(log.complete(null))[ CD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_21 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_6 $$ File dataFolder2 = new File(origiFolder, "2")[ CD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_23 $$ assertFiles(dataFolder2.getPath(), new HashSet(sstables[2].getAllFilePaths()))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_18 $$ Arrays.stream(sstables).forEach( s -> s.selfRef().release())[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_11 $$ assertNotNull(log)[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_14 $$ log.trackNew(sstables[3])[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_16 $$ Assert.assertEquals(2, logFiles.size())[ CD ]
Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_11 $$ assertNotNull(log)[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_17 $$ log.txnFile().abort()[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_12 $$ LogTransaction.SSTableTidier[] tidiers = [ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_21 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_13 $$ log.trackNew(sstables[1])[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_8 $$ Files.createDirectories(dataFolder2.toPath())[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_15 $$ Collection<File> logFiles = log.logFiles()[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_14 $$ log.trackNew(sstables[3])[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_21 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_5 $$ File dataFolder1 = new File(origiFolder, "1")[ CD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_20 $$ Assert.assertEquals(sstables[3].getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet()), LogAwareFileLister.getTemporaryFiles(dataFolder2))[ FD ]
Line_15 $$ Collection<File> logFiles = log.logFiles()-->Line_16 $$ Assert.assertEquals(2, logFiles.size())[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_20 $$ Assert.assertEquals(sstables[3].getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet()), LogAwareFileLister.getTemporaryFiles(dataFolder2))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_13 $$ log.trackNew(sstables[1])[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_25 $$ assertNull(log.complete(null))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_23 $$ assertFiles(dataFolder2.getPath(), new HashSet(sstables[2].getAllFilePaths()))[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_9 $$ SSTableReader[] sstables = [ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_4 $$ File origiFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()[ CD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_19 $$ Assert.assertEquals(sstables[1].getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet()), LogAwareFileLister.getTemporaryFiles(dataFolder1))[ FD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_7 $$ Files.createDirectories(dataFolder1.toPath())[ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_12 $$ LogTransaction.SSTableTidier[] tidiers = [ CD ]
Line_2 $$ public void testRemoveUnfinishedLeftovers_abort_multipleFolders() throws Throwable -->Line_19 $$ Assert.assertEquals(sstables[1].getAllFilePaths().stream().map(File::<>new).collect(Collectors.toSet()), LogAwareFileLister.getTemporaryFiles(dataFolder1))[ CD ]
Line_12 $$ LogTransaction.SSTableTidier[] tidiers = -->Line_24 $$ Arrays.stream(tidiers).forEach(LogTransaction.SSTableTidier::<>run)[ FD ]
