Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_17 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_15 $$ modifier.accept(log)[ FD ]
Line_19 $$ if (shouldCommit) -->Line_23 $$ assertFiles(dataFolder1.getPath(), Sets.newHashSet(Iterables.concat(sstables[0].getAllFilePaths(), sstables[1].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(0)))))[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_16 $$ Arrays.stream(sstables).forEach( s -> s.selfRef().release())[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_27 $$ log.txnFile().commit()[ FD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_8 $$ Files.createDirectories(dataFolder2.toPath())[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_7 $$ Files.createDirectories(dataFolder1.toPath())[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_23 $$ assertFiles(dataFolder1.getPath(), Sets.newHashSet(Iterables.concat(sstables[0].getAllFilePaths(), sstables[1].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(0)))))[ FD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_24 $$ assertFiles(dataFolder2.getPath(), Sets.newHashSet(Iterables.concat(sstables[2].getAllFilePaths(), sstables[3].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(1)))))[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_12 $$ LogTransaction.SSTableTidier[] tidiers = [ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_4 $$ File origiFolder = new Directories(cfs.metadata).getDirectoryForNewSSTables()[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_11 $$ assertNotNull(log)[ CD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_21 $$ assertFiles(dataFolder2.getPath(), new HashSet(sstables[3].getAllFilePaths()))[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_8 $$ Files.createDirectories(dataFolder2.toPath())[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_9 $$ SSTableReader[] sstables = [ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_7 $$ Files.createDirectories(dataFolder1.toPath())[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_11 $$ assertNotNull(log)[ FD ]
Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_6 $$ File dataFolder2 = new File(origiFolder, "2")-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_20 $$ assertFiles(dataFolder1.getPath(), new HashSet(sstables[1].getAllFilePaths()))[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_6 $$ File dataFolder2 = new File(origiFolder, "2")[ CD ]
Line_19 $$ if (shouldCommit) -->Line_24 $$ assertFiles(dataFolder2.getPath(), Sets.newHashSet(Iterables.concat(sstables[2].getAllFilePaths(), sstables[3].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(1)))))[ CD ]
Line_12 $$ LogTransaction.SSTableTidier[] tidiers = -->Line_26 $$ Arrays.stream(tidiers).forEach(LogTransaction.SSTableTidier::<>run)[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_12 $$ LogTransaction.SSTableTidier[] tidiers = [ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_17 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ FD ]
Line_19 $$ if (shouldCommit) -->Line_21 $$ assertFiles(dataFolder2.getPath(), new HashSet(sstables[3].getAllFilePaths()))[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_28 $$ assertNull(log.complete(null))[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_28 $$ assertNull(log.complete(null))[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_13 $$ log.trackNew(sstables[1])[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_13 $$ log.trackNew(sstables[1])[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_24 $$ assertFiles(dataFolder2.getPath(), Sets.newHashSet(Iterables.concat(sstables[2].getAllFilePaths(), sstables[3].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(1)))))[ FD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_23 $$ assertFiles(dataFolder1.getPath(), Sets.newHashSet(Iterables.concat(sstables[0].getAllFilePaths(), sstables[1].getAllFilePaths(), Collections.singleton(log.logFilePaths().get(0)))))[ FD ]
Line_5 $$ File dataFolder1 = new File(origiFolder, "1")-->Line_9 $$ SSTableReader[] sstables = [ FD ]
Line_19 $$ if (shouldCommit) -->Line_20 $$ assertFiles(dataFolder1.getPath(), new HashSet(sstables[1].getAllFilePaths()))[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_14 $$ log.trackNew(sstables[3])[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_5 $$ File dataFolder1 = new File(origiFolder, "1")[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_15 $$ modifier.accept(log)[ CD ]
Line_10 $$ LogTransaction log = new LogTransaction(OperationType.COMPACTION)-->Line_15 $$ modifier.accept(log)[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_18 $$ LogTransaction.waitForDeletions()[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_27 $$ log.txnFile().commit()[ CD ]
Line_9 $$ SSTableReader[] sstables = -->Line_16 $$ Arrays.stream(sstables).forEach( s -> s.selfRef().release())[ FD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_14 $$ log.trackNew(sstables[3])[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_17 $$ LogTransaction.removeUnfinishedLeftovers(Arrays.asList(dataFolder1, dataFolder2))[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_3 $$ ColumnFamilyStore cfs = MockSchema.newCFS(KEYSPACE)[ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_19 $$ if (shouldCommit) [ CD ]
Line_2 $$ private static void testRemoveUnfinishedLeftovers_multipleFolders_errorConditions(Consumer<LogTransaction> modifier, boolean shouldCommit) throws Throwable -->Line_26 $$ Arrays.stream(tidiers).forEach(LogTransaction.SSTableTidier::<>run)[ CD ]
