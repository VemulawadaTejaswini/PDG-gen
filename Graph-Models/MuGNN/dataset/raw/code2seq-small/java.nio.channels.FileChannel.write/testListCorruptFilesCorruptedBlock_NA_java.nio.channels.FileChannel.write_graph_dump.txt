Line_24 $$ Collection<FSNamesystem.CorruptFileBlockInfo> badFiles = namenode.getNamesystem().listCorruptFileBlocks("/", null)-->Line_54 $$ assertTrue("Namenode has " + badFiles.size() + " bad files. Expecting 1.", badFiles.size() == 1)[ FD ]
Line_7 $$ MiniDFSCluster cluster = null-->Line_28 $$ File storageDir = cluster.getInstanceStorageDir(0, 1)[ FD ]
Line_18 $$ FileSystem fs = cluster.getFileSystem()-->Line_45 $$ util.checkFiles(fs, "/srcdat10")[ FD ]
Line_8 $$ Random random = new Random()-->Line_39 $$ random.nextBytes(buffer)[ FD ]
Line_35 $$ FileChannel channel = file.getChannel()-->Line_40 $$ channel.write(ByteBuffer.wrap(buffer), position)[ FD ]
Line_17 $$ cluster = new MiniDFSCluster.Builder(conf).build()-->Line_58 $$ cluster.shutdown()[ FD ]
Line_38 $$ byte[] buffer = new byte[length]-->Line_39 $$ random.nextBytes(buffer)[ FD ]
Line_24 $$ Collection<FSNamesystem.CorruptFileBlockInfo> badFiles = namenode.getNamesystem().listCorruptFileBlocks("/", null)-->Line_25 $$ assertTrue("Namenode has " + badFiles.size() + " corrupt files. Expecting None.", badFiles.size() == 0)[ FD ]
Line_7 $$ MiniDFSCluster cluster = null-->Line_57 $$ if (cluster != null) [ FD ]
Line_38 $$ byte[] buffer = new byte[length]-->Line_40 $$ channel.write(ByteBuffer.wrap(buffer), position)[ FD ]
Line_29 $$ File data_dir = MiniDFSCluster.getFinalizedDir(storageDir, bpid)-->Line_30 $$ assertTrue("data directory does not exist", data_dir.exists())[ FD ]
Line_31 $$ List<File> metaFiles = MiniDFSCluster.getAllBlockMetadataFiles(data_dir)-->Line_32 $$ assertTrue("Data directory does not contain any blocks or there was an " + "IO error", metaFiles != null && !metaFiles.isEmpty())[ FD ]
Line_24 $$ Collection<FSNamesystem.CorruptFileBlockInfo> badFiles = namenode.getNamesystem().listCorruptFileBlocks("/", null)-->Line_53 $$ LOG.info("Namenode has bad files. " + badFiles.size())[ FD ]
Line_28 $$ File storageDir = cluster.getInstanceStorageDir(0, 1)-->Line_29 $$ File data_dir = MiniDFSCluster.getFinalizedDir(storageDir, bpid)[ FD ]
Line_35 $$ FileChannel channel = file.getChannel()-->Line_36 $$ long position = channel.size() - 2[ FD ]
Line_34 $$ RandomAccessFile file = new RandomAccessFile(metaFile, "rw")-->Line_41 $$ file.close()[ FD ]
Line_36 $$ long position = channel.size() - 2-->Line_40 $$ channel.write(ByteBuffer.wrap(buffer), position)[ FD ]
Line_7 $$ MiniDFSCluster cluster = null-->Line_18 $$ FileSystem fs = cluster.getFileSystem()[ FD ]
Line_17 $$ cluster = new MiniDFSCluster.Builder(conf).build()-->Line_18 $$ FileSystem fs = cluster.getFileSystem()[ FD ]
Line_57 $$ if (cluster != null) -->Line_58 $$ cluster.shutdown()[ CD ]
Line_31 $$ List<File> metaFiles = MiniDFSCluster.getAllBlockMetadataFiles(data_dir)-->Line_33 $$ File metaFile = metaFiles.get(0)[ FD ]
Line_18 $$ FileSystem fs = cluster.getFileSystem()-->Line_55 $$ util.cleanup(fs, "/srcdat10")[ FD ]
Line_33 $$ File metaFile = metaFiles.get(0)-->Line_42 $$ LOG.info("Deliberately corrupting file " + metaFile.getName() + " at offset " + position + " length " + length)[ FD ]
Line_34 $$ RandomAccessFile file = new RandomAccessFile(metaFile, "rw")-->Line_35 $$ FileChannel channel = file.getChannel()[ FD ]
Line_18 $$ FileSystem fs = cluster.getFileSystem()-->Line_21 $$ util.createFiles(fs, "/srcdat10")[ FD ]
Line_7 $$ MiniDFSCluster cluster = null-->Line_17 $$ cluster = new MiniDFSCluster.Builder(conf).build()[ FD ]
Line_17 $$ cluster = new MiniDFSCluster.Builder(conf).build()-->Line_57 $$ if (cluster != null) [ FD ]
Line_17 $$ cluster = new MiniDFSCluster.Builder(conf).build()-->Line_28 $$ File storageDir = cluster.getInstanceStorageDir(0, 1)[ FD ]
Line_29 $$ File data_dir = MiniDFSCluster.getFinalizedDir(storageDir, bpid)-->Line_31 $$ List<File> metaFiles = MiniDFSCluster.getAllBlockMetadataFiles(data_dir)[ FD ]
Line_7 $$ MiniDFSCluster cluster = null-->Line_58 $$ cluster.shutdown()[ FD ]
