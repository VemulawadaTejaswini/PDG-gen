Line_28 $$ long txIdVal = iter.next().longValue()-->Line_29 $$ String fileName = NNStorage.getLegacyOIVImageFileName(txIdVal)[ FD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_6 $$ filesInStorage = oivImageDir.list(new FilenameFilter() [ CD ]
Line_4 $$ final String oivImagePrefix = NameNodeFile.IMAGE_LEGACY_OIV.getName()-->Line_18 $$ fTxId = Long.parseLong(fName.substring(oivImagePrefix.length() + 1))[ FD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_4 $$ final String oivImagePrefix = NameNodeFile.IMAGE_LEGACY_OIV.getName()[ CD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_5 $$ String[] filesInStorage[ CD ]
Line_11 $$ if (filesInStorage.length <= numCheckpointsToRetain) -->Line_12 $$ return[ CD ]
Line_32 $$ if (!fileToDelete.delete()) -->Line_33 $$ LOG.warn("Failed to delete image file: " + fileToDelete)[ CD ]
Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) -->Line_28 $$ long txIdVal = iter.next().longValue()[ CD ]
Line_3 $$ File oivImageDir = new File(dir)-->Line_6 $$ filesInStorage = oivImageDir.list(new FilenameFilter() [ FD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_25 $$ int numFilesToDelete = sortedTxIds.size() - numCheckpointsToRetain[ CD ]
Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) -->Line_30 $$ LOG.info("Deleting " + fileName)[ CD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) [ CD ]
Line_5 $$ String[] filesInStorage-->Line_6 $$ filesInStorage = oivImageDir.list(new FilenameFilter() [ FD ]
Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) -->Line_29 $$ String fileName = NNStorage.getLegacyOIVImageFileName(txIdVal)[ CD ]
Line_31 $$ File fileToDelete = new File(oivImageDir, fileName)-->Line_32 $$ if (!fileToDelete.delete()) [ FD ]
Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) -->Line_31 $$ File fileToDelete = new File(oivImageDir, fileName)[ CD ]
Line_27 $$ while (numFilesToDelete > 0 && iter.hasNext()) -->Line_32 $$ if (!fileToDelete.delete()) [ CD ]
Line_6 $$ filesInStorage = oivImageDir.list(new FilenameFilter() -->Line_8 $$ return name.matches(oivImagePrefix + "_(\\d+)")[ CD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_3 $$ File oivImageDir = new File(dir)[ CD ]
Line_6 $$ filesInStorage = oivImageDir.list(new FilenameFilter() -->Line_8 $$ return name.matches(oivImagePrefix + "_(\\d+)")[ FD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_11 $$ if (filesInStorage.length <= numCheckpointsToRetain) [ CD ]
Line_2 $$ void purgeOldLegacyOIVImages(String dir, long txid) -->Line_26 $$ Iterator<Long> iter = sortedTxIds.iterator()[ CD ]
