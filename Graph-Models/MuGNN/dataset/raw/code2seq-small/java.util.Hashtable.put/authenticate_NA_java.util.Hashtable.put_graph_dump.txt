Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_12 $$ env.put("com.sun.jndi.ldap.connect.pool", "false")[ CD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_38 $$ Attribute userPassword = attributes.get("userPassword")[ FD ]
Line_39 $$ if (userPassword != null) -->Line_41 $$ String encryptedPassword = removeEncryptionAlgorithm(ldapPassword)[ CD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_28 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_9 $$ env.put(Context.REFERRAL, systemLDAPConfiguration.referral())[ FD ]
Line_40 $$ String ldapPassword = new String((byte[]) userPassword.get())-->Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)[ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_49 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)[ FD ]
Line_32 $$ if (initialLdapContext != null) -->Line_33 $$ initialLdapContext.close()[ CD ]
Line_38 $$ Attribute userPassword = attributes.get("userPassword")-->Line_39 $$ if (userPassword != null) [ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_49 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_39 $$ if (userPassword != null) -->Line_43 $$ if (Validator.isNotNull(algorithm)) [ CD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_23 $$ ldapAuthResult.setResponseControl(responseControls)[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()[ FD ]
Line_46 $$ if (ldapPassword.equals(encryptedPassword)) -->Line_50 $$ if (_log.isDebugEnabled()) [ CD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_28 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)[ CD ]
Line_50 $$ if (_log.isDebugEnabled()) -->Line_51 $$ _log.debug("Passwords do not match for userDN " + userDN)[ CD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_14 $$ if (ldapAuthResult != null) [ CD ]
Line_39 $$ if (userPassword != null) -->Line_42 $$ String algorithm = ldapAuthConfiguration.passwordEncryptionAlgorithm()[ CD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_47 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_4 $$ LDAPAuthConfiguration ldapAuthConfiguration = _ldapAuthConfigurationProvider.getConfiguration(companyId)-->Line_5 $$ String authMethod = ldapAuthConfiguration.method()[ FD ]
Line_20 $$ initialLdapContext = new InitialLdapContext(env, null)-->Line_21 $$ Control[] responseControls = initialLdapContext.getResponseControls()[ FD ]
Line_40 $$ String ldapPassword = new String((byte[]) userPassword.get())-->Line_41 $$ String encryptedPassword = removeEncryptionAlgorithm(ldapPassword)[ FD ]
Line_41 $$ String encryptedPassword = removeEncryptionAlgorithm(ldapPassword)-->Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)[ FD ]
Line_25 $$ if (_log.isDebugEnabled()) -->Line_26 $$ _log.debug("Failed to bind to the LDAP server with userDN " + userDN + " and password " + password, e)[ CD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_28 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_18 $$ InitialLdapContext initialLdapContext = null-->Line_20 $$ initialLdapContext = new InitialLdapContext(env, null)[ FD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_10 $$ env.put(Context.SECURITY_CREDENTIALS, password)[ FD ]
Line_5 $$ String authMethod = ldapAuthConfiguration.method()-->Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) [ FD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_49 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_56 $$ return ldapAuthResult[ CD ]
Line_18 $$ InitialLdapContext initialLdapContext = null-->Line_21 $$ Control[] responseControls = initialLdapContext.getResponseControls()[ FD ]
Line_37 $$ ldapAuthResult = new LDAPAuthResult()-->Line_49 $$ ldapAuthResult.setAuthenticated(false)[ FD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_37 $$ ldapAuthResult = new LDAPAuthResult()[ FD ]
Line_38 $$ Attribute userPassword = attributes.get("userPassword")-->Line_40 $$ String ldapPassword = new String((byte[]) userPassword.get())[ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_17 $$ ldapAuthResult = new LDAPAuthResult()[ FD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_12 $$ env.put("com.sun.jndi.ldap.connect.pool", "false")[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_6 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_3 $$ LDAPAuthResult ldapAuthResult = null[ CD ]
Line_46 $$ if (ldapPassword.equals(encryptedPassword)) -->Line_47 $$ ldapAuthResult.setAuthenticated(true)[ CD ]
Line_39 $$ if (userPassword != null) -->Line_46 $$ if (ldapPassword.equals(encryptedPassword)) [ CD ]
Line_21 $$ Control[] responseControls = initialLdapContext.getResponseControls()-->Line_23 $$ ldapAuthResult.setResponseControl(responseControls)[ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_30 $$ setFailedLDAPAuthResult(env, ldapAuthResult)[ FD ]
Line_20 $$ initialLdapContext = new InitialLdapContext(env, null)-->Line_32 $$ if (initialLdapContext != null) [ FD ]
Line_5 $$ String authMethod = ldapAuthConfiguration.method()-->Line_36 $$ if (authMethod.equals(AUTH_METHOD_PASSWORD_COMPARE)) [ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_10 $$ env.put(Context.SECURITY_CREDENTIALS, password)[ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_47 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_41 $$ String encryptedPassword = removeEncryptionAlgorithm(ldapPassword)-->Line_46 $$ if (ldapPassword.equals(encryptedPassword)) [ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) [ CD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_18 $$ InitialLdapContext initialLdapContext = null[ CD ]
Line_42 $$ String algorithm = ldapAuthConfiguration.passwordEncryptionAlgorithm()-->Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)[ FD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()[ CD ]
Line_4 $$ LDAPAuthConfiguration ldapAuthConfiguration = _ldapAuthConfigurationProvider.getConfiguration(companyId)-->Line_42 $$ String algorithm = ldapAuthConfiguration.passwordEncryptionAlgorithm()[ FD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_29 $$ ldapAuthResult.setErrorMessage(e.getMessage())[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_29 $$ ldapAuthResult.setErrorMessage(e.getMessage())[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_37 $$ ldapAuthResult = new LDAPAuthResult()[ FD ]
Line_6 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)-->Line_9 $$ env.put(Context.REFERRAL, systemLDAPConfiguration.referral())[ FD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_22 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_11 $$ env.put(Context.SECURITY_PRINCIPAL, userDN)[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_6 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ CD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_9 $$ env.put(Context.REFERRAL, systemLDAPConfiguration.referral())[ CD ]
Line_17 $$ ldapAuthResult = new LDAPAuthResult()-->Line_30 $$ setFailedLDAPAuthResult(env, ldapAuthResult)[ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_14 $$ if (ldapAuthResult != null) [ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_22 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)-->Line_46 $$ if (ldapPassword.equals(encryptedPassword)) [ FD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_29 $$ ldapAuthResult.setErrorMessage(e.getMessage())[ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_5 $$ String authMethod = ldapAuthConfiguration.method()[ CD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_37 $$ ldapAuthResult = new LDAPAuthResult()[ FD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_17 $$ ldapAuthResult = new LDAPAuthResult()[ CD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)[ FD ]
Line_14 $$ if (ldapAuthResult != null) -->Line_15 $$ return ldapAuthResult[ CD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_4 $$ LDAPAuthConfiguration ldapAuthConfiguration = _ldapAuthConfigurationProvider.getConfiguration(companyId)[ CD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_23 $$ ldapAuthResult.setResponseControl(responseControls)[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)[ FD ]
Line_37 $$ ldapAuthResult = new LDAPAuthResult()-->Line_47 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_36 $$ if (authMethod.equals(AUTH_METHOD_PASSWORD_COMPARE)) -->Line_37 $$ ldapAuthResult = new LDAPAuthResult()[ CD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_47 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_17 $$ ldapAuthResult = new LDAPAuthResult()[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_22 $$ ldapAuthResult.setAuthenticated(true)[ FD ]
Line_40 $$ String ldapPassword = new String((byte[]) userPassword.get())-->Line_46 $$ if (ldapPassword.equals(encryptedPassword)) [ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_4 $$ LDAPAuthConfiguration ldapAuthConfiguration = _ldapAuthConfigurationProvider.getConfiguration(companyId)[ FD ]
Line_18 $$ InitialLdapContext initialLdapContext = null-->Line_32 $$ if (initialLdapContext != null) [ FD ]
Line_43 $$ if (Validator.isNotNull(algorithm)) -->Line_44 $$ encryptedPassword = _passwordEncryptor.encrypt(algorithm, password, ldapPassword)[ CD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_36 $$ if (authMethod.equals(AUTH_METHOD_PASSWORD_COMPARE)) [ CD ]
Line_8 $$ Hashtable<String, Object> env = (Hashtable<String, Object>) ctx.getEnvironment()-->Line_30 $$ setFailedLDAPAuthResult(env, ldapAuthResult)[ FD ]
Line_46 $$ if (ldapPassword.equals(encryptedPassword)) -->Line_49 $$ ldapAuthResult.setAuthenticated(false)[ CD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_30 $$ setFailedLDAPAuthResult(env, ldapAuthResult)[ FD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_11 $$ env.put(Context.SECURITY_PRINCIPAL, userDN)[ CD ]
Line_39 $$ if (userPassword != null) -->Line_40 $$ String ldapPassword = new String((byte[]) userPassword.get())[ CD ]
Line_13 $$ ldapAuthResult = getFailedLDAPAuthResult(env)-->Line_23 $$ ldapAuthResult.setResponseControl(responseControls)[ FD ]
Line_36 $$ if (authMethod.equals(AUTH_METHOD_PASSWORD_COMPARE)) -->Line_39 $$ if (userPassword != null) [ CD ]
Line_20 $$ initialLdapContext = new InitialLdapContext(env, null)-->Line_33 $$ initialLdapContext.close()[ FD ]
Line_18 $$ InitialLdapContext initialLdapContext = null-->Line_33 $$ initialLdapContext.close()[ FD ]
Line_42 $$ String algorithm = ldapAuthConfiguration.passwordEncryptionAlgorithm()-->Line_43 $$ if (Validator.isNotNull(algorithm)) [ FD ]
Line_2 $$ protected LDAPAuthResult authenticate(LdapContext ctx, long companyId, Attributes attributes, String userDN, String password) throws Exception -->Line_11 $$ env.put(Context.SECURITY_PRINCIPAL, userDN)[ FD ]
Line_3 $$ LDAPAuthResult ldapAuthResult = null-->Line_14 $$ if (ldapAuthResult != null) [ FD ]
Line_7 $$ if (authMethod.equals(AUTH_METHOD_BIND)) -->Line_10 $$ env.put(Context.SECURITY_CREDENTIALS, password)[ CD ]
Line_36 $$ if (authMethod.equals(AUTH_METHOD_PASSWORD_COMPARE)) -->Line_38 $$ Attribute userPassword = attributes.get("userPassword")[ CD ]
