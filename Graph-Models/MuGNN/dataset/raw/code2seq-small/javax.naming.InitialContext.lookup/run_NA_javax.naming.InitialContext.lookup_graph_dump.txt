Line_21 $$ if (expectedPrincipal != null) -->Line_22 $$ if (!expectedPrincipal.equals(callerPrincipal)) [ CD ]
Line_10 $$ initialContext = new InitialContext()-->Line_31 $$ final UserTransaction userTransaction = (UserTransaction) initialContext.lookup("java:comp/UserTransaction")[ FD ]
Line_31 $$ final UserTransaction userTransaction = (UserTransaction) initialContext.lookup("java:comp/UserTransaction")-->Line_32 $$ userTransaction.begin()[ FD ]
Line_10 $$ initialContext = new InitialContext()-->Line_16 $$ ejbContext = (SessionContext) initialContext.lookup("java:comp/EJBContext")[ FD ]
Line_20 $$ final Principal callerPrincipal = ejbContext.getCallerPrincipal()-->Line_22 $$ if (!expectedPrincipal.equals(callerPrincipal)) [ FD ]
Line_16 $$ ejbContext = (SessionContext) initialContext.lookup("java:comp/EJBContext")-->Line_20 $$ final Principal callerPrincipal = ejbContext.getCallerPrincipal()[ FD ]
Line_14 $$ final EJBContext ejbContext-->Line_16 $$ ejbContext = (SessionContext) initialContext.lookup("java:comp/EJBContext")[ FD ]
Line_14 $$ final EJBContext ejbContext-->Line_20 $$ final Principal callerPrincipal = ejbContext.getCallerPrincipal()[ FD ]
Line_2 $$ public void run() -->Line_8 $$ final InitialContext initialContext[ CD ]
Line_8 $$ final InitialContext initialContext-->Line_16 $$ ejbContext = (SessionContext) initialContext.lookup("java:comp/EJBContext")[ FD ]
Line_8 $$ final InitialContext initialContext-->Line_10 $$ initialContext = new InitialContext()[ FD ]
Line_2 $$ public void run() -->Line_20 $$ final Principal callerPrincipal = ejbContext.getCallerPrincipal()[ CD ]
Line_2 $$ public void run() -->Line_14 $$ final EJBContext ejbContext[ CD ]
Line_2 $$ public void run() -->Line_21 $$ if (expectedPrincipal != null) [ CD ]
Line_8 $$ final InitialContext initialContext-->Line_31 $$ final UserTransaction userTransaction = (UserTransaction) initialContext.lookup("java:comp/UserTransaction")[ FD ]
Line_21 $$ if (expectedPrincipal != null) -->Line_26 $$ if (callerPrincipal != null) [ CD ]
Line_20 $$ final Principal callerPrincipal = ejbContext.getCallerPrincipal()-->Line_26 $$ if (callerPrincipal != null) [ FD ]
Line_31 $$ final UserTransaction userTransaction = (UserTransaction) initialContext.lookup("java:comp/UserTransaction")-->Line_33 $$ userTransaction.rollback()[ FD ]
