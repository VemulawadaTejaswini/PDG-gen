Line_5 $$ Counters counters = runningJob.getCounters()-->Line_14 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_RECORDS).getCounter(), redRecs)[ FD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_24 $$ Object key = ReflectionUtils.newInstance(reader.getKeyClass(), conf)[ FD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_33 $$ mapSkipped.add(value.toString())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_7 $$ int mapRecs = input.size() - mapperBadRecords.size()[ CD ]
Line_59 $$ line = reader.readLine()-->Line_51 $$ while (line != null) [ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_4 $$ assertTrue(runningJob.isSuccessful())[ CD ]
Line_53 $$ StringTokenizer tokeniz = new StringTokenizer(line, "\t")-->Line_54 $$ String key = tokeniz.nextToken()[ FD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)[ FD ]
Line_27 $$ while (key != null) -->Line_28 $$ value = reader.getCurrentValue(value)[ CD ]
Line_50 $$ int counter = 0-->Line_62 $$ assertEquals(reducerOutput.size(), counter)[ FD ]
Line_16 $$ Path skipDir = SkipBadRecords.getSkipOutputPath(conf)-->Line_17 $$ assertNotNull(skipDir)[ FD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_61 $$ reader.close()[ CD ]
Line_42 $$ List<String> mapperOutput = getProcessed(input, mapperBadRecords)-->Line_43 $$ LOG.debug("mapperOutput " + mapperOutput.size())[ FD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_31 $$ redSkipped.add(value.toString())[ FD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_11 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_RECORDS).getCounter(), redBadRecords.size())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_16 $$ Path skipDir = SkipBadRecords.getSkipOutputPath(conf)[ CD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_29 $$ LOG.debug("key:" + key + " value:" + value.toString())[ FD ]
Line_51 $$ while (line != null) -->Line_52 $$ counter++[ CD ]
Line_50 $$ int counter = 0-->Line_52 $$ counter++[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_24 $$ Object key = ReflectionUtils.newInstance(reader.getKeyClass(), conf)[ FD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_8 $$ assertEquals(counters.findCounter(TaskCounter.MAP_INPUT_RECORDS).getCounter(), mapRecs)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_18 $$ Path[] skips = FileUtil.stat2Paths(getFileSystem().listStatus(skipDir))[ CD ]
Line_55 $$ String value = tokeniz.nextToken()-->Line_57 $$ assertTrue(value.contains("hello"))[ FD ]
Line_51 $$ while (line != null) -->Line_55 $$ String value = tokeniz.nextToken()[ CD ]
Line_53 $$ StringTokenizer tokeniz = new StringTokenizer(line, "\t")-->Line_55 $$ String value = tokeniz.nextToken()[ FD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_35 $$ key = reader.next(key)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_4 $$ assertTrue(runningJob.isSuccessful())[ FD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_28 $$ value = reader.getCurrentValue(value)[ FD ]
Line_55 $$ String value = tokeniz.nextToken()-->Line_58 $$ assertTrue(reducerOutput.contains(value))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_15 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_OUTPUT_RECORDS).getCounter(), redRecs)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_12 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_GROUPS).getCounter(), redBadRecords.size())[ FD ]
Line_30 $$ if (skipPath.getName().contains("_r_")) -->Line_31 $$ redSkipped.add(value.toString())[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_14 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_RECORDS).getCounter(), redRecs)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_10 $$ int redRecs = mapRecs - redBadRecords.size()[ CD ]
Line_20 $$ List<String> redSkipped = new ArrayList<String>()-->Line_31 $$ redSkipped.add(value.toString())[ FD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_58 $$ assertTrue(reducerOutput.contains(value))[ FD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_62 $$ assertEquals(reducerOutput.size(), counter)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)[ FD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_50 $$ int counter = 0[ CD ]
Line_7 $$ int mapRecs = input.size() - mapperBadRecords.size()-->Line_8 $$ assertEquals(counters.findCounter(TaskCounter.MAP_INPUT_RECORDS).getCounter(), mapRecs)[ FD ]
Line_30 $$ if (skipPath.getName().contains("_r_")) -->Line_33 $$ mapSkipped.add(value.toString())[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_42 $$ List<String> mapperOutput = getProcessed(input, mapperBadRecords)[ FD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_26 $$ key = reader.next(key)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_5 $$ Counters counters = runningJob.getCounters()[ FD ]
Line_26 $$ key = reader.next(key)-->Line_27 $$ while (key != null) [ FD ]
Line_7 $$ int mapRecs = input.size() - mapperBadRecords.size()-->Line_9 $$ assertEquals(counters.findCounter(TaskCounter.MAP_OUTPUT_RECORDS).getCounter(), mapRecs)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_7 $$ int mapRecs = input.size() - mapperBadRecords.size()[ FD ]
Line_28 $$ value = reader.getCurrentValue(value)-->Line_57 $$ assertTrue(value.contains("hello"))[ FD ]
Line_51 $$ while (line != null) -->Line_59 $$ line = reader.readLine()[ CD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_37 $$ reader.close()[ FD ]
Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)-->Line_45 $$ LOG.debug("reducerOutput " + reducerOutput.size())[ FD ]
Line_10 $$ int redRecs = mapRecs - redBadRecords.size()-->Line_14 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_RECORDS).getCounter(), redRecs)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_40 $$ assertTrue(redSkipped.containsAll(redBadRecords))[ CD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_49 $$ String line = reader.readLine()[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_20 $$ List<String> redSkipped = new ArrayList<String>()[ CD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_13 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_GROUPS).getCounter(), redRecs)[ FD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_9 $$ assertEquals(counters.findCounter(TaskCounter.MAP_OUTPUT_RECORDS).getCounter(), mapRecs)[ FD ]
Line_51 $$ while (line != null) -->Line_56 $$ LOG.debug("Output: key:" + key + "  value:" + value)[ CD ]
Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)-->Line_58 $$ assertTrue(reducerOutput.contains(value))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_5 $$ Counters counters = runningJob.getCounters()[ CD ]
Line_24 $$ Object key = ReflectionUtils.newInstance(reader.getKeyClass(), conf)-->Line_35 $$ key = reader.next(key)[ FD ]
Line_19 $$ List<String> mapSkipped = new ArrayList<String>()-->Line_39 $$ assertTrue(mapSkipped.containsAll(mapperBadRecords))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_46 $$ if (outputFiles.length > 0) [ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_19 $$ List<String> mapSkipped = new ArrayList<String>()[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_42 $$ List<String> mapperOutput = getProcessed(input, mapperBadRecords)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_6 $$ assertEquals(counters.findCounter(TaskCounter.MAP_SKIPPED_RECORDS).getCounter(), mapperBadRecords.size())[ CD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_49 $$ String line = reader.readLine()[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_3 $$ LOG.info(runningJob.getCounters().toString())[ FD ]
Line_10 $$ int redRecs = mapRecs - redBadRecords.size()-->Line_15 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_OUTPUT_RECORDS).getCounter(), redRecs)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_13 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_GROUPS).getCounter(), redRecs)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_16 $$ Path skipDir = SkipBadRecords.getSkipOutputPath(conf)[ FD ]
Line_49 $$ String line = reader.readLine()-->Line_59 $$ line = reader.readLine()[ FD ]
Line_42 $$ List<String> mapperOutput = getProcessed(input, mapperBadRecords)-->Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)[ FD ]
Line_51 $$ while (line != null) -->Line_57 $$ assertTrue(value.contains("hello"))[ CD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_61 $$ reader.close()[ FD ]
Line_21 $$ for (Path skipPath : skips) -->Line_30 $$ if (skipPath.getName().contains("_r_")) [ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_40 $$ assertTrue(redSkipped.containsAll(redBadRecords))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)[ FD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_59 $$ line = reader.readLine()[ FD ]
Line_51 $$ while (line != null) -->Line_54 $$ String key = tokeniz.nextToken()[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_11 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_RECORDS).getCounter(), redBadRecords.size())[ CD ]
Line_28 $$ value = reader.getCurrentValue(value)-->Line_58 $$ assertTrue(reducerOutput.contains(value))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_17 $$ assertNotNull(skipDir)[ CD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_15 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_OUTPUT_RECORDS).getCounter(), redRecs)[ FD ]
Line_51 $$ while (line != null) -->Line_53 $$ StringTokenizer tokeniz = new StringTokenizer(line, "\t")[ CD ]
Line_27 $$ while (key != null) -->Line_30 $$ if (skipPath.getName().contains("_r_")) [ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_6 $$ assertEquals(counters.findCounter(TaskCounter.MAP_SKIPPED_RECORDS).getCounter(), mapperBadRecords.size())[ FD ]
Line_25 $$ Object value = ReflectionUtils.newInstance(reader.getValueClass(), conf)-->Line_57 $$ assertTrue(value.contains("hello"))[ FD ]
Line_35 $$ key = reader.next(key)-->Line_27 $$ while (key != null) [ FD ]
Line_28 $$ value = reader.getCurrentValue(value)-->Line_33 $$ mapSkipped.add(value.toString())[ FD ]
Line_26 $$ key = reader.next(key)-->Line_35 $$ key = reader.next(key)[ FD ]
Line_28 $$ value = reader.getCurrentValue(value)-->Line_31 $$ redSkipped.add(value.toString())[ FD ]
Line_19 $$ List<String> mapSkipped = new ArrayList<String>()-->Line_33 $$ mapSkipped.add(value.toString())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_43 $$ LOG.debug("mapperOutput " + mapperOutput.size())[ CD ]
Line_24 $$ Object key = ReflectionUtils.newInstance(reader.getKeyClass(), conf)-->Line_26 $$ key = reader.next(key)[ FD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_12 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_GROUPS).getCounter(), redBadRecords.size())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_9 $$ assertEquals(counters.findCounter(TaskCounter.MAP_OUTPUT_RECORDS).getCounter(), mapRecs)[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_8 $$ assertEquals(counters.findCounter(TaskCounter.MAP_INPUT_RECORDS).getCounter(), mapRecs)[ CD ]
Line_24 $$ Object key = ReflectionUtils.newInstance(reader.getKeyClass(), conf)-->Line_27 $$ while (key != null) [ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_45 $$ LOG.debug("reducerOutput " + reducerOutput.size())[ CD ]
Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)-->Line_62 $$ assertEquals(reducerOutput.size(), counter)[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_11 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_RECORDS).getCounter(), redBadRecords.size())[ FD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_51 $$ while (line != null) [ CD ]
Line_16 $$ Path skipDir = SkipBadRecords.getSkipOutputPath(conf)-->Line_18 $$ Path[] skips = FileUtil.stat2Paths(getFileSystem().listStatus(skipDir))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_3 $$ LOG.info(runningJob.getCounters().toString())[ CD ]
Line_28 $$ value = reader.getCurrentValue(value)-->Line_29 $$ LOG.debug("key:" + key + " value:" + value.toString())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_12 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_SKIPPED_GROUPS).getCounter(), redBadRecords.size())[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_39 $$ assertTrue(mapSkipped.containsAll(mapperBadRecords))[ CD ]
Line_51 $$ while (line != null) -->Line_58 $$ assertTrue(reducerOutput.contains(value))[ CD ]
Line_27 $$ while (key != null) -->Line_29 $$ LOG.debug("key:" + key + " value:" + value.toString())[ CD ]
Line_23 $$ SequenceFile.Reader reader = new SequenceFile.Reader(getFileSystem(), skipPath, conf)-->Line_28 $$ value = reader.getCurrentValue(value)[ FD ]
Line_5 $$ Counters counters = runningJob.getCounters()-->Line_6 $$ assertEquals(counters.findCounter(TaskCounter.MAP_SKIPPED_RECORDS).getCounter(), mapperBadRecords.size())[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_41 $$ Path[] outputFiles = FileUtil.stat2Paths(getFileSystem().listStatus(getOutputDir(), new Utils.OutputFileUtils.OutputFilesFilter()))[ CD ]
Line_27 $$ while (key != null) -->Line_35 $$ key = reader.next(key)[ CD ]
Line_46 $$ if (outputFiles.length > 0) -->Line_47 $$ InputStream is = getFileSystem().open(outputFiles[0])[ CD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_44 $$ List<String> reducerOutput = getProcessed(mapperOutput, redBadRecords)[ CD ]
Line_49 $$ String line = reader.readLine()-->Line_51 $$ while (line != null) [ FD ]
Line_10 $$ int redRecs = mapRecs - redBadRecords.size()-->Line_13 $$ assertEquals(counters.findCounter(TaskCounter.REDUCE_INPUT_GROUPS).getCounter(), redRecs)[ FD ]
Line_20 $$ List<String> redSkipped = new ArrayList<String>()-->Line_40 $$ assertTrue(redSkipped.containsAll(redBadRecords))[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_10 $$ int redRecs = mapRecs - redBadRecords.size()[ FD ]
Line_2 $$ private void validateOutput(JobConf conf, RunningJob runningJob, List<String> mapperBadRecords, List<String> redBadRecords) throws Exception -->Line_39 $$ assertTrue(mapSkipped.containsAll(mapperBadRecords))[ FD ]
