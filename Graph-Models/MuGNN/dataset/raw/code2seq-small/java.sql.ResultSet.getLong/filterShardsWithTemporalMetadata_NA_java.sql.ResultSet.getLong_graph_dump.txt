Line_16 $$ while (resultSet.next()) -->Line_29 $$ ShardMetadata shard = shardsById.get(shardId)[ CD ]
Line_17 $$ long rangeStart = resultSet.getLong(minColumn)-->Line_31 $$ temporalShards.add(shard.withTimeRange(rangeStart, rangeEnd))[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_40 $$ return temporalShards.build()[ CD ]
Line_7 $$ try (Connection connection = dbi.open().getConnection()) -->Line_11 $$ try (PreparedStatement statement = connection.prepareStatement(sql)) [ FD ]
Line_16 $$ while (resultSet.next()) -->Line_18 $$ if (resultSet.wasNull()) [ CD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_16 $$ while (resultSet.next()) [ FD ]
Line_25 $$ long shardId = resultSet.getLong("shard_id")-->Line_29 $$ ShardMetadata shard = shardsById.get(shardId)[ FD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_18 $$ if (resultSet.wasNull()) [ FD ]
Line_29 $$ ShardMetadata shard = shardsById.get(shardId)-->Line_30 $$ if (shard != null) [ FD ]
Line_5 $$ String maxColumn = maxColumn(temporalColumnId)-->Line_21 $$ long rangeEnd = resultSet.getLong(maxColumn)[ FD ]
Line_6 $$ ImmutableSet.Builder<ShardMetadata> temporalShards = ImmutableSet.builder()-->Line_31 $$ temporalShards.add(shard.withTimeRange(rangeStart, rangeEnd))[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_5 $$ String maxColumn = maxColumn(temporalColumnId)[ CD ]
Line_16 $$ while (resultSet.next()) -->Line_30 $$ if (shard != null) [ CD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_4 $$ String minColumn = minColumn(temporalColumnId)[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_6 $$ ImmutableSet.Builder<ShardMetadata> temporalShards = ImmutableSet.builder()[ CD ]
Line_4 $$ String minColumn = minColumn(temporalColumnId)-->Line_17 $$ long rangeStart = resultSet.getLong(minColumn)[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_3 $$ Map<Long, ShardMetadata> shardsById = uniqueIndex(allShards, ShardMetadata::<>getShardId)[ FD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_22 $$ if (resultSet.wasNull()) [ FD ]
Line_29 $$ ShardMetadata shard = shardsById.get(shardId)-->Line_31 $$ temporalShards.add(shard.withTimeRange(rangeStart, rangeEnd))[ FD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_25 $$ long shardId = resultSet.getLong("shard_id")[ FD ]
Line_6 $$ ImmutableSet.Builder<ShardMetadata> temporalShards = ImmutableSet.builder()-->Line_40 $$ return temporalShards.build()[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_3 $$ Map<Long, ShardMetadata> shardsById = uniqueIndex(allShards, ShardMetadata::<>getShardId)[ CD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_17 $$ long rangeStart = resultSet.getLong(minColumn)[ FD ]
Line_10 $$ String sql = format("SELECT shard_id, %s, %s FROM %s WHERE shard_id IN (%s)", minColumn, maxColumn, shardIndexTable(tableId), args)-->Line_11 $$ try (PreparedStatement statement = connection.prepareStatement(sql)) [ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_10 $$ String sql = format("SELECT shard_id, %s, %s FROM %s WHERE shard_id IN (%s)", minColumn, maxColumn, shardIndexTable(tableId), args)[ FD ]
Line_11 $$ try (PreparedStatement statement = connection.prepareStatement(sql)) -->Line_13 $$ statement.setLong(i + 1, shards.get(i).getShardId())[ FD ]
Line_8 $$ for (List<ShardMetadata> shards : partition(allShards, 1000)) -->Line_13 $$ statement.setLong(i + 1, shards.get(i).getShardId())[ FD ]
Line_16 $$ while (resultSet.next()) -->Line_25 $$ long shardId = resultSet.getLong("shard_id")[ CD ]
Line_4 $$ String minColumn = minColumn(temporalColumnId)-->Line_10 $$ String sql = format("SELECT shard_id, %s, %s FROM %s WHERE shard_id IN (%s)", minColumn, maxColumn, shardIndexTable(tableId), args)[ FD ]
Line_8 $$ for (List<ShardMetadata> shards : partition(allShards, 1000)) -->Line_12 $$ for (int i = 0; i < shards.size(); i++) [ FD ]
Line_21 $$ long rangeEnd = resultSet.getLong(maxColumn)-->Line_31 $$ temporalShards.add(shard.withTimeRange(rangeStart, rangeEnd))[ FD ]
Line_16 $$ while (resultSet.next()) -->Line_22 $$ if (resultSet.wasNull()) [ CD ]
Line_16 $$ while (resultSet.next()) -->Line_21 $$ long rangeEnd = resultSet.getLong(maxColumn)[ CD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_26 $$ if (resultSet.wasNull()) [ FD ]
Line_30 $$ if (shard != null) -->Line_31 $$ temporalShards.add(shard.withTimeRange(rangeStart, rangeEnd))[ CD ]
Line_12 $$ for (int i = 0; i < shards.size(); i++) -->Line_13 $$ statement.setLong(i + 1, shards.get(i).getShardId())[ CD ]
Line_12 $$ for (int i = 0; i < shards.size(); i++) -->Line_13 $$ statement.setLong(i + 1, shards.get(i).getShardId())[ FD ]
Line_3 $$ Map<Long, ShardMetadata> shardsById = uniqueIndex(allShards, ShardMetadata::<>getShardId)-->Line_29 $$ ShardMetadata shard = shardsById.get(shardId)[ FD ]
Line_9 $$ String args = Joiner.on(",").join(nCopies(shards.size(), "?"))-->Line_10 $$ String sql = format("SELECT shard_id, %s, %s FROM %s WHERE shard_id IN (%s)", minColumn, maxColumn, shardIndexTable(tableId), args)[ FD ]
Line_8 $$ for (List<ShardMetadata> shards : partition(allShards, 1000)) -->Line_9 $$ String args = Joiner.on(",").join(nCopies(shards.size(), "?"))[ FD ]
Line_11 $$ try (PreparedStatement statement = connection.prepareStatement(sql)) -->Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) [ FD ]
Line_15 $$ try (ResultSet resultSet = statement.executeQuery()) -->Line_21 $$ long rangeEnd = resultSet.getLong(maxColumn)[ FD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_8 $$ for (List<ShardMetadata> shards : partition(allShards, 1000)) [ FD ]
Line_5 $$ String maxColumn = maxColumn(temporalColumnId)-->Line_10 $$ String sql = format("SELECT shard_id, %s, %s FROM %s WHERE shard_id IN (%s)", minColumn, maxColumn, shardIndexTable(tableId), args)[ FD ]
Line_16 $$ while (resultSet.next()) -->Line_17 $$ long rangeStart = resultSet.getLong(minColumn)[ CD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_4 $$ String minColumn = minColumn(temporalColumnId)[ CD ]
Line_2 $$ Set<ShardMetadata> filterShardsWithTemporalMetadata(Iterable<ShardMetadata> allShards, long tableId, long temporalColumnId) -->Line_5 $$ String maxColumn = maxColumn(temporalColumnId)[ FD ]
Line_16 $$ while (resultSet.next()) -->Line_26 $$ if (resultSet.wasNull()) [ CD ]
