Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_8 $$ assertUpdate("DELETE FROM test_metadata_delete WHERE LINE_STATUS='O'")[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_16 $$ assertQuery("SELECT * from test_metadata_delete", "SELECT orderkey, linenumber, linestatus FROM lineitem WHERE linestatus<>'O' and linenumber<>3")[ CD ]
Line_3 $$ String createTable = "" + "CREATE TABLE test_metadata_delete " + "(" + "  LINE_STATUS VARCHAR," + "  LINE_NUMBER BIGINT," + "  ORDER_KEY BIGINT" + ") " + "WITH (" + STORAGE_FORMAT_PROPERTY + " = '" + storageFormat + "', " + PARTITIONED_BY_PROPERTY + " = ARRAY[ 'LINE_NUMBER', 'LINE_STATUS' ]" + ") "-->Line_4 $$ assertUpdate(createTable)[ FD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_17 $$ assertUpdate("DROP TABLE test_metadata_delete")[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_3 $$ String createTable = "" + "CREATE TABLE test_metadata_delete " + "(" + "  LINE_STATUS VARCHAR," + "  LINE_NUMBER BIGINT," + "  ORDER_KEY BIGINT" + ") " + "WITH (" + STORAGE_FORMAT_PROPERTY + " = '" + storageFormat + "', " + PARTITIONED_BY_PROPERTY + " = ARRAY[ 'LINE_NUMBER', 'LINE_STATUS' ]" + ") "[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_5 $$ assertUpdate("" + "INSERT INTO test_metadata_delete " + "SELECT orderkey, linenumber, linestatus " + "FROM tpch.tiny.lineitem", "SELECT count(*) from lineitem")[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_18 $$ assertFalse(queryRunner.tableExists(getSession(), "test_metadata_delete"))[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_7 $$ assertQuery("SELECT * from test_metadata_delete", "SELECT orderkey, linenumber, linestatus FROM lineitem WHERE linestatus<>'F' or linenumber<>3")[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_4 $$ assertUpdate(createTable)[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_6 $$ assertUpdate("DELETE FROM test_metadata_delete WHERE LINE_STATUS='F' and LINE_NUMBER=3")[ CD ]
Line_2 $$ private void testMetadataDelete(HiveStorageFormat storageFormat) throws Exception -->Line_9 $$ assertQuery("SELECT * from test_metadata_delete", "SELECT orderkey, linenumber, linestatus FROM lineitem WHERE linestatus<>'O' and linenumber<>3")[ CD ]
