Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()-->Line_8 $$ FileSystem fileSys = cluster.getFileSystem()[ FD ]
Line_21 $$ ExtendedBlock newBlock = new ExtendedBlock(firstBlock.getBlockPoolId(), newBlockId, 0, firstBlock.getGenerationStamp())-->Line_22 $$ namenode.updateBlockForPipeline(newBlock, "")[ FD ]
Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()-->Line_22 $$ namenode.updateBlockForPipeline(newBlock, "")[ FD ]
Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()-->Line_41 $$ namenode.updateBlockForPipeline(firstBlock, "test" + dfs.clientName)[ FD ]
Line_27 $$ DFSOutputStream out = null-->Line_54 $$ IOUtils.closeStream(out)[ FD ]
Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())-->Line_30 $$ out.write(1)[ FD ]
Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())-->Line_54 $$ IOUtils.closeStream(out)[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_14 $$ namenode.updateBlockForPipeline(firstBlock, "")[ FD ]
Line_2 $$ public void testGetNewStamp() throws IOException -->Line_3 $$ int numDataNodes = 1[ CD ]
Line_10 $$ Path file = new Path("dataprotocol.dat")-->Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)[ FD ]
Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())-->Line_31 $$ out.hflush()[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_52 $$ namenode.updateBlockForPipeline(firstBlock, dfs.clientName)[ FD ]
Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()-->Line_41 $$ namenode.updateBlockForPipeline(firstBlock, "test" + dfs.clientName)[ FD ]
Line_2 $$ public void testGetNewStamp() throws IOException -->Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()[ CD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_21 $$ ExtendedBlock newBlock = new ExtendedBlock(firstBlock.getBlockPoolId(), newBlockId, 0, firstBlock.getGenerationStamp())[ FD ]
Line_34 $$ in = fileSys.open(file)-->Line_37 $$ IOUtils.closeStream(in)[ FD ]
Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()-->Line_7 $$ cluster.waitActive()[ FD ]
Line_8 $$ FileSystem fileSys = cluster.getFileSystem()-->Line_34 $$ in = fileSys.open(file)[ FD ]
Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()-->Line_52 $$ namenode.updateBlockForPipeline(firstBlock, dfs.clientName)[ FD ]
Line_27 $$ DFSOutputStream out = null-->Line_31 $$ out.hflush()[ FD ]
Line_32 $$ FSDataInputStream in = null-->Line_37 $$ IOUtils.closeStream(in)[ FD ]
Line_8 $$ FileSystem fileSys = cluster.getFileSystem()-->Line_11 $$ DFSTestUtil.createFile(fileSys, file, 1L, (short) numDataNodes, 0L)[ FD ]
Line_2 $$ public void testGetNewStamp() throws IOException -->Line_4 $$ Configuration conf = new HdfsConfiguration()[ CD ]
Line_10 $$ Path file = new Path("dataprotocol.dat")-->Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())[ FD ]
Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()-->Line_14 $$ namenode.updateBlockForPipeline(firstBlock, "")[ FD ]
Line_32 $$ FSDataInputStream in = null-->Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_41 $$ namenode.updateBlockForPipeline(firstBlock, "test" + dfs.clientName)[ FD ]
Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()-->Line_47 $$ namenode.updateBlockForPipeline(firstBlock, null)[ FD ]
Line_8 $$ FileSystem fileSys = cluster.getFileSystem()-->Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)[ FD ]
Line_34 $$ in = fileSys.open(file)-->Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()[ FD ]
Line_8 $$ FileSystem fileSys = cluster.getFileSystem()-->Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())[ FD ]
Line_10 $$ Path file = new Path("dataprotocol.dat")-->Line_11 $$ DFSTestUtil.createFile(fileSys, file, 1L, (short) numDataNodes, 0L)[ FD ]
Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()-->Line_57 $$ cluster.shutdown()[ FD ]
Line_3 $$ int numDataNodes = 1-->Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()[ FD ]
Line_32 $$ FSDataInputStream in = null-->Line_34 $$ in = fileSys.open(file)[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_35 $$ firstBlock = DFSTestUtil.getAllBlocks(in).get(0).getBlock()[ FD ]
Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()-->Line_52 $$ namenode.updateBlockForPipeline(firstBlock, dfs.clientName)[ FD ]
Line_5 $$ MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build()-->Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()[ FD ]
Line_27 $$ DFSOutputStream out = null-->Line_30 $$ out.write(1)[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_47 $$ namenode.updateBlockForPipeline(firstBlock, null)[ FD ]
Line_27 $$ DFSOutputStream out = null-->Line_29 $$ out = (DFSOutputStream) (fileSys.append(file).getWrappedStream())[ FD ]
Line_10 $$ Path file = new Path("dataprotocol.dat")-->Line_34 $$ in = fileSys.open(file)[ FD ]
Line_12 $$ ExtendedBlock firstBlock = DFSTestUtil.getFirstBlock(fileSys, file)-->Line_20 $$ long newBlockId = firstBlock.getBlockId() + 1[ FD ]
Line_9 $$ NamenodeProtocols namenode = cluster.getNameNodeRpc()-->Line_47 $$ namenode.updateBlockForPipeline(firstBlock, null)[ FD ]
