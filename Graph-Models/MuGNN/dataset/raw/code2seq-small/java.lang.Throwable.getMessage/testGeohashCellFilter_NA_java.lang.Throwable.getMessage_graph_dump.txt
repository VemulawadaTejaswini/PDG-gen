Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()-->Line_32 $$ long expectedCount = expectedCounts.get(builder)[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_24 $$ expectedCounts.put(geoHashCellQuery("pin", geohash, false), 1L)[ CD ]
Line_23 $$ Map<GeohashCellQuery.Builder, String[]> expectedResults = new HashMap()-->Line_35 $$ String[] expectedIds = expectedResults.get(builder)[ FD ]
Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()-->Line_17 $$ iterator = parentNeighbors.iterator()[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_23 $$ Map<GeohashCellQuery.Builder, String[]> expectedResults = new HashMap()[ CD ]
Line_3 $$ String geohash = randomhash(10)-->Line_24 $$ expectedCounts.put(geoHashCellQuery("pin", geohash, false), 1L)[ FD ]
Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()-->Line_28 $$ expectedCounts.put(geoHashCellQuery("pin", point).neighbors(true).precision(precision), 1L + neighbors.size())[ FD ]
Line_3 $$ String geohash = randomhash(10)-->Line_26 $$ GeoPoint point = GeoPoint.fromGeohash(geohash)[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_27 $$ int precision = geohash.length()[ CD ]
Line_23 $$ Map<GeohashCellQuery.Builder, String[]> expectedResults = new HashMap()-->Line_41 $$ expectedResults.put(builder, ids.toArray(Strings.EMPTY_ARRAY))[ FD ]
Line_6 $$ Collection<? extends CharSequence> parentNeighbors = GeoHashUtils.neighbors(geohash.substring(0, geohash.length() - 1))-->Line_8 $$ logger.info("Parent Neighbors [ FD ]
Line_30 $$ for (GeohashCellQuery.Builder builder : filterBuilders) -->Line_41 $$ expectedResults.put(builder, ids.toArray(Strings.EMPTY_ARRAY))[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_18 $$ for (int i = 0; iterator.hasNext(); i++) [ CD ]
Line_26 $$ GeoPoint point = GeoPoint.fromGeohash(geohash)-->Line_28 $$ expectedCounts.put(geoHashCellQuery("pin", point).neighbors(true).precision(precision), 1L + neighbors.size())[ FD ]
Line_30 $$ for (GeohashCellQuery.Builder builder : filterBuilders) -->Line_35 $$ String[] expectedIds = expectedResults.get(builder)[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_17 $$ iterator = parentNeighbors.iterator()[ CD ]
Line_27 $$ int precision = geohash.length()-->Line_28 $$ expectedCounts.put(geoHashCellQuery("pin", point).neighbors(true).precision(precision), 1L + neighbors.size())[ FD ]
Line_3 $$ String geohash = randomhash(10)-->Line_11 $$ client().prepareIndex("locations", "location", "1").setCreate(true).setSource("pin", geohash).execute().actionGet()[ FD ]
Line_13 $$ for (int i = 0; iterator.hasNext(); i++) -->Line_14 $$ client().prepareIndex("locations", "location", "N" + i).setCreate(true).setSource("pin", iterator.next()).execute().actionGet()[ CD ]
Line_33 $$ SearchResponse response = client().prepareSearch("locations").setQuery(QueryBuilders.matchAllQuery()).setPostFilter(builder).setSize((int) expectedCount).get()-->Line_44 $$ assertSearchHits(response, expectedIds)[ FD ]
Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()-->Line_19 $$ client().prepareIndex("locations", "location", "p" + i).setCreate(true).setSource("pin", iterator.next()).execute().actionGet()[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_10 $$ client().admin().indices().prepareCreate("locations").addMapping("location", "pin", "type=geo_point,geohash_prefix=true,lat_lon=false").execute().actionGet()[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_3 $$ String geohash = randomhash(10)[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_6 $$ Collection<? extends CharSequence> parentNeighbors = GeoHashUtils.neighbors(geohash.substring(0, geohash.length() - 1))[ CD ]
Line_3 $$ String geohash = randomhash(10)-->Line_27 $$ int precision = geohash.length()[ FD ]
Line_13 $$ for (int i = 0; iterator.hasNext(); i++) -->Line_18 $$ for (int i = 0; iterator.hasNext(); i++) [ FD ]
Line_30 $$ for (GeohashCellQuery.Builder builder : filterBuilders) -->Line_33 $$ SearchResponse response = client().prepareSearch("locations").setQuery(QueryBuilders.matchAllQuery()).setPostFilter(builder).setSize((int) expectedCount).get()[ FD ]
Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()-->Line_18 $$ for (int i = 0; iterator.hasNext(); i++) [ FD ]
Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)-->Line_28 $$ expectedCounts.put(geoHashCellQuery("pin", point).neighbors(true).precision(precision), 1L + neighbors.size())[ FD ]
Line_37 $$ ArrayList<String> ids = new ArrayList()-->Line_39 $$ ids.add(hit.id())[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()[ CD ]
Line_6 $$ Collection<? extends CharSequence> parentNeighbors = GeoHashUtils.neighbors(geohash.substring(0, geohash.length() - 1))-->Line_17 $$ iterator = parentNeighbors.iterator()[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_21 $$ client().admin().indices().prepareRefresh("locations").execute().actionGet()[ CD ]
Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)-->Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()[ FD ]
Line_6 $$ Collection<? extends CharSequence> parentNeighbors = GeoHashUtils.neighbors(geohash.substring(0, geohash.length() - 1))-->Line_25 $$ expectedCounts.put(geoHashCellQuery("pin", geohash.substring(0, geohash.length() - 1), true), 2L + neighbors.size() + parentNeighbors.size())[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_11 $$ client().prepareIndex("locations", "location", "1").setCreate(true).setSource("pin", geohash).execute().actionGet()[ CD ]
Line_18 $$ for (int i = 0; iterator.hasNext(); i++) -->Line_19 $$ client().prepareIndex("locations", "location", "p" + i).setCreate(true).setSource("pin", iterator.next()).execute().actionGet()[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_8 $$ logger.info("Parent Neighbors [ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_29 $$ List<GeohashCellQuery.Builder> filterBuilders = new ArrayList(expectedCounts.keySet())[ CD ]
Line_38 $$ for (SearchHit hit : response.getHits()) -->Line_39 $$ ids.add(hit.id())[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()[ CD ]
Line_36 $$ if (expectedIds == null) -->Line_37 $$ ArrayList<String> ids = new ArrayList()[ CD ]
Line_3 $$ String geohash = randomhash(10)-->Line_4 $$ logger.info("Testing geohash_cell filter for [[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_16 $$ client().prepareIndex("locations", "location", "p").setCreate(true).setSource("pin", geohash.substring(0, geohash.length() - 1)).execute().actionGet()[ CD ]
Line_33 $$ SearchResponse response = client().prepareSearch("locations").setQuery(QueryBuilders.matchAllQuery()).setPostFilter(builder).setSize((int) expectedCount).get()-->Line_34 $$ assertHitCount(response, expectedCount)[ FD ]
Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()-->Line_29 $$ List<GeohashCellQuery.Builder> filterBuilders = new ArrayList(expectedCounts.keySet())[ FD ]
Line_33 $$ SearchResponse response = client().prepareSearch("locations").setQuery(QueryBuilders.matchAllQuery()).setPostFilter(builder).setSize((int) expectedCount).get()-->Line_38 $$ for (SearchHit hit : response.getHits()) [ FD ]
Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()-->Line_25 $$ expectedCounts.put(geoHashCellQuery("pin", geohash.substring(0, geohash.length() - 1), true), 2L + neighbors.size() + parentNeighbors.size())[ FD ]
Line_35 $$ String[] expectedIds = expectedResults.get(builder)-->Line_36 $$ if (expectedIds == null) [ FD ]
Line_3 $$ String geohash = randomhash(10)-->Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_13 $$ for (int i = 0; iterator.hasNext(); i++) [ CD ]
Line_3 $$ String geohash = randomhash(10)-->Line_25 $$ expectedCounts.put(geoHashCellQuery("pin", geohash.substring(0, geohash.length() - 1), true), 2L + neighbors.size() + parentNeighbors.size())[ FD ]
Line_36 $$ if (expectedIds == null) -->Line_41 $$ expectedResults.put(builder, ids.toArray(Strings.EMPTY_ARRAY))[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_25 $$ expectedCounts.put(geoHashCellQuery("pin", geohash.substring(0, geohash.length() - 1), true), 2L + neighbors.size() + parentNeighbors.size())[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_28 $$ expectedCounts.put(geoHashCellQuery("pin", point).neighbors(true).precision(precision), 1L + neighbors.size())[ CD ]
Line_30 $$ for (GeohashCellQuery.Builder builder : filterBuilders) -->Line_32 $$ long expectedCount = expectedCounts.get(builder)[ FD ]
Line_37 $$ ArrayList<String> ids = new ArrayList()-->Line_41 $$ expectedResults.put(builder, ids.toArray(Strings.EMPTY_ARRAY))[ FD ]
Line_32 $$ long expectedCount = expectedCounts.get(builder)-->Line_34 $$ assertHitCount(response, expectedCount)[ FD ]
Line_22 $$ Map<GeohashCellQuery.Builder, Long> expectedCounts = new HashMap()-->Line_24 $$ expectedCounts.put(geoHashCellQuery("pin", geohash, false), 1L)[ FD ]
Line_17 $$ iterator = parentNeighbors.iterator()-->Line_19 $$ client().prepareIndex("locations", "location", "p" + i).setCreate(true).setSource("pin", iterator.next()).execute().actionGet()[ FD ]
Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)-->Line_25 $$ expectedCounts.put(geoHashCellQuery("pin", geohash.substring(0, geohash.length() - 1), true), 2L + neighbors.size() + parentNeighbors.size())[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_9 $$ ensureYellow()[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_4 $$ logger.info("Testing geohash_cell filter for [[ CD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_7 $$ logger.info("Neighbors [ CD ]
Line_35 $$ String[] expectedIds = expectedResults.get(builder)-->Line_44 $$ assertSearchHits(response, expectedIds)[ FD ]
Line_3 $$ String geohash = randomhash(10)-->Line_16 $$ client().prepareIndex("locations", "location", "p").setCreate(true).setSource("pin", geohash.substring(0, geohash.length() - 1)).execute().actionGet()[ FD ]
Line_17 $$ iterator = parentNeighbors.iterator()-->Line_18 $$ for (int i = 0; iterator.hasNext(); i++) [ FD ]
Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()-->Line_14 $$ client().prepareIndex("locations", "location", "N" + i).setCreate(true).setSource("pin", iterator.next()).execute().actionGet()[ FD ]
Line_2 $$ public void testGeohashCellFilter() throws IOException -->Line_26 $$ GeoPoint point = GeoPoint.fromGeohash(geohash)[ CD ]
Line_5 $$ Collection<? extends CharSequence> neighbors = GeoHashUtils.neighbors(geohash)-->Line_7 $$ logger.info("Neighbors [ FD ]
Line_3 $$ String geohash = randomhash(10)-->Line_6 $$ Collection<? extends CharSequence> parentNeighbors = GeoHashUtils.neighbors(geohash.substring(0, geohash.length() - 1))[ FD ]
Line_12 $$ Iterator<? extends CharSequence> iterator = neighbors.iterator()-->Line_13 $$ for (int i = 0; iterator.hasNext(); i++) [ FD ]
