Line_24 $$ final FileStatus source = fs.getFileStatus(path)-->Line_29 $$ Assert.assertTrue(!preserve || source.getBlockSize() == target.getBlockSize())[ FD ]
Line_23 $$ final Path targetPath = new Path(path.toString().replaceAll(SOURCE_PATH, TARGET_PATH))-->Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)[ FD ]
Line_24 $$ final FileStatus source = fs.getFileStatus(path)-->Line_30 $$ Assert.assertTrue(!preserve || source.getReplication() == target.getReplication())[ FD ]
Line_26 $$ if (!source.isDirectory()) -->Line_30 $$ Assert.assertTrue(!preserve || source.getReplication() == target.getReplication())[ CD ]
Line_6 $$ FileSystem fs = cluster.getFileSystem()-->Line_19 $$ final FileStatus fileStatus = fs.getFileStatus(path)[ FD ]
Line_24 $$ final FileStatus source = fs.getFileStatus(path)-->Line_27 $$ Assert.assertTrue(preserve || source.getBlockSize() != target.getBlockSize())[ FD ]
Line_11 $$ EnumSet<DistCpOptions.FileAttribute> fileAttributes = EnumSet.noneOf(DistCpOptions.FileAttribute.class)-->Line_13 $$ fileAttributes.add(DistCpOptions.FileAttribute.BLOCKSIZE)[ FD ]
Line_8 $$ StubContext stubContext = new StubContext(getConfiguration(), null, 0)-->Line_9 $$ Mapper<Text, CopyListingFileStatus, Text, Text>.Context<Text, CopyListingFileStatus, Text, Text> context = stubContext.getContext()[ FD ]
Line_11 $$ EnumSet<DistCpOptions.FileAttribute> fileAttributes = EnumSet.noneOf(DistCpOptions.FileAttribute.class)-->Line_16 $$ configuration.set(DistCpOptionSwitch.PRESERVE_STATUS.getConfigLabel(), DistCpUtils.packAttributes(fileAttributes))[ FD ]
Line_26 $$ if (!source.isDirectory()) -->Line_28 $$ Assert.assertTrue(preserve || source.getReplication() != target.getReplication())[ CD ]
Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)-->Line_27 $$ Assert.assertTrue(preserve || source.getBlockSize() != target.getBlockSize())[ FD ]
Line_2 $$ private void testPreserveBlockSizeAndReplicationImpl(boolean preserve) -->Line_29 $$ Assert.assertTrue(!preserve || source.getBlockSize() == target.getBlockSize())[ FD ]
Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)-->Line_28 $$ Assert.assertTrue(preserve || source.getReplication() != target.getReplication())[ FD ]
Line_9 $$ Mapper<Text, CopyListingFileStatus, Text, Text>.Context<Text, CopyListingFileStatus, Text, Text> context = stubContext.getContext()-->Line_17 $$ copyMapper.setup(context)[ FD ]
Line_9 $$ Mapper<Text, CopyListingFileStatus, Text, Text>.Context<Text, CopyListingFileStatus, Text, Text> context = stubContext.getContext()-->Line_10 $$ Configuration configuration = context.getConfiguration()[ FD ]
Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)-->Line_29 $$ Assert.assertTrue(!preserve || source.getBlockSize() == target.getBlockSize())[ FD ]
Line_7 $$ CopyMapper copyMapper = new CopyMapper()-->Line_17 $$ copyMapper.setup(context)[ FD ]
Line_12 $$ if (preserve) -->Line_14 $$ fileAttributes.add(DistCpOptions.FileAttribute.REPLICATION)[ CD ]
Line_24 $$ final FileStatus source = fs.getFileStatus(path)-->Line_28 $$ Assert.assertTrue(preserve || source.getReplication() != target.getReplication())[ FD ]
Line_10 $$ Configuration configuration = context.getConfiguration()-->Line_16 $$ configuration.set(DistCpOptionSwitch.PRESERVE_STATUS.getConfigLabel(), DistCpUtils.packAttributes(fileAttributes))[ FD ]
Line_6 $$ FileSystem fs = cluster.getFileSystem()-->Line_24 $$ final FileStatus source = fs.getFileStatus(path)[ FD ]
Line_26 $$ if (!source.isDirectory()) -->Line_29 $$ Assert.assertTrue(!preserve || source.getBlockSize() == target.getBlockSize())[ CD ]
Line_18 $$ for (Path path : pathList) -->Line_23 $$ final Path targetPath = new Path(path.toString().replaceAll(SOURCE_PATH, TARGET_PATH))[ FD ]
Line_11 $$ EnumSet<DistCpOptions.FileAttribute> fileAttributes = EnumSet.noneOf(DistCpOptions.FileAttribute.class)-->Line_14 $$ fileAttributes.add(DistCpOptions.FileAttribute.REPLICATION)[ FD ]
Line_2 $$ private void testPreserveBlockSizeAndReplicationImpl(boolean preserve) -->Line_30 $$ Assert.assertTrue(!preserve || source.getReplication() == target.getReplication())[ FD ]
Line_18 $$ for (Path path : pathList) -->Line_19 $$ final FileStatus fileStatus = fs.getFileStatus(path)[ FD ]
Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)-->Line_30 $$ Assert.assertTrue(!preserve || source.getReplication() == target.getReplication())[ FD ]
Line_6 $$ FileSystem fs = cluster.getFileSystem()-->Line_25 $$ final FileStatus target = fs.getFileStatus(targetPath)[ FD ]
Line_12 $$ if (preserve) -->Line_13 $$ fileAttributes.add(DistCpOptions.FileAttribute.BLOCKSIZE)[ CD ]
Line_18 $$ for (Path path : pathList) -->Line_20 $$ copyMapper.map(new Text(DistCpUtils.getRelativePath(new Path(SOURCE_PATH), path)), new CopyListingFileStatus(fileStatus), context)[ FD ]
Line_26 $$ if (!source.isDirectory()) -->Line_27 $$ Assert.assertTrue(preserve || source.getBlockSize() != target.getBlockSize())[ CD ]
Line_7 $$ CopyMapper copyMapper = new CopyMapper()-->Line_20 $$ copyMapper.map(new Text(DistCpUtils.getRelativePath(new Path(SOURCE_PATH), path)), new CopyListingFileStatus(fileStatus), context)[ FD ]
Line_9 $$ Mapper<Text, CopyListingFileStatus, Text, Text>.Context<Text, CopyListingFileStatus, Text, Text> context = stubContext.getContext()-->Line_20 $$ copyMapper.map(new Text(DistCpUtils.getRelativePath(new Path(SOURCE_PATH), path)), new CopyListingFileStatus(fileStatus), context)[ FD ]
Line_18 $$ for (Path path : pathList) -->Line_24 $$ final FileStatus source = fs.getFileStatus(path)[ FD ]
Line_24 $$ final FileStatus source = fs.getFileStatus(path)-->Line_26 $$ if (!source.isDirectory()) [ FD ]
