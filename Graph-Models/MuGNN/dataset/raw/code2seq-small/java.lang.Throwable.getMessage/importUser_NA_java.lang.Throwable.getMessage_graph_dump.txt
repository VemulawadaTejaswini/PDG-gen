Line_6 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)-->Line_7 $$ String baseDN = ldapServerConfiguration.baseDN()[ FD ]
Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_27 $$ if (enu.hasMoreElements()) [ FD ]
Line_49 $$ if (ldapContext != null) -->Line_50 $$ ldapContext.close()[ CD ]
Line_4 $$ NamingEnumeration<SearchResult> enu = null-->Line_31 $$ Binding binding = enu.nextElement()[ FD ]
Line_27 $$ if (enu.hasMoreElements()) -->Line_33 $$ return importUser(ldapServerId, companyId, ldapContext, attributes, StringPool.BLANK)[ CD ]
Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_46 $$ if (enu != null) [ FD ]
Line_41 $$ if (_log.isDebugEnabled()) -->Line_42 $$ _log.debug(e, e)[ CD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))[ FD ]
Line_38 $$ if (_log.isWarnEnabled()) -->Line_39 $$ _log.warn("Problem accessing LDAP server " + e.getMessage())[ CD ]
Line_14 $$ if (_log.isDebugEnabled()) -->Line_15 $$ _log.debug("Search filter before transformation " + filter)[ CD ]
Line_13 $$ String filter = ldapServerConfiguration.authSearchFilter()-->Line_18 $$ LDAPUtil.validateFilter(filter)[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_33 $$ return importUser(ldapServerId, companyId, ldapContext, attributes, StringPool.BLANK)[ FD ]
Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))-->Line_33 $$ return importUser(ldapServerId, companyId, ldapContext, attributes, StringPool.BLANK)[ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ FD ]
Line_17 $$ filter = StringUtil.replace(filter, new String[] -->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_3 $$ LdapContext ldapContext = null[ CD ]
Line_25 $$ SearchControls searchControls = new SearchControls(SearchControls.SUBTREE_SCOPE, 1, 0, new String[] -->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_49 $$ if (ldapContext != null) [ FD ]
Line_13 $$ String filter = ldapServerConfiguration.authSearchFilter()-->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_33 $$ return importUser(ldapServerId, companyId, ldapContext, attributes, StringPool.BLANK)[ FD ]
Line_31 $$ Binding binding = enu.nextElement()-->Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))[ FD ]
Line_17 $$ filter = StringUtil.replace(filter, new String[] -->Line_18 $$ LDAPUtil.validateFilter(filter)[ FD ]
Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_47 $$ enu.close()[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_17 $$ filter = StringUtil.replace(filter, new String[] [ FD ]
Line_4 $$ NamingEnumeration<SearchResult> enu = null-->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_22 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)-->Line_23 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_22 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)[ FD ]
Line_7 $$ String baseDN = ldapServerConfiguration.baseDN()-->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_28 $$ if (_log.isDebugEnabled()) -->Line_29 $$ _log.debug("Search filter returned at least one result")[ CD ]
Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_31 $$ Binding binding = enu.nextElement()[ FD ]
Line_13 $$ String filter = ldapServerConfiguration.authSearchFilter()-->Line_17 $$ filter = StringUtil.replace(filter, new String[] [ FD ]
Line_19 $$ if (_log.isDebugEnabled()) -->Line_20 $$ _log.debug("Search filter after transformation " + filter)[ CD ]
Line_27 $$ if (enu.hasMoreElements()) -->Line_35 $$ return null[ CD ]
Line_4 $$ NamingEnumeration<SearchResult> enu = null-->Line_47 $$ enu.close()[ FD ]
Line_9 $$ if (ldapContext == null) -->Line_11 $$ return null[ CD ]
Line_27 $$ if (enu.hasMoreElements()) -->Line_28 $$ if (_log.isDebugEnabled()) [ CD ]
Line_6 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)-->Line_13 $$ String filter = ldapServerConfiguration.authSearchFilter()[ FD ]
Line_4 $$ NamingEnumeration<SearchResult> enu = null-->Line_46 $$ if (enu != null) [ FD ]
Line_23 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))-->Line_24 $$ userMappingsScreenName = StringUtil.toLowerCase(userMappingsScreenName)[ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_49 $$ if (ldapContext != null) [ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_4 $$ NamingEnumeration<SearchResult> enu = null[ CD ]
Line_9 $$ if (ldapContext == null) -->Line_10 $$ _log.error("Unable to bind to the LDAP server")[ CD ]
Line_27 $$ if (enu.hasMoreElements()) -->Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))[ CD ]
Line_27 $$ if (enu.hasMoreElements()) -->Line_31 $$ Binding binding = enu.nextElement()[ CD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_32 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, _portalLDAP.getNameInNamespace(ldapServerId, companyId, binding))[ FD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_50 $$ ldapContext.close()[ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_9 $$ if (ldapContext == null) [ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ FD ]
Line_2 $$ public User importUser(long ldapServerId, long companyId, String emailAddress, String screenName) throws Exception -->Line_6 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)[ FD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_4 $$ NamingEnumeration<SearchResult> enu = null-->Line_27 $$ if (enu.hasMoreElements()) [ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_50 $$ ldapContext.close()[ FD ]
Line_8 $$ ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_9 $$ if (ldapContext == null) [ FD ]
Line_46 $$ if (enu != null) -->Line_47 $$ enu.close()[ CD ]
Line_3 $$ LdapContext ldapContext = null-->Line_33 $$ return importUser(ldapServerId, companyId, ldapContext, attributes, StringPool.BLANK)[ FD ]
Line_3 $$ LdapContext ldapContext = null-->Line_26 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
