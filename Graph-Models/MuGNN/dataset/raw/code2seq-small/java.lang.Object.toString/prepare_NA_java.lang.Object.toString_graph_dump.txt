Line_9 $$ if (!getResult.isExists()) -->Line_44 $$ if (request.versionType() != VersionType.INTERNAL) [ CD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_96 $$ ctx.put("_routing", routing)[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_26 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_72 $$ ttl = indexRequest.ttl()-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_40 $$ indexRequest.source((Map) ctx.get("_source"))[ FD ]
Line_125 $$ if ("delete".equals(operation)) -->Line_127 $$ return new Result(deleteRequest, Operation.DELETE, updatedSourceAsMap, updateSourceContentType)[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_102 $$ operation = (String) ctx.get("op")[ CD ]
Line_61 $$ String operation = null-->Line_102 $$ operation = (String) ctx.get("op")[ FD ]
Line_102 $$ operation = (String) ctx.get("op")-->Line_122 $$ if (operation == null || "index".equals(operation)) [ FD ]
Line_110 $$ ttl = getTTLFromScriptContext(ctx)-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_15 $$ if (request.scriptedUpsert() && request.script() != null) -->Line_23 $$ ctx = executeScript(request, ctx)[ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_94 $$ ctx.put("_id", getResult.getId())[ FD ]
Line_67 $$ String parent = getResult.getFields().containsKey(ParentFieldMapper.NAME) ? getResult.field(ParentFieldMapper.NAME).getValue().toString() : null-->Line_97 $$ ctx.put("_parent", parent)[ FD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_81 $$ boolean noop = !XContentHelper.update(updatedSourceAsMap, indexRequest.sourceAsMap(), request.detectNoop())[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_98 $$ ctx.put("_timestamp", originalTimestamp)[ FD ]
Line_50 $$ long updateVersion = getResult.getVersion()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_101 $$ ctx = executeScript(request, ctx)-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_102 $$ operation = (String) ctx.get("op")-->Line_125 $$ if ("delete".equals(operation)) [ FD ]
Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")-->Line_105 $$ timestamp = fetchedTimestamp.toString()[ FD ]
Line_61 $$ String operation = null-->Line_128 $$ if ("none".equals(operation)) [ FD ]
Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()-->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ FD ]
Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()-->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ FD ]
Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")-->Line_104 $$ if (fetchedTimestamp != null) [ FD ]
Line_9 $$ if (!getResult.isExists()) -->Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_71 $$ if (indexRequest.ttl() != null) [ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")[ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_98 $$ ctx.put("_timestamp", originalTimestamp)[ FD ]
Line_125 $$ if ("delete".equals(operation)) -->Line_128 $$ if ("none".equals(operation)) [ CD ]
Line_14 $$ TimeValue ttl = indexRequest.ttl()-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_66 $$ String routing = getResult.getFields().containsKey(RoutingFieldMapper.NAME) ? getResult.field(RoutingFieldMapper.NAME).getValue().toString() : null-->Line_76 $$ routing = indexRequest.routing()[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_90 $$ Long originalTtl = getResult.getFields().containsKey(TTLFieldMapper.NAME) ? (Long) getResult.field(TTLFieldMapper.NAME).getValue() : null[ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_100 $$ ctx.put("_source", sourceAndContent.v2())[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_74 $$ timestamp = indexRequest.timestamp()[ CD ]
Line_78 $$ if (indexRequest.parent() != null) -->Line_79 $$ parent = indexRequest.parent()[ CD ]
Line_67 $$ String parent = getResult.getFields().containsKey(ParentFieldMapper.NAME) ? getResult.field(ParentFieldMapper.NAME).getValue().toString() : null-->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_92 $$ ctx.put("_index", getResult.getIndex())[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_100 $$ ctx.put("_source", sourceAndContent.v2())[ FD ]
Line_101 $$ ctx = executeScript(request, ctx)-->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ FD ]
Line_15 $$ if (request.scriptedUpsert() && request.script() != null) -->Line_40 $$ indexRequest.source((Map) ctx.get("_source"))[ CD ]
Line_61 $$ String operation = null-->Line_133 $$ logger.warn("Used update operation [[ FD ]
Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()-->Line_81 $$ boolean noop = !XContentHelper.update(updatedSourceAsMap, indexRequest.sourceAsMap(), request.detectNoop())[ FD ]
Line_62 $$ String timestamp = null-->Line_74 $$ timestamp = indexRequest.timestamp()[ FD ]
Line_122 $$ if (operation == null || "index".equals(operation)) -->Line_124 $$ return new Result(indexRequest, Operation.INDEX, updatedSourceAsMap, updateSourceContentType)[ CD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_79 $$ parent = indexRequest.parent()[ FD ]
Line_67 $$ String parent = getResult.getFields().containsKey(ParentFieldMapper.NAME) ? getResult.field(ParentFieldMapper.NAME).getValue().toString() : null-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_9 $$ if (!getResult.isExists()) -->Line_15 $$ if (request.scriptedUpsert() && request.script() != null) [ CD ]
Line_75 $$ if (indexRequest.routing() != null) -->Line_76 $$ routing = indexRequest.routing()[ CD ]
Line_26 $$ ttl = getTTLFromScriptContext(ctx)-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_79 $$ parent = indexRequest.parent()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_60 $$ Tuple<XContentType, Map<String, Object>> sourceAndContent = XContentHelper.convertToMap(getResult.internalSourceRef(), true)-->Line_100 $$ ctx.put("_source", sourceAndContent.v2())[ FD ]
Line_15 $$ if (request.scriptedUpsert() && request.script() != null) -->Line_22 $$ ctx.put("_source", upsertDoc)[ CD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_40 $$ indexRequest.source((Map) ctx.get("_source"))[ FD ]
Line_14 $$ TimeValue ttl = indexRequest.ttl()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_90 $$ Long originalTtl = getResult.getFields().containsKey(TTLFieldMapper.NAME) ? (Long) getResult.field(TTLFieldMapper.NAME).getValue() : null-->Line_99 $$ ctx.put("_ttl", originalTtl)[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_93 $$ ctx.put("_type", getResult.getType())[ FD ]
Line_60 $$ Tuple<XContentType, Map<String, Object>> sourceAndContent = XContentHelper.convertToMap(getResult.internalSourceRef(), true)-->Line_65 $$ final XContentType updateSourceContentType = sourceAndContent.v1()[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_40 $$ indexRequest.source((Map) ctx.get("_source"))[ FD ]
Line_104 $$ if (fetchedTimestamp != null) -->Line_106 $$ if (originalTimestamp != null) [ CD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_97 $$ ctx.put("_parent", parent)[ FD ]
Line_74 $$ timestamp = indexRequest.timestamp()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_128 $$ if ("none".equals(operation)) -->Line_135 $$ return new Result(update, Operation.NONE, updatedSourceAsMap, updateSourceContentType)[ CD ]
Line_86 $$ operation = "none"-->Line_125 $$ if ("delete".equals(operation)) [ FD ]
Line_65 $$ final XContentType updateSourceContentType = sourceAndContent.v1()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_15 $$ if (request.scriptedUpsert() && request.script() != null) -->Line_18 $$ Map<String, Object> upsertDoc = upsert.sourceAsMap()[ CD ]
Line_86 $$ operation = "none"-->Line_122 $$ if (operation == null || "index".equals(operation)) [ FD ]
Line_14 $$ TimeValue ttl = indexRequest.ttl()-->Line_72 $$ ttl = indexRequest.ttl()[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_99 $$ ctx.put("_ttl", originalTtl)[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_104 $$ if (fetchedTimestamp != null) [ CD ]
Line_61 $$ String operation = null-->Line_122 $$ if (operation == null || "index".equals(operation)) [ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_75 $$ if (indexRequest.routing() != null) [ CD ]
Line_15 $$ if (request.scriptedUpsert() && request.script() != null) -->Line_19 $$ Map<String, Object> ctx = new HashMap(2)[ CD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_101 $$ ctx = executeScript(request, ctx)-->Line_102 $$ operation = (String) ctx.get("op")[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_92 $$ ctx.put("_index", getResult.getIndex())[ FD ]
Line_91 $$ Long originalTimestamp = getResult.getFields().containsKey(TimestampFieldMapper.NAME) ? (Long) getResult.field(TimestampFieldMapper.NAME).getValue() : null-->Line_106 $$ if (originalTimestamp != null) [ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_94 $$ ctx.put("_id", getResult.getId())[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_97 $$ ctx.put("_parent", parent)[ FD ]
Line_102 $$ operation = (String) ctx.get("op")-->Line_128 $$ if ("none".equals(operation)) [ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_101 $$ ctx = executeScript(request, ctx)[ CD ]
Line_86 $$ operation = "none"-->Line_133 $$ logger.warn("Used update operation [[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_93 $$ ctx.put("_type", getResult.getType())[ CD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_101 $$ ctx = executeScript(request, ctx)[ FD ]
Line_60 $$ Tuple<XContentType, Map<String, Object>> sourceAndContent = XContentHelper.convertToMap(getResult.internalSourceRef(), true)-->Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()[ FD ]
Line_61 $$ String operation = null-->Line_125 $$ if ("delete".equals(operation)) [ FD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_71 $$ if (indexRequest.ttl() != null) [ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_93 $$ ctx.put("_type", getResult.getType())[ FD ]
Line_72 $$ ttl = indexRequest.ttl()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_50 $$ long updateVersion = getResult.getVersion()-->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ FD ]
Line_76 $$ routing = indexRequest.routing()-->Line_96 $$ ctx.put("_routing", routing)[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")[ FD ]
Line_64 $$ final Map<String, Object> updatedSourceAsMap-->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ FD ]
Line_65 $$ final XContentType updateSourceContentType = sourceAndContent.v1()-->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_23 $$ ctx = executeScript(request, ctx)[ FD ]
Line_9 $$ if (!getResult.isExists()) -->Line_14 $$ TimeValue ttl = indexRequest.ttl()[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_69 $$ IndexRequest indexRequest = request.doc()[ CD ]
Line_66 $$ String routing = getResult.getFields().containsKey(RoutingFieldMapper.NAME) ? getResult.field(RoutingFieldMapper.NAME).getValue().toString() : null-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_98 $$ ctx.put("_timestamp", originalTimestamp)[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_100 $$ ctx.put("_source", sourceAndContent.v2())[ CD ]
Line_86 $$ operation = "none"-->Line_128 $$ if ("none".equals(operation)) [ FD ]
Line_9 $$ if (!getResult.isExists()) -->Line_10 $$ if (request.upsertRequest() == null && !request.docAsUpsert()) [ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_96 $$ ctx.put("_routing", routing)[ CD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_74 $$ timestamp = indexRequest.timestamp()[ FD ]
Line_62 $$ String timestamp = null-->Line_105 $$ timestamp = fetchedTimestamp.toString()[ FD ]
Line_128 $$ if ("none".equals(operation)) -->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ CD ]
Line_14 $$ TimeValue ttl = indexRequest.ttl()-->Line_26 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_76 $$ routing = indexRequest.routing()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_14 $$ TimeValue ttl = indexRequest.ttl()[ FD ]
Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")-->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_95 $$ ctx.put("_version", getResult.getVersion())[ FD ]
Line_64 $$ final Map<String, Object> updatedSourceAsMap-->Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ CD ]
Line_66 $$ String routing = getResult.getFields().containsKey(RoutingFieldMapper.NAME) ? getResult.field(RoutingFieldMapper.NAME).getValue().toString() : null-->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ FD ]
Line_104 $$ if (fetchedTimestamp != null) -->Line_105 $$ timestamp = fetchedTimestamp.toString()[ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_101 $$ ctx = executeScript(request, ctx)[ FD ]
Line_128 $$ if ("none".equals(operation)) -->Line_133 $$ logger.warn("Used update operation [[ CD ]
Line_36 $$ UpdateResponse update = new UpdateResponse(shardId, getResult.getType(), getResult.getId(), getResult.getVersion(), false)-->Line_37 $$ update.setGetResult(getResult)[ FD ]
Line_64 $$ final Map<String, Object> updatedSourceAsMap-->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ FD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_76 $$ routing = indexRequest.routing()[ FD ]
Line_33 $$ if (!"none".equals(scriptOpChoice)) -->Line_34 $$ logger.warn("Used upsert operation [[ CD ]
Line_67 $$ String parent = getResult.getFields().containsKey(ParentFieldMapper.NAME) ? getResult.field(ParentFieldMapper.NAME).getValue().toString() : null-->Line_79 $$ parent = indexRequest.parent()[ FD ]
Line_125 $$ if ("delete".equals(operation)) -->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ CD ]
Line_101 $$ ctx = executeScript(request, ctx)-->Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")[ FD ]
Line_105 $$ timestamp = fetchedTimestamp.toString()-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_122 $$ if (operation == null || "index".equals(operation)) -->Line_125 $$ if ("delete".equals(operation)) [ CD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_26 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_102 $$ operation = (String) ctx.get("op")[ FD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_78 $$ if (indexRequest.parent() != null) [ FD ]
Line_102 $$ operation = (String) ctx.get("op")-->Line_133 $$ logger.warn("Used update operation [[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_99 $$ ctx.put("_ttl", originalTtl)[ FD ]
Line_36 $$ UpdateResponse update = new UpdateResponse(shardId, getResult.getType(), getResult.getId(), getResult.getVersion(), false)-->Line_130 $$ update.setGetResult(extractGetResult(request, request.index(), getResult.getVersion(), updatedSourceAsMap, updateSourceContentType, getResult.internalSourceRef()))[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_97 $$ ctx.put("_parent", parent)[ CD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_72 $$ ttl = indexRequest.ttl()[ FD ]
Line_128 $$ if ("none".equals(operation)) -->Line_131 $$ return new Result(update, Operation.NONE, updatedSourceAsMap, updateSourceContentType)[ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ FD ]
Line_71 $$ if (indexRequest.ttl() != null) -->Line_72 $$ ttl = indexRequest.ttl()[ CD ]
Line_26 $$ ttl = getTTLFromScriptContext(ctx)-->Line_72 $$ ttl = indexRequest.ttl()[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_102 $$ operation = (String) ctx.get("op")[ FD ]
Line_86 $$ operation = "none"-->Line_102 $$ operation = (String) ctx.get("op")[ FD ]
Line_79 $$ parent = indexRequest.parent()-->Line_97 $$ ctx.put("_parent", parent)[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_92 $$ ctx.put("_index", getResult.getIndex())[ CD ]
Line_122 $$ if (operation == null || "index".equals(operation)) -->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_81 $$ boolean noop = !XContentHelper.update(updatedSourceAsMap, indexRequest.sourceAsMap(), request.detectNoop())[ CD ]
Line_62 $$ String timestamp = null-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_18 $$ Map<String, Object> upsertDoc = upsert.sourceAsMap()-->Line_22 $$ ctx.put("_source", upsertDoc)[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_99 $$ ctx.put("_ttl", originalTtl)[ FD ]
Line_64 $$ final Map<String, Object> updatedSourceAsMap-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")[ FD ]
Line_79 $$ parent = indexRequest.parent()-->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_70 $$ updatedSourceAsMap = sourceAndContent.v2()[ CD ]
Line_111 $$ updatedSourceAsMap = (Map<String, Object>) ctx.get("_source")-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_61 $$ String operation = null-->Line_86 $$ operation = "none"[ FD ]
Line_9 $$ if (!getResult.isExists()) -->Line_48 $$ return new Result(indexRequest, Operation.UPSERT, null, null)[ CD ]
Line_13 $$ IndexRequest indexRequest = request.docAsUpsert() ? request.doc() : request.upsertRequest()-->Line_75 $$ if (indexRequest.routing() != null) [ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_95 $$ ctx.put("_version", getResult.getVersion())[ FD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_103 $$ Object fetchedTimestamp = ctx.get("_timestamp")[ FD ]
Line_26 $$ ttl = getTTLFromScriptContext(ctx)-->Line_123 $$ final IndexRequest indexRequest = Requests.indexRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).source(updatedSourceAsMap, updateSourceContentType).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel()).timestamp(timestamp).ttl(ttl).refresh(request.refresh())[ FD ]
Line_66 $$ String routing = getResult.getFields().containsKey(RoutingFieldMapper.NAME) ? getResult.field(RoutingFieldMapper.NAME).getValue().toString() : null-->Line_96 $$ ctx.put("_routing", routing)[ FD ]
Line_64 $$ final Map<String, Object> updatedSourceAsMap-->Line_81 $$ boolean noop = !XContentHelper.update(updatedSourceAsMap, indexRequest.sourceAsMap(), request.detectNoop())[ FD ]
Line_19 $$ Map<String, Object> ctx = new HashMap(2)-->Line_22 $$ ctx.put("_source", upsertDoc)[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_95 $$ ctx.put("_version", getResult.getVersion())[ CD ]
Line_116 $$ Long ttlAsLong = getResult.getFields().containsKey(TTLFieldMapper.NAME) ? (Long) getResult.field(TTLFieldMapper.NAME).getValue() : null-->Line_117 $$ if (ttlAsLong != null) [ FD ]
Line_74 $$ timestamp = indexRequest.timestamp()-->Line_105 $$ timestamp = fetchedTimestamp.toString()[ FD ]
Line_76 $$ routing = indexRequest.routing()-->Line_126 $$ DeleteRequest deleteRequest = Requests.deleteRequest(request.index()).type(request.type()).id(request.id()).routing(routing).parent(parent).version(updateVersion).versionType(request.versionType()).consistencyLevel(request.consistencyLevel())[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_91 $$ Long originalTimestamp = getResult.getFields().containsKey(TimestampFieldMapper.NAME) ? (Long) getResult.field(TimestampFieldMapper.NAME).getValue() : null[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_110 $$ ttl = getTTLFromScriptContext(ctx)[ CD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_78 $$ if (indexRequest.parent() != null) [ CD ]
Line_23 $$ ctx = executeScript(request, ctx)-->Line_96 $$ ctx.put("_routing", routing)[ FD ]
Line_91 $$ Long originalTimestamp = getResult.getFields().containsKey(TimestampFieldMapper.NAME) ? (Long) getResult.field(TimestampFieldMapper.NAME).getValue() : null-->Line_98 $$ ctx.put("_timestamp", originalTimestamp)[ FD ]
Line_68 $$ if (request.script() == null && request.doc() != null) -->Line_94 $$ ctx.put("_id", getResult.getId())[ CD ]
