Line_40 $$ writer = null-->Line_53 $$ writer.close()[ FD ]
Line_11 $$ Class<V> valueClass = (Class<V>) job.getMapOutputValueClass()-->Line_96 $$ RawKeyValueIterator diskMerge = Merger.merge(job, fs, keyClass, valueClass, codec, diskSegments, ioSortFactor, numInMemSegments, tmpDir, comparator, reporter, false, spilledRecordsCounter, null, thisPhase)[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_69 $$ long fileLength = fs.getFileStatus(file).getLen()[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_3 $$ LOG.info("finalMerge called with " + inMemoryMapOutputs.size() + " in-memory map-outputs and " + onDiskMapOutputs.size() + " on-disk map-outputs")[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_20 $$ TaskID mapId = inMemoryMapOutputs.get(0).getMapId().getTaskID()[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_34 $$ FSDataOutputStream out = CryptoUtils.wrapIfNecessary(job, fs.create(outputPath))[ FD ]
Line_11 $$ Class<V> valueClass = (Class<V>) job.getMapOutputValueClass()-->Line_103 $$ return Merger.merge(job, fs, keyClass, valueClass, finalSegments, finalSegments.size(), tmpDir, comparator, reporter, spilledRecordsCounter, null, null)[ FD ]
Line_14 $$ final RawComparator<K> comparator = (RawComparator<K>) job.getOutputKeyComparator()-->Line_96 $$ RawKeyValueIterator diskMerge = Merger.merge(job, fs, keyClass, valueClass, codec, diskSegments, ioSortFactor, numInMemSegments, tmpDir, comparator, reporter, false, spilledRecordsCounter, null, thisPhase)[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_89 $$ if (0 != onDiskBytes) [ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_11 $$ Class<V> valueClass = (Class<V>) job.getMapOutputValueClass()[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_67 $$ CompressAwarePath[] onDisk = onDiskMapOutputs.toArray(new CompressAwarePath[onDiskMapOutputs.size()])[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_14 $$ final RawComparator<K> comparator = (RawComparator<K>) job.getOutputKeyComparator()[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_13 $$ final Path tmpDir = new Path(reduceId.toString())[ CD ]
Line_22 $$ final int numMemDiskSegments = memDiskSegments.size()-->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ FD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_58 $$ memDiskSegments.clear()[ CD ]
Line_19 $$ if (inMemoryMapOutputs.size() > 0) -->Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) [ CD ]
Line_19 $$ if (inMemoryMapOutputs.size() > 0) -->Line_22 $$ final int numMemDiskSegments = memDiskSegments.size()[ CD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_38 $$ writer.close()[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_65 $$ long onDiskBytes = inMemToDiskBytes[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_76 $$ Collections.sort(diskSegments, new Comparator<Segment<K, V>>() [ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_5 $$ if (maxRedPer > 1.0 || maxRedPer < 0.0) [ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_18 $$ boolean mergePhaseFinished = false[ CD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_52 $$ if (null != writer) [ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_19 $$ if (inMemoryMapOutputs.size() > 0) [ CD ]
Line_76 $$ Collections.sort(diskSegments, new Comparator<Segment<K, V>>() -->Line_82 $$ return o1.getLength() < o2.getLength() ? -1 : 1[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_103 $$ return Merger.merge(job, fs, keyClass, valueClass, finalSegments, finalSegments.size(), tmpDir, comparator, reporter, spilledRecordsCounter, null, null)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_8 $$ int maxInMemReduce = (int) Math.min(Runtime.getRuntime().maxMemory() * maxRedPer, Integer.MAX_VALUE)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_4 $$ final float maxRedPer = job.getFloat(MRJobConfig.REDUCE_INPUT_BUFFER_PERCENT, 0f)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_12 $$ boolean keepInputs = job.getKeepFailedTaskFiles()[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_39 $$ onDiskMapOutputs.add(new CompressAwarePath(outputPath, writer.getRawLength(), writer.getCompressedLength()))[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_87 $$ long inMemBytes = createInMemorySegments(inMemoryMapOutputs, finalSegments, 0)[ CD ]
Line_13 $$ final Path tmpDir = new Path(reduceId.toString())-->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ FD ]
Line_13 $$ final Path tmpDir = new Path(reduceId.toString())-->Line_96 $$ RawKeyValueIterator diskMerge = Merger.merge(job, fs, keyClass, valueClass, codec, diskSegments, ioSortFactor, numInMemSegments, tmpDir, comparator, reporter, false, spilledRecordsCounter, null, thisPhase)[ FD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_11 $$ Class<V> valueClass = (Class<V>) job.getMapOutputValueClass()[ FD ]
Line_59 $$ if (inMemToDiskBytes != 0) -->Line_60 $$ LOG.info("Keeping " + numMemDiskSegments + " segments, " + inMemToDiskBytes + " bytes in memory for " + "intermediate, on-disk merge")[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_37 $$ Merger.writeFile(rIter, writer, reporter, job)[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_45 $$ fs.delete(outputPath, true)[ FD ]
Line_13 $$ final Path tmpDir = new Path(reduceId.toString())-->Line_103 $$ return Merger.merge(job, fs, keyClass, valueClass, finalSegments, finalSegments.size(), tmpDir, comparator, reporter, spilledRecordsCounter, null, null)[ FD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_90 $$ final int numInMemSegments = memDiskSegments.size()[ CD ]
Line_17 $$ long inMemToDiskBytes = 0-->Line_59 $$ if (inMemToDiskBytes != 0) [ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_12 $$ boolean keepInputs = job.getKeepFailedTaskFiles()[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_103 $$ return Merger.merge(job, fs, keyClass, valueClass, finalSegments, finalSegments.size(), tmpDir, comparator, reporter, spilledRecordsCounter, null, null)[ FD ]
Line_76 $$ Collections.sort(diskSegments, new Comparator<Segment<K, V>>() -->Line_79 $$ if (o1.getLength() == o2.getLength()) [ CD ]
Line_57 $$ inMemToDiskBytes = 0-->Line_59 $$ if (inMemToDiskBytes != 0) [ FD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_97 $$ diskSegments.clear()[ CD ]
Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)-->Line_37 $$ Merger.writeFile(rIter, writer, reporter, job)[ FD ]
Line_11 $$ Class<V> valueClass = (Class<V>) job.getMapOutputValueClass()-->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ FD ]
Line_40 $$ writer = null-->Line_52 $$ if (null != writer) [ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_3 $$ LOG.info("finalMerge called with " + inMemoryMapOutputs.size() + " in-memory map-outputs and " + onDiskMapOutputs.size() + " on-disk map-outputs")[ CD ]
Line_65 $$ long onDiskBytes = inMemToDiskBytes-->Line_70 $$ onDiskBytes += fileLength[ FD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_59 $$ if (inMemToDiskBytes != 0) [ CD ]
Line_98 $$ if (0 == finalSegments.size()) -->Line_99 $$ return diskMerge[ CD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_96 $$ RawKeyValueIterator diskMerge = Merger.merge(job, fs, keyClass, valueClass, codec, diskSegments, ioSortFactor, numInMemSegments, tmpDir, comparator, reporter, false, spilledRecordsCounter, null, thisPhase)[ CD ]
Line_19 $$ if (inMemoryMapOutputs.size() > 0) -->Line_20 $$ TaskID mapId = inMemoryMapOutputs.get(0).getMapId().getTaskID()[ CD ]
Line_17 $$ long inMemToDiskBytes = 0-->Line_57 $$ inMemToDiskBytes = 0[ FD ]
Line_8 $$ int maxInMemReduce = (int) Math.min(Runtime.getRuntime().maxMemory() * maxRedPer, Integer.MAX_VALUE)-->Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)[ FD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_40 $$ writer = null[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) [ FD ]
Line_76 $$ Collections.sort(diskSegments, new Comparator<Segment<K, V>>() -->Line_79 $$ if (o1.getLength() == o2.getLength()) [ FD ]
Line_14 $$ final RawComparator<K> comparator = (RawComparator<K>) job.getOutputKeyComparator()-->Line_103 $$ return Merger.merge(job, fs, keyClass, valueClass, finalSegments, finalSegments.size(), tmpDir, comparator, reporter, spilledRecordsCounter, null, null)[ FD ]
Line_79 $$ if (o1.getLength() == o2.getLength()) -->Line_80 $$ return 0[ CD ]
Line_14 $$ final RawComparator<K> comparator = (RawComparator<K>) job.getOutputKeyComparator()-->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_14 $$ final RawComparator<K> comparator = (RawComparator<K>) job.getOutputKeyComparator()[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)[ FD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_53 $$ writer.close()[ FD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_91 $$ diskSegments.addAll(0, memDiskSegments)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ FD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_37 $$ Merger.writeFile(rIter, writer, reporter, job)[ FD ]
Line_65 $$ long onDiskBytes = inMemToDiskBytes-->Line_89 $$ if (0 != onDiskBytes) [ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_17 $$ long inMemToDiskBytes = 0[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_67 $$ CompressAwarePath[] onDisk = onDiskMapOutputs.toArray(new CompressAwarePath[onDiskMapOutputs.size()])[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_96 $$ RawKeyValueIterator diskMerge = Merger.merge(job, fs, keyClass, valueClass, codec, diskSegments, ioSortFactor, numInMemSegments, tmpDir, comparator, reporter, false, spilledRecordsCounter, null, thisPhase)[ FD ]
Line_68 $$ for (CompressAwarePath file : onDisk) -->Line_73 $$ diskSegments.add(new Segment<K, V>(job, fs, file, codec, keepInputs, (file.toString().endsWith(Task.MERGED_OUTPUT_PREFIX) ? null : mergedMapOutputsCounter), file.getRawDataLength()))[ FD ]
Line_66 $$ long rawBytes = inMemToDiskBytes-->Line_71 $$ rawBytes += (file.getRawDataLength() > 0) ? file.getRawDataLength() : fileLength[ FD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_57 $$ inMemToDiskBytes = 0[ CD ]
Line_69 $$ long fileLength = fs.getFileStatus(file).getLen()-->Line_70 $$ onDiskBytes += fileLength[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_87 $$ long inMemBytes = createInMemorySegments(inMemoryMapOutputs, finalSegments, 0)[ FD ]
Line_52 $$ if (null != writer) -->Line_53 $$ writer.close()[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_66 $$ long rawBytes = inMemToDiskBytes[ CD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_56 $$ LOG.info("Merged " + numMemDiskSegments + " segments, " + inMemToDiskBytes + " bytes to disk to satisfy " + "reduce memory limit")[ CD ]
Line_17 $$ long inMemToDiskBytes = 0-->Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)[ FD ]
Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)-->Line_57 $$ inMemToDiskBytes = 0[ FD ]
Line_19 $$ if (inMemoryMapOutputs.size() > 0) -->Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)[ CD ]
Line_21 $$ inMemToDiskBytes = createInMemorySegments(inMemoryMapOutputs, memDiskSegments, maxInMemReduce)-->Line_59 $$ if (inMemToDiskBytes != 0) [ FD ]
Line_70 $$ onDiskBytes += fileLength-->Line_89 $$ if (0 != onDiskBytes) [ FD ]
Line_68 $$ for (CompressAwarePath file : onDisk) -->Line_71 $$ rawBytes += (file.getRawDataLength() > 0) ? file.getRawDataLength() : fileLength[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_4 $$ final float maxRedPer = job.getFloat(MRJobConfig.REDUCE_INPUT_BUFFER_PERCENT, 0f)[ FD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_98 $$ if (0 == finalSegments.size()) [ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_19 $$ if (inMemoryMapOutputs.size() > 0) [ FD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_33 $$ final RawKeyValueIterator rIter = Merger.merge(job, fs, keyClass, valueClass, memDiskSegments, numMemDiskSegments, tmpDir, comparator, reporter, spilledRecordsCounter, null, mergePhase)[ CD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_88 $$ LOG.info("Merging " + finalSegments.size() + " segments, " + inMemBytes + " bytes from memory into reduce")[ CD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_92 $$ memDiskSegments.clear()[ CD ]
Line_23 $$ if (numMemDiskSegments > 0 && ioSortFactor > onDiskMapOutputs.size()) -->Line_34 $$ FSDataOutputStream out = CryptoUtils.wrapIfNecessary(job, fs.create(outputPath))[ CD ]
Line_76 $$ Collections.sort(diskSegments, new Comparator<Segment<K, V>>() -->Line_82 $$ return o1.getLength() < o2.getLength() ? -1 : 1[ FD ]
Line_35 $$ Writer<K, V> writer = new Writer<K, V>(job, out, keyClass, valueClass, codec, null, true)-->Line_39 $$ onDiskMapOutputs.add(new CompressAwarePath(outputPath, writer.getRawLength(), writer.getCompressedLength()))[ FD ]
Line_2 $$ private RawKeyValueIterator finalMerge(JobConf job, FileSystem fs, List<InMemoryMapOutput<K, V>> inMemoryMapOutputs, List<CompressAwarePath> onDiskMapOutputs) throws IOException -->Line_75 $$ LOG.info("Merging " + onDisk.length + " files, " + onDiskBytes + " bytes from disk")[ CD ]
Line_89 $$ if (0 != onDiskBytes) -->Line_101 $$ finalSegments.add(new Segment<K, V>(new RawKVIteratorReader(diskMerge, onDiskBytes), true, rawBytes))[ CD ]
Line_68 $$ for (CompressAwarePath file : onDisk) -->Line_69 $$ long fileLength = fs.getFileStatus(file).getLen()[ FD ]
