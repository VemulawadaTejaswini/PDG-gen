Line_16 $$ if (endTxId == HdfsConstants.INVALID_TXID) -->Line_17 $$ LOG.error("Unrecoverable corruption has occurred in segment " + l.toString() + " at path " + znode + ". Unable to continue recovery.")[ CD ]
Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_15 $$ long endTxId = recoverLastTxId(l, true)[ FD ]
Line_15 $$ long endTxId = recoverLastTxId(l, true)-->Line_20 $$ finalizeLogSegment(l.getFirstTxId(), endTxId)[ FD ]
Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_20 $$ finalizeLogSegment(l.getFirstTxId(), endTxId)[ FD ]
Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_17 $$ LOG.error("Unrecoverable corruption has occurred in segment " + l.toString() + " at path " + znode + ". Unable to continue recovery.")[ FD ]
Line_12 $$ String znode = ledgerPath + "/" + child-->Line_30 $$ zkc.delete(znode, -1)[ FD ]
Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_22 $$ LOG.warn("Inprogress znode " + child + " refers to a ledger which is empty. This occurs when the NN" + " crashes after opening a segment, but before writing the" + " OP_START_LOG_SEGMENT op. It is safe to delete." + " MetaData [" + l.toString() + "]")[ FD ]
Line_27 $$ if (maxTxId.get() == l.getFirstTxId()) -->Line_28 $$ maxTxId.reset(maxTxId.get() - 1)[ CD ]
Line_8 $$ for (String child : children) -->Line_9 $$ if (!child.startsWith(BKJM_EDIT_INPROGRESS)) [ FD ]
Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_27 $$ if (maxTxId.get() == l.getFirstTxId()) [ FD ]
Line_15 $$ long endTxId = recoverLastTxId(l, true)-->Line_16 $$ if (endTxId == HdfsConstants.INVALID_TXID) [ FD ]
Line_12 $$ String znode = ledgerPath + "/" + child-->Line_13 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)[ FD ]
