Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_19 $$ finalizeLogSegment(l.getFirstTxId(), endTxId)[ FD ]
Line_2 $$ public void recoverUnfinalizedSegments() throws IOException -->Line_3 $$ checkEnv()[ CD ]
Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_21 $$ LOG.warn("Inprogress znode " + child + " refers to a ledger which is empty. This occurs when the NN" + " crashes after opening a segment, but before writing the" + " OP_START_LOG_SEGMENT op. It is safe to delete." + " MetaData [" + l.toString() + "]")[ FD ]
Line_11 $$ String znode = ledgerPath + "/" + child-->Line_25 $$ zkc.delete(znode, -1)[ FD ]
Line_11 $$ String znode = ledgerPath + "/" + child-->Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)[ FD ]
Line_7 $$ for (String child : children) -->Line_8 $$ if (!child.startsWith(BKJM_EDIT_INPROGRESS)) [ FD ]
Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_22 $$ if (maxTxId.get() == l.getFirstTxId()) [ FD ]
Line_14 $$ long endTxId = recoverLastTxId(l, true)-->Line_19 $$ finalizeLogSegment(l.getFirstTxId(), endTxId)[ FD ]
Line_15 $$ if (endTxId == HdfsConstants.INVALID_TXID) -->Line_16 $$ LOG.error("Unrecoverable corruption has occurred in segment " + l.toString() + " at path " + znode + ". Unable to continue recovery.")[ CD ]
Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_14 $$ long endTxId = recoverLastTxId(l, true)[ FD ]
Line_14 $$ long endTxId = recoverLastTxId(l, true)-->Line_15 $$ if (endTxId == HdfsConstants.INVALID_TXID) [ FD ]
Line_12 $$ EditLogLedgerMetadata l = EditLogLedgerMetadata.read(zkc, znode)-->Line_16 $$ LOG.error("Unrecoverable corruption has occurred in segment " + l.toString() + " at path " + znode + ". Unable to continue recovery.")[ FD ]
Line_22 $$ if (maxTxId.get() == l.getFirstTxId()) -->Line_23 $$ maxTxId.reset(maxTxId.get() - 1)[ CD ]
