Line_7 $$ DiscoveryNode masterNode = null-->Line_11 $$ masterNode = findMaster()[ FD ]
Line_11 $$ masterNode = findMaster()-->Line_17 $$ if (clusterService.localNode().equals(masterNode)) [ FD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_80 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ FD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_13 $$ if (!joinThreadControl.joinThreadActive(currentThread)) [ FD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_69 $$ return joinThreadControl.stopRunningThreadAndRejoin(currentState, "master_switched_while_finalizing_join")[ FD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_36 $$ logger.trace("failed while waiting for nodes to join, rejoining", t)[ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_68 $$ if (!currentState.getNodes().masterNode().equals(finalMasterNode)) [ CD ]
Line_13 $$ if (!joinThreadControl.joinThreadActive(currentThread)) -->Line_14 $$ logger.trace("thread is no longer in currentJoinThread. Stopping.")[ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_79 $$ logger.error("unexpected error while trying to finalize cluster join", t)[ FD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_80 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ CD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_37 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ CD ]
Line_17 $$ if (clusterService.localNode().equals(masterNode)) -->Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() [ CD ]
Line_17 $$ if (clusterService.localNode().equals(masterNode)) -->Line_20 $$ logger.debug("elected as master, waiting for incoming joins ([[ CD ]
Line_10 $$ while (masterNode == null && joinThreadControl.joinThreadActive(currentThread)) -->Line_11 $$ masterNode = findMaster()[ CD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_79 $$ logger.error("unexpected error while trying to finalize cluster join", t)[ FD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_61 $$ if (currentState.getNodes().masterNode() == null) [ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_68 $$ if (!currentState.getNodes().masterNode().equals(finalMasterNode)) [ FD ]
Line_68 $$ if (!currentState.getNodes().masterNode().equals(finalMasterNode)) -->Line_69 $$ return joinThreadControl.stopRunningThreadAndRejoin(currentState, "master_switched_while_finalizing_join")[ CD ]
Line_30 $$ long count = clusterJoinsCounter.incrementAndGet()-->Line_31 $$ logger.trace("cluster joins counter set to [[ FD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_31 $$ logger.trace("cluster joins counter set to [[ CD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_36 $$ logger.trace("failed while waiting for nodes to join, rejoining", t)[ FD ]
Line_7 $$ DiscoveryNode masterNode = null-->Line_17 $$ if (clusterService.localNode().equals(masterNode)) [ FD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_51 $$ return false[ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_56 $$ if (!success) [ CD ]
Line_13 $$ if (!joinThreadControl.joinThreadActive(currentThread)) -->Line_15 $$ return[ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_74 $$ return currentState[ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_61 $$ if (currentState.getNodes().masterNode() == null) [ FD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_10 $$ while (masterNode == null && joinThreadControl.joinThreadActive(currentThread)) [ FD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_29 $$ sendInitialStateEventIfNeeded()[ CD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_37 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ FD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_25 $$ joinThreadControl.markThreadAsDone(currentThread)[ FD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_25 $$ joinThreadControl.markThreadAsDone(currentThread)[ CD ]
Line_21 $$ nodeJoinController.waitToBeElectedAsMaster(requiredJoins, masterElectionWaitForJoinsTimeout, new NodeJoinController.ElectionCallback() -->Line_30 $$ long count = clusterJoinsCounter.incrementAndGet()[ CD ]
Line_17 $$ if (clusterService.localNode().equals(masterNode)) -->Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() [ CD ]
Line_47 $$ clusterService.submitStateUpdateTask("finalize_join (" + masterNode + ")", new ClusterStateUpdateTask() -->Line_79 $$ logger.error("unexpected error while trying to finalize cluster join", t)[ CD ]
Line_8 $$ final Thread currentThread = Thread.currentThread()-->Line_65 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ FD ]
Line_56 $$ if (!success) -->Line_59 $$ return currentState[ CD ]
Line_61 $$ if (currentState.getNodes().masterNode() == null) -->Line_66 $$ return currentState[ CD ]
Line_61 $$ if (currentState.getNodes().masterNode() == null) -->Line_65 $$ joinThreadControl.markThreadAsDoneAndStartNew(currentThread)[ CD ]
