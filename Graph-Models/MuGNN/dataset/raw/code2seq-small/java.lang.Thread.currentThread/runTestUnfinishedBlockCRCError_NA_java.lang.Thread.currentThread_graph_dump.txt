Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)[ CD ]
Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)-->Line_19 $$ for (int i = 0; !error.get() && i < numWrites; i++) [ FD ]
Line_7 $$ final AtomicBoolean writerDone = new AtomicBoolean(false)-->Line_44 $$ while (!writerDone.get() && !error.get()) [ FD ]
Line_19 $$ for (int i = 0; !error.get() && i < numWrites; i++) -->Line_21 $$ outputStream.write(writeBuf)[ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_22 $$ if (syncType == SyncType.SYNC) [ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_20 $$ final byte[] writeBuf = DFSTestUtil.generateSequentialBytes(i * writeSize, writeSize)[ FD ]
Line_20 $$ final byte[] writeBuf = DFSTestUtil.generateSequentialBytes(i * writeSize, writeSize)-->Line_21 $$ outputStream.write(writeBuf)[ FD ]
Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)-->Line_16 $$ outputStream = fileSystem.append(file)[ FD ]
Line_14 $$ if (syncType == SyncType.APPEND) -->Line_15 $$ outputStream.close()[ CD ]
Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)-->Line_15 $$ outputStream.close()[ FD ]
Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)-->Line_21 $$ outputStream.write(writeBuf)[ FD ]
Line_55 $$ if (e.getCause() instanceof ChecksumException) -->Line_56 $$ error.set(true)[ CD ]
Line_8 $$ final AtomicBoolean writerStarted = new AtomicBoolean(false)-->Line_25 $$ writerStarted.set(true)[ FD ]
Line_10 $$ final Thread writer = new Thread(new Runnable() -->Line_64 $$ writer.start()[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_64 $$ writer.start()[ CD ]
Line_8 $$ final AtomicBoolean writerStarted = new AtomicBoolean(false)-->Line_45 $$ if (writerStarted.get()) [ FD ]
Line_5 $$ final Path file = new Path("/block-being-written-to")-->Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_65 $$ tailer.start()[ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_4 $$ init(conf)[ FD ]
Line_44 $$ while (!writerDone.get() && !error.get()) -->Line_45 $$ if (writerStarted.get()) [ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_14 $$ if (syncType == SyncType.APPEND) [ FD ]
Line_5 $$ final Path file = new Path("/block-being-written-to")-->Line_16 $$ outputStream = fileSystem.append(file)[ FD ]
Line_22 $$ if (syncType == SyncType.SYNC) -->Line_23 $$ outputStream.hflush()[ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_3 $$ conf.setBoolean(DFSConfigKeys.DFS_DATANODE_TRANSFERTO_ALLOWED_KEY, transferToAllowed)[ CD ]
Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)-->Line_28 $$ error.set(true)[ FD ]
Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)-->Line_23 $$ outputStream.hflush()[ FD ]
Line_13 $$ FSDataOutputStream outputStream = fileSystem.create(file)-->Line_31 $$ outputStream.close()[ FD ]
Line_5 $$ final Path file = new Path("/block-being-written-to")-->Line_47 $$ startPos = tailFile(file, startPos)[ FD ]
Line_43 $$ long startPos = 0-->Line_47 $$ startPos = tailFile(file, startPos)[ FD ]
Line_19 $$ for (int i = 0; !error.get() && i < numWrites; i++) -->Line_20 $$ final byte[] writeBuf = DFSTestUtil.generateSequentialBytes(i * writeSize, writeSize)[ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_5 $$ final Path file = new Path("/block-being-written-to")[ CD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_3 $$ conf.setBoolean(DFSConfigKeys.DFS_DATANODE_TRANSFERTO_ALLOWED_KEY, transferToAllowed)[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_10 $$ final Thread writer = new Thread(new Runnable() [ CD ]
Line_16 $$ outputStream = fileSystem.append(file)-->Line_23 $$ outputStream.hflush()[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_7 $$ final AtomicBoolean writerDone = new AtomicBoolean(false)[ CD ]
Line_19 $$ for (int i = 0; !error.get() && i < numWrites; i++) -->Line_25 $$ writerStarted.set(true)[ CD ]
Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)-->Line_69 $$ assertFalse("error occurred, see log above", error.get())[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_8 $$ final AtomicBoolean writerStarted = new AtomicBoolean(false)[ CD ]
Line_16 $$ outputStream = fileSystem.append(file)-->Line_21 $$ outputStream.write(writeBuf)[ FD ]
Line_16 $$ outputStream = fileSystem.append(file)-->Line_31 $$ outputStream.close()[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_4 $$ init(conf)[ CD ]
Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)-->Line_44 $$ while (!writerDone.get() && !error.get()) [ FD ]
Line_19 $$ for (int i = 0; !error.get() && i < numWrites; i++) -->Line_22 $$ if (syncType == SyncType.SYNC) [ CD ]
Line_7 $$ final AtomicBoolean writerDone = new AtomicBoolean(false)-->Line_33 $$ writerDone.set(true)[ FD ]
Line_14 $$ if (syncType == SyncType.APPEND) -->Line_16 $$ outputStream = fileSystem.append(file)[ CD ]
Line_10 $$ final Thread writer = new Thread(new Runnable() -->Line_67 $$ writer.join()[ FD ]
Line_10 $$ final Thread writer = new Thread(new Runnable() -->Line_58 $$ writer.interrupt()[ FD ]
Line_9 $$ final AtomicBoolean error = new AtomicBoolean(false)-->Line_56 $$ error.set(true)[ FD ]
Line_2 $$ private void runTestUnfinishedBlockCRCError(final boolean transferToAllowed, final SyncType syncType, final int writeSize, Configuration conf) throws IOException -->Line_6 $$ final int numWrites = 2000[ CD ]
Line_5 $$ final Path file = new Path("/block-being-written-to")-->Line_49 $$ LOG.error(String.format("error tailing file %s", file), e)[ FD ]
