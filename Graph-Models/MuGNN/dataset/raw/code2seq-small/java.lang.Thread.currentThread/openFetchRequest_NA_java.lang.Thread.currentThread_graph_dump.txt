Line_9 $$ FetchResponse fetchResponse = consumer.fetch(req)-->Line_10 $$ if (fetchResponse.hasError()) [ FD ]
Line_5 $$ FetchRequest req = new FetchRequestBuilder().clientId("presto-worker-" + Thread.currentThread().getName()).addFetch(split.getTopicName(), split.getPartitionId(), cursorOffset, KAFKA_READ_BUFFER_SIZE).build()-->Line_9 $$ FetchResponse fetchResponse = consumer.fetch(req)[ FD ]
Line_2 $$ private void openFetchRequest() -->Line_3 $$ if (messageAndOffsetIterator == null) [ CD ]
Line_10 $$ if (fetchResponse.hasError()) -->Line_11 $$ short errorCode = fetchResponse.errorCode(split.getTopicName(), split.getPartitionId())[ CD ]
Line_10 $$ if (fetchResponse.hasError()) -->Line_12 $$ log.warn("Fetch response has error: %d", errorCode)[ CD ]
Line_3 $$ if (messageAndOffsetIterator == null) -->Line_5 $$ FetchRequest req = new FetchRequestBuilder().clientId("presto-worker-" + Thread.currentThread().getName()).addFetch(split.getTopicName(), split.getPartitionId(), cursorOffset, KAFKA_READ_BUFFER_SIZE).build()[ CD ]
Line_3 $$ if (messageAndOffsetIterator == null) -->Line_10 $$ if (fetchResponse.hasError()) [ CD ]
Line_3 $$ if (messageAndOffsetIterator == null) -->Line_9 $$ FetchResponse fetchResponse = consumer.fetch(req)[ CD ]
Line_9 $$ FetchResponse fetchResponse = consumer.fetch(req)-->Line_11 $$ short errorCode = fetchResponse.errorCode(split.getTopicName(), split.getPartitionId())[ FD ]
Line_3 $$ if (messageAndOffsetIterator == null) -->Line_15 $$ messageAndOffsetIterator = fetchResponse.messageSet(split.getTopicName(), split.getPartitionId()).iterator()[ CD ]
Line_11 $$ short errorCode = fetchResponse.errorCode(split.getTopicName(), split.getPartitionId())-->Line_12 $$ log.warn("Fetch response has error: %d", errorCode)[ FD ]
Line_3 $$ if (messageAndOffsetIterator == null) -->Line_4 $$ log.debug("Fetching %d bytes from offset %d (%d - %d). %d messages read so far", KAFKA_READ_BUFFER_SIZE, cursorOffset, split.getStart(), split.getEnd(), totalMessages)[ CD ]
Line_9 $$ FetchResponse fetchResponse = consumer.fetch(req)-->Line_15 $$ messageAndOffsetIterator = fetchResponse.messageSet(split.getTopicName(), split.getPartitionId()).iterator()[ FD ]
