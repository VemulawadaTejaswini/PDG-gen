Line_2 $$ public void testFetchFailure() throws Exception -->Line_25 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_26 $$ app.waitForState(mapTask, TaskState.RUNNING)[ CD ]
Line_10 $$ Task mapTask = it.next()-->Line_26 $$ app.waitForState(mapTask, TaskState.RUNNING)[ FD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_15 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt1.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_36 $$ app.waitForState(job, JobState.SUCCEEDED)[ CD ]
Line_6 $$ Job job = app.submit(conf)-->Line_9 $$ Iterator<Task> it = job.getTasks().values().iterator()[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_44 $$ Assert.assertEquals("Event status not correct for map attempt1", TaskAttemptCompletionEventStatus.OBSOLETE, events[0].getStatus())[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_6 $$ Job job = app.submit(conf)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_52 $$ mapEvents = job.getMapAttemptCompletionEvents(2, 200)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_33 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt2.getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_24 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_36 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_17 $$ TaskAttemptCompletionEvent[] events = job.getTaskAttemptCompletionEvents(0, 100)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_15 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt1.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_10 $$ Task mapTask = it.next()[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_37 $$ Assert.assertEquals("Event status not correct", TaskAttemptCompletionEventStatus.OBSOLETE, events[0].getStatus())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_32 $$ app.waitForState(mapAttempt2, TaskAttemptState.RUNNING)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_24 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_51 $$ Assert.assertArrayEquals("Unexpected map events", Arrays.copyOfRange(convertedEvents, 0, 2), mapEvents)[ CD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_25 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_20 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_35 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceAttempt.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_26 $$ app.waitForState(mapTask, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_54 $$ Assert.assertEquals("Unexpected map event", convertedEvents[2], mapEvents[0])[ CD ]
Line_9 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_10 $$ Task mapTask = it.next()[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_32 $$ app.waitForState(mapAttempt2, TaskAttemptState.RUNNING)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_23 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_14 $$ app.waitForState(mapAttempt1, TaskAttemptState.RUNNING)[ FD ]
Line_48 $$ TaskCompletionEvent[] mapEvents = job.getMapAttemptCompletionEvents(0, 2)-->Line_52 $$ mapEvents = job.getMapAttemptCompletionEvents(2, 200)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_45 $$ Assert.assertEquals("Event status not correct for map attempt1", TaskAttemptCompletionEventStatus.FAILED, events[1].getStatus())[ CD ]
Line_10 $$ Task mapTask = it.next()-->Line_16 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_20 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_17 $$ TaskAttemptCompletionEvent[] events = job.getTaskAttemptCompletionEvents(0, 100)[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_12 $$ app.waitForState(mapTask, TaskState.RUNNING)[ FD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_35 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceAttempt.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_42 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt2.getID(), events[2].getAttemptId())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_12 $$ app.waitForState(mapTask, TaskState.RUNNING)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_41 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt1.getID(), events[1].getAttemptId())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_46 $$ Assert.assertEquals("Event status not correct for map attempt2", TaskAttemptCompletionEventStatus.SUCCEEDED, events[2].getStatus())[ CD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_40 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt1.getID(), events[0].getAttemptId())[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_15 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt1.getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_16 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ FD ]
Line_4 $$ Configuration conf = new Configuration()-->Line_6 $$ Job job = app.submit(conf)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_8 $$ Assert.assertEquals("Num tasks not correct", 2, job.getTasks().size())[ FD ]
Line_10 $$ Task mapTask = it.next()-->Line_34 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ FD ]
Line_31 $$ TaskAttempt mapAttempt2 = atIt.next()-->Line_33 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt2.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_34 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_14 $$ app.waitForState(mapAttempt1, TaskAttemptState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_9 $$ Iterator<Task> it = job.getTasks().values().iterator()[ CD ]
Line_9 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_11 $$ Task reduceTask = it.next()[ FD ]
Line_10 $$ Task mapTask = it.next()-->Line_28 $$ Assert.assertEquals("Num attempts in Map Task not correct", 2, mapTask.getAttempts().size())[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_35 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceAttempt.getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_30 $$ atIt.next()[ CD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_23 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_48 $$ TaskCompletionEvent[] mapEvents = job.getMapAttemptCompletionEvents(0, 2)-->Line_51 $$ Assert.assertArrayEquals("Unexpected map events", Arrays.copyOfRange(convertedEvents, 0, 2), mapEvents)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_22 $$ app.waitForState(reduceAttempt, TaskAttemptState.RUNNING)[ FD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_22 $$ app.waitForState(reduceAttempt, TaskAttemptState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_31 $$ TaskAttempt mapAttempt2 = atIt.next()[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_40 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt1.getID(), events[0].getAttemptId())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_48 $$ TaskCompletionEvent[] mapEvents = job.getMapAttemptCompletionEvents(0, 2)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_5 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ CD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_27 $$ Assert.assertEquals("Map TaskAttempt state not correct", TaskAttemptState.FAILED, mapAttempt1.getState())[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_53 $$ Assert.assertEquals("Incorrect number of map events", 1, mapEvents.length)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_8 $$ Assert.assertEquals("Num tasks not correct", 2, job.getTasks().size())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_38 $$ events = job.getTaskAttemptCompletionEvents(0, 100)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_27 $$ Assert.assertEquals("Map TaskAttempt state not correct", TaskAttemptState.FAILED, mapAttempt1.getState())[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_11 $$ Task reduceTask = it.next()[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_39 $$ Assert.assertEquals("Num completion events not correct", 4, events.length)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_52 $$ mapEvents = job.getMapAttemptCompletionEvents(2, 200)[ CD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_25 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_36 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_18 $$ Assert.assertEquals("Num completion events not correct", 1, events.length)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_43 $$ Assert.assertEquals("Event redude attempt id not correct", reduceAttempt.getID(), events[3].getAttemptId())[ CD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_24 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_11 $$ Task reduceTask = it.next()-->Line_20 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_10 $$ Task mapTask = it.next()-->Line_12 $$ app.waitForState(mapTask, TaskState.RUNNING)[ FD ]
Line_11 $$ Task reduceTask = it.next()-->Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_23 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_24 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_4 $$ Configuration conf = new Configuration()[ CD ]
Line_4 $$ Configuration conf = new Configuration()-->Line_5 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_33 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapAttempt2.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_7 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_22 $$ app.waitForState(reduceAttempt, TaskAttemptState.RUNNING)[ CD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_25 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_48 $$ TaskCompletionEvent[] mapEvents = job.getMapAttemptCompletionEvents(0, 2)[ FD ]
Line_31 $$ TaskAttempt mapAttempt2 = atIt.next()-->Line_32 $$ app.waitForState(mapAttempt2, TaskAttemptState.RUNNING)[ FD ]
Line_10 $$ Task mapTask = it.next()-->Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_38 $$ events = job.getTaskAttemptCompletionEvents(0, 100)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_28 $$ Assert.assertEquals("Num attempts in Map Task not correct", 2, mapTask.getAttempts().size())[ CD ]
Line_17 $$ TaskAttemptCompletionEvent[] events = job.getTaskAttemptCompletionEvents(0, 100)-->Line_38 $$ events = job.getTaskAttemptCompletionEvents(0, 100)[ FD ]
Line_31 $$ TaskAttempt mapAttempt2 = atIt.next()-->Line_42 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt2.getID(), events[2].getAttemptId())[ FD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_23 $$ sendFetchFailure(app, reduceAttempt, mapAttempt1)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_16 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ CD ]
Line_17 $$ TaskAttemptCompletionEvent[] events = job.getTaskAttemptCompletionEvents(0, 100)-->Line_49 $$ TaskCompletionEvent[] convertedEvents = TypeConverter.fromYarn(events)[ FD ]
Line_29 $$ Iterator<TaskAttempt> atIt = mapTask.getAttempts().values().iterator()-->Line_30 $$ atIt.next()[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_19 $$ Assert.assertEquals("Event status not correct", TaskAttemptCompletionEventStatus.SUCCEEDED, events[0].getStatus())[ CD ]
Line_38 $$ events = job.getTaskAttemptCompletionEvents(0, 100)-->Line_49 $$ TaskCompletionEvent[] convertedEvents = TypeConverter.fromYarn(events)[ FD ]
Line_3 $$ MRApp app = new MRApp(1, 1, false, this.getClass().getName(), true)-->Line_34 $$ app.waitForState(mapTask, TaskState.SUCCEEDED)[ FD ]
Line_6 $$ Job job = app.submit(conf)-->Line_7 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_50 $$ Assert.assertEquals("Incorrect number of map events", 2, mapEvents.length)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_7 $$ app.waitForState(job, JobState.RUNNING)[ CD ]
Line_10 $$ Task mapTask = it.next()-->Line_29 $$ Iterator<TaskAttempt> atIt = mapTask.getAttempts().values().iterator()[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_49 $$ TaskCompletionEvent[] convertedEvents = TypeConverter.fromYarn(events)[ CD ]
Line_13 $$ TaskAttempt mapAttempt1 = mapTask.getAttempts().values().iterator().next()-->Line_41 $$ Assert.assertEquals("Event map attempt id not correct", mapAttempt1.getID(), events[1].getAttemptId())[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_47 $$ Assert.assertEquals("Event status not correct for reduce attempt1", TaskAttemptCompletionEventStatus.SUCCEEDED, events[3].getStatus())[ CD ]
Line_21 $$ TaskAttempt reduceAttempt = reduceTask.getAttempts().values().iterator().next()-->Line_43 $$ Assert.assertEquals("Event redude attempt id not correct", reduceAttempt.getID(), events[3].getAttemptId())[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_14 $$ app.waitForState(mapAttempt1, TaskAttemptState.RUNNING)[ CD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_6 $$ Job job = app.submit(conf)[ CD ]
Line_49 $$ TaskCompletionEvent[] convertedEvents = TypeConverter.fromYarn(events)-->Line_51 $$ Assert.assertArrayEquals("Unexpected map events", Arrays.copyOfRange(convertedEvents, 0, 2), mapEvents)[ FD ]
Line_2 $$ public void testFetchFailure() throws Exception -->Line_29 $$ Iterator<TaskAttempt> atIt = mapTask.getAttempts().values().iterator()[ CD ]
Line_29 $$ Iterator<TaskAttempt> atIt = mapTask.getAttempts().values().iterator()-->Line_31 $$ TaskAttempt mapAttempt2 = atIt.next()[ FD ]
