Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()[ CD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_12 $$ ServletRequestContext src = notification.getExchange().getAttachment(ServletRequestContext.ATTACHMENT_KEY)[ FD ]
Line_14 $$ ServletRequest hsr = src.getServletRequest()-->Line_15 $$ if (hsr instanceof HttpServletRequest) [ FD ]
Line_5 $$ AuditEvent auditEvent = new AuditEvent(event == EventType.AUTHENTICATED ? AuditLevel.SUCCESS : AuditLevel.FAILURE)-->Line_20 $$ auditEvent.setContextMap(ctxMap)[ FD ]
Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()-->Line_16 $$ ctxMap.put("request", WebUtil.deriveUsefulInfo((HttpServletRequest) hsr))[ FD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_11 $$ ctxMap.put("message", notification.getMessage())[ CD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_12 $$ ServletRequestContext src = notification.getExchange().getAttachment(ServletRequestContext.ATTACHMENT_KEY)[ CD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_3 $$ EventType event = notification.getEventType()[ FD ]
Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()-->Line_11 $$ ctxMap.put("message", notification.getMessage())[ FD ]
Line_13 $$ if (src != null) -->Line_15 $$ if (hsr instanceof HttpServletRequest) [ CD ]
Line_13 $$ if (src != null) -->Line_14 $$ ServletRequest hsr = src.getServletRequest()[ CD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_19 $$ ctxMap.put("Source", getClass().getCanonicalName())[ CD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_13 $$ if (src != null) [ CD ]
Line_8 $$ if (account != null) -->Line_9 $$ ctxMap.put("principal", account.getPrincipal().getName())[ CD ]
Line_5 $$ AuditEvent auditEvent = new AuditEvent(event == EventType.AUTHENTICATED ? AuditLevel.SUCCESS : AuditLevel.FAILURE)-->Line_21 $$ auditManager.audit(auditEvent)[ FD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_21 $$ auditManager.audit(auditEvent)[ CD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_8 $$ if (account != null) [ CD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_3 $$ EventType event = notification.getEventType()[ CD ]
Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()-->Line_20 $$ auditEvent.setContextMap(ctxMap)[ FD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_5 $$ AuditEvent auditEvent = new AuditEvent(event == EventType.AUTHENTICATED ? AuditLevel.SUCCESS : AuditLevel.FAILURE)[ CD ]
Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()-->Line_19 $$ ctxMap.put("Source", getClass().getCanonicalName())[ FD ]
Line_7 $$ Account account = notification.getAccount()-->Line_8 $$ if (account != null) [ FD ]
Line_7 $$ Account account = notification.getAccount()-->Line_9 $$ ctxMap.put("principal", account.getPrincipal().getName())[ FD ]
Line_12 $$ ServletRequestContext src = notification.getExchange().getAttachment(ServletRequestContext.ATTACHMENT_KEY)-->Line_14 $$ ServletRequest hsr = src.getServletRequest()[ FD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_7 $$ Account account = notification.getAccount()[ CD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) [ CD ]
Line_6 $$ Map<String, Object> ctxMap = new HashMap<String, Object>()-->Line_9 $$ ctxMap.put("principal", account.getPrincipal().getName())[ FD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_7 $$ Account account = notification.getAccount()[ FD ]
Line_2 $$ public void handleNotification(SecurityNotification notification) -->Line_11 $$ ctxMap.put("message", notification.getMessage())[ FD ]
Line_15 $$ if (hsr instanceof HttpServletRequest) -->Line_16 $$ ctxMap.put("request", WebUtil.deriveUsefulInfo((HttpServletRequest) hsr))[ CD ]
Line_4 $$ if (event == EventType.AUTHENTICATED || event == EventType.FAILED_AUTHENTICATION) -->Line_20 $$ auditEvent.setContextMap(ctxMap)[ CD ]
Line_12 $$ ServletRequestContext src = notification.getExchange().getAttachment(ServletRequestContext.ATTACHMENT_KEY)-->Line_13 $$ if (src != null) [ FD ]
