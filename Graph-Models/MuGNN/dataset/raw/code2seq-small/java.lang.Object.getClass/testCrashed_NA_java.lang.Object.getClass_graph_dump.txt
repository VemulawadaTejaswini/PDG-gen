Line_83 $$ reduceTask = it.next()-->Line_91 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceTask.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_80 $$ it = job.getTasks().values().iterator()[ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_77 $$ job = app.submit(conf)[ FD ]
Line_81 $$ mapTask1 = it.next()-->Line_84 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_16 $$ Task mapTask1 = it.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_17 $$ Task mapTask2 = it.next()[ CD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_29 $$ while (mapTask1.getAttempts().size() != 2 && timeOut++ < 10) [ FD ]
Line_48 $$ TaskAttempt task1Attempt3 = itr.next()-->Line_49 $$ app.waitForState(task1Attempt3, TaskAttemptState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_88 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapTask2.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_36 $$ TaskAttempt task1Attempt2 = itr.next()-->Line_37 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt2.getID(), TaskAttemptEventType.TA_CONTAINER_LAUNCH_FAILED))[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_39 $$ timeOut = 0[ CD ]
Line_39 $$ timeOut = 0-->Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) [ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_10 $$ conf.set(FileOutputFormat.OUTDIR, outputDir.toString())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)[ CD ]
Line_29 $$ while (mapTask1.getAttempts().size() != 2 && timeOut++ < 10) -->Line_30 $$ Thread.sleep(2000)[ CD ]
Line_18 $$ Task reduceTask = it.next()-->Line_83 $$ reduceTask = it.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_78 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_48 $$ TaskAttempt task1Attempt3 = itr.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)[ CD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_88 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapTask2.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)[ FD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_61 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_10 $$ conf.set(FileOutputFormat.OUTDIR, outputDir.toString())[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_91 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceTask.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_92 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) -->Line_101 $$ Assert.assertEquals(amInfo.getAppAttemptId(), amInfo.getContainerId().getApplicationAttemptId())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_83 $$ reduceTask = it.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_86 $$ task2Attempt = mapTask2.getAttempts().values().iterator().next()[ CD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_83 $$ reduceTask = it.next()[ FD ]
Line_18 $$ Task reduceTask = it.next()-->Line_25 $$ Assert.assertEquals("Reduce Task state not correct", TaskState.RUNNING, reduceTask.getReport().getTaskState())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_74 $$ conf.setBoolean("mapred.reducer.new-api", true)[ CD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_21 $$ TaskAttempt task1Attempt1 = mapTask1.getAttempts().values().iterator().next()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_37 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt2.getID(), TaskAttemptEventType.TA_CONTAINER_LAUNCH_FAILED))[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_50 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt3.getID(), TaskAttemptEventType.TA_KILL))[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_24 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_3 $$ int runCount = 0-->Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_88 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapTask2.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_28 $$ int timeOut = 0-->Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) [ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_26 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt1.getID(), TaskAttemptEventType.TA_FAILMSG))[ CD ]
Line_18 $$ Task reduceTask = it.next()-->Line_91 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceTask.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_108 $$ Assert.assertTrue(am1StartTimeReal >= am1StartTimeEst && am1StartTimeReal <= am2StartTimeEst)[ CD ]
Line_36 $$ TaskAttempt task1Attempt2 = itr.next()-->Line_38 $$ app.waitForState(task1Attempt2, TaskAttemptState.FAILED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_50 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt3.getID(), TaskAttemptEventType.TA_KILL))[ CD ]
Line_71 $$ conf = new Configuration()-->Line_73 $$ conf.setBoolean("mapred.mapper.new-api", true)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_67 $$ long task1FinishTime = mapTask1.getReport().getFinishTime()[ CD ]
Line_58 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_62 $$ TaskAttempt task1Attempt4 = itr.next()[ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_84 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_107 $$ long am2StartTimeReal = job.getAMInfos().get(1).getStartTime()[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_67 $$ long task1FinishTime = mapTask1.getReport().getFinishTime()[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_36 $$ TaskAttempt task1Attempt2 = itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_109 $$ Assert.assertTrue(am2StartTimeReal >= am2StartTimeEst && am2StartTimeReal <= System.currentTimeMillis())[ CD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_7 $$ conf.setBoolean("mapred.mapper.new-api", true)[ FD ]
Line_62 $$ TaskAttempt task1Attempt4 = itr.next()-->Line_64 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt4.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_81 $$ mapTask1 = it.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_79 $$ Assert.assertEquals("No of tasks not correct", 3, job.getTasks().size())[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_107 $$ long am2StartTimeReal = job.getAMInfos().get(1).getStartTime()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_80 $$ it = job.getTasks().values().iterator()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_19 $$ app.waitForState(mapTask1, TaskState.RUNNING)[ CD ]
Line_11 $$ Job job = app.submit(conf)-->Line_92 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_20 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_87 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_89 $$ app.waitForState(mapTask2, TaskState.SUCCEEDED)[ FD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_59 $$ itr.next()[ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_72 $$ conf.setBoolean(MRJobConfig.MR_AM_JOB_RECOVERY_ENABLE, true)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_48 $$ TaskAttempt task1Attempt3 = itr.next()[ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_91 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceTask.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_6 $$ Configuration conf = new Configuration()[ CD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_76 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_57 $$ Assert.assertEquals(4, mapTask1.getAttempts().size())[ FD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_17 $$ Task mapTask2 = it.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_62 $$ TaskAttempt task1Attempt4 = itr.next()[ CD ]
Line_52 $$ timeOut = 0-->Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) [ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_73 $$ conf.setBoolean("mapred.mapper.new-api", true)[ FD ]
Line_28 $$ int timeOut = 0-->Line_29 $$ while (mapTask1.getAttempts().size() != 2 && timeOut++ < 10) [ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_93 $$ app.verifyCompleted()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_63 $$ app.waitForState(task1Attempt4, TaskAttemptState.RUNNING)[ CD ]
Line_18 $$ Task reduceTask = it.next()-->Line_90 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_36 $$ TaskAttempt task1Attempt2 = itr.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_60 $$ itr.next()[ CD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_85 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) -->Line_104 $$ Assert.assertEquals(MRApp.NM_HTTP_PORT, amInfo.getNodeManagerHttpPort())[ FD ]
Line_22 $$ TaskAttempt task2Attempt = mapTask2.getAttempts().values().iterator().next()-->Line_24 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_62 $$ TaskAttempt task1Attempt4 = itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_46 $$ itr.next()[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_89 $$ app.waitForState(mapTask2, TaskState.SUCCEEDED)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_58 $$ itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_65 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_94 $$ Assert.assertEquals("Job Start time not correct", jobStartTime, job.getReport().getStartTime())[ FD ]
Line_80 $$ it = job.getTasks().values().iterator()-->Line_82 $$ mapTask2 = it.next()[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_45 $$ itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_20 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_89 $$ app.waitForState(mapTask2, TaskState.SUCCEEDED)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_79 $$ Assert.assertEquals("No of tasks not correct", 3, job.getTasks().size())[ CD ]
Line_58 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_59 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_37 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt2.getID(), TaskAttemptEventType.TA_CONTAINER_LAUNCH_FAILED))[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_12 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_14 $$ Assert.assertEquals("No of tasks not correct", 3, job.getTasks().size())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_27 $$ app.waitForState(task1Attempt1, TaskAttemptState.FAILED)[ CD ]
Line_62 $$ TaskAttempt task1Attempt4 = itr.next()-->Line_63 $$ app.waitForState(task1Attempt4, TaskAttemptState.RUNNING)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_84 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_18 $$ Task reduceTask = it.next()[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_65 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_82 $$ mapTask2 = it.next()-->Line_86 $$ task2Attempt = mapTask2.getAttempts().values().iterator().next()[ FD ]
Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) -->Line_103 $$ Assert.assertEquals(MRApp.NM_PORT, amInfo.getNodeManagerPort())[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_97 $$ Assert.assertEquals(2, job.getAMInfos().size())[ FD ]
Line_3 $$ int runCount = 0-->Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_61 $$ itr.next()[ FD ]
Line_58 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_61 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_12 $$ app.waitForState(job, JobState.RUNNING)[ CD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_93 $$ app.verifyCompleted()[ FD ]
Line_71 $$ conf = new Configuration()-->Line_72 $$ conf.setBoolean(MRJobConfig.MR_AM_JOB_RECOVERY_ENABLE, true)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_77 $$ job = app.submit(conf)[ CD ]
Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) -->Line_42 $$ LOG.info("Waiting for next attempt to start")[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_57 $$ Assert.assertEquals(4, mapTask1.getAttempts().size())[ CD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_62 $$ TaskAttempt task1Attempt4 = itr.next()[ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_74 $$ conf.setBoolean("mapred.reducer.new-api", true)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_98 $$ int attemptNum = 1[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_61 $$ itr.next()[ CD ]
Line_11 $$ Job job = app.submit(conf)-->Line_78 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_75 $$ conf.set(FileOutputFormat.OUTDIR, outputDir.toString())[ CD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_78 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) -->Line_41 $$ Thread.sleep(2000)[ CD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_89 $$ app.waitForState(mapTask2, TaskState.SUCCEEDED)[ FD ]
Line_21 $$ TaskAttempt task1Attempt1 = mapTask1.getAttempts().values().iterator().next()-->Line_26 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt1.getID(), TaskAttemptEventType.TA_FAILMSG))[ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_92 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_85 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_81 $$ mapTask1 = it.next()-->Line_95 $$ Assert.assertEquals("Task Start time not correct", task1StartTime, mapTask1.getReport().getStartTime())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_72 $$ conf.setBoolean(MRJobConfig.MR_AM_JOB_RECOVERY_ENABLE, true)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_25 $$ Assert.assertEquals("Reduce Task state not correct", TaskState.RUNNING, reduceTask.getReport().getTaskState())[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_26 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt1.getID(), TaskAttemptEventType.TA_FAILMSG))[ FD ]
Line_28 $$ int timeOut = 0-->Line_39 $$ timeOut = 0[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_59 $$ itr.next()[ FD ]
Line_81 $$ mapTask1 = it.next()-->Line_96 $$ Assert.assertEquals("Task Finish time not correct", task1FinishTime, mapTask1.getReport().getFinishTime())[ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_75 $$ conf.set(FileOutputFormat.OUTDIR, outputDir.toString())[ FD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_16 $$ Task mapTask1 = it.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_77 $$ job = app.submit(conf)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_47 $$ itr.next()[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_80 $$ it = job.getTasks().values().iterator()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_85 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_86 $$ task2Attempt = mapTask2.getAttempts().values().iterator().next()[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_106 $$ long am1StartTimeReal = job.getAMInfos().get(0).getStartTime()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_27 $$ app.waitForState(task1Attempt1, TaskAttemptState.FAILED)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_46 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_97 $$ Assert.assertEquals(2, job.getAMInfos().size())[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_4 $$ long am1StartTimeEst = System.currentTimeMillis()[ CD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_9 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_13 $$ long jobStartTime = job.getReport().getStartTime()[ CD ]
Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) -->Line_102 $$ Assert.assertEquals(MRApp.NM_HOST, amInfo.getNodeManagerHost())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_28 $$ int timeOut = 0[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_85 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_94 $$ Assert.assertEquals("Job Start time not correct", jobStartTime, job.getReport().getStartTime())[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_90 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_20 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_45 $$ itr = mapTask1.getAttempts().values().iterator()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_64 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt4.getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_11 $$ Job job = app.submit(conf)-->Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) [ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_87 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_68 $$ app.stop()[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_79 $$ Assert.assertEquals("No of tasks not correct", 3, job.getTasks().size())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_84 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ CD ]
Line_48 $$ TaskAttempt task1Attempt3 = itr.next()-->Line_50 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt3.getID(), TaskAttemptEventType.TA_KILL))[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_58 $$ itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) [ FD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_87 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_46 $$ itr.next()[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_44 $$ Assert.assertEquals(3, mapTask1.getAttempts().size())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_11 $$ Job job = app.submit(conf)[ CD ]
Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) -->Line_55 $$ LOG.info("Waiting for next attempt to start")[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_71 $$ conf = new Configuration()[ CD ]
Line_71 $$ conf = new Configuration()-->Line_76 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_71 $$ conf = new Configuration()[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_96 $$ Assert.assertEquals("Task Finish time not correct", task1FinishTime, mapTask1.getReport().getFinishTime())[ FD ]
Line_98 $$ int attemptNum = 1-->Line_100 $$ Assert.assertEquals(attemptNum++, amInfo.getAppAttemptId().getAttemptId())[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_49 $$ app.waitForState(task1Attempt3, TaskAttemptState.RUNNING)[ FD ]
Line_39 $$ timeOut = 0-->Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) [ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_69 $$ long am2StartTimeEst = System.currentTimeMillis()[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_11 $$ Job job = app.submit(conf)[ FD ]
Line_48 $$ TaskAttempt task1Attempt3 = itr.next()-->Line_51 $$ app.waitForState(task1Attempt3, TaskAttemptState.KILLED)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_77 $$ job = app.submit(conf)[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_97 $$ Assert.assertEquals(2, job.getAMInfos().size())[ FD ]
Line_77 $$ job = app.submit(conf)-->Line_94 $$ Assert.assertEquals("Job Start time not correct", jobStartTime, job.getReport().getStartTime())[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_84 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_78 $$ app.waitForState(job, JobState.RUNNING)[ CD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_60 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_68 $$ app.stop()[ CD ]
Line_28 $$ int timeOut = 0-->Line_52 $$ timeOut = 0[ FD ]
Line_83 $$ reduceTask = it.next()-->Line_90 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_78 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_22 $$ TaskAttempt task2Attempt = mapTask2.getAttempts().values().iterator().next()-->Line_87 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_64 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(task1Attempt4.getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) -->Line_54 $$ Thread.sleep(2000)[ CD ]
Line_80 $$ it = job.getTasks().values().iterator()-->Line_83 $$ reduceTask = it.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_107 $$ long am2StartTimeReal = job.getAMInfos().get(1).getStartTime()[ CD ]
Line_21 $$ TaskAttempt task1Attempt1 = mapTask1.getAttempts().values().iterator().next()-->Line_23 $$ app.waitForState(task1Attempt1, TaskAttemptState.RUNNING)[ FD ]
Line_80 $$ it = job.getTasks().values().iterator()-->Line_81 $$ mapTask1 = it.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_24 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_38 $$ app.waitForState(task1Attempt2, TaskAttemptState.FAILED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_49 $$ app.waitForState(task1Attempt3, TaskAttemptState.RUNNING)[ CD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_58 $$ itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_73 $$ conf.setBoolean("mapred.mapper.new-api", true)[ CD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_18 $$ Task reduceTask = it.next()[ FD ]
Line_28 $$ int timeOut = 0-->Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) [ FD ]
Line_39 $$ timeOut = 0-->Line_52 $$ timeOut = 0[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_106 $$ long am1StartTimeReal = job.getAMInfos().get(0).getStartTime()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_96 $$ Assert.assertEquals("Task Finish time not correct", task1FinishTime, mapTask1.getReport().getFinishTime())[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_14 $$ Assert.assertEquals("No of tasks not correct", 3, job.getTasks().size())[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_8 $$ conf.setBoolean("mapred.reducer.new-api", true)[ CD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_22 $$ TaskAttempt task2Attempt = mapTask2.getAttempts().values().iterator().next()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_19 $$ app.waitForState(mapTask1, TaskState.RUNNING)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_51 $$ app.waitForState(task1Attempt3, TaskAttemptState.KILLED)[ FD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_47 $$ itr.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_13 $$ long jobStartTime = job.getReport().getStartTime()[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_45 $$ itr = mapTask1.getAttempts().values().iterator()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_82 $$ mapTask2 = it.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_59 $$ itr.next()[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_52 $$ timeOut = 0[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_93 $$ app.verifyCompleted()[ CD ]
Line_45 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_48 $$ TaskAttempt task1Attempt3 = itr.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_106 $$ long am1StartTimeReal = job.getAMInfos().get(0).getStartTime()[ FD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_82 $$ mapTask2 = it.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_33 $$ Assert.assertEquals(2, mapTask1.getAttempts().size())[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_22 $$ TaskAttempt task2Attempt = mapTask2.getAttempts().values().iterator().next()[ CD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_33 $$ Assert.assertEquals(2, mapTask1.getAttempts().size())[ FD ]
Line_22 $$ TaskAttempt task2Attempt = mapTask2.getAttempts().values().iterator().next()-->Line_86 $$ task2Attempt = mapTask2.getAttempts().values().iterator().next()[ FD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_8 $$ conf.setBoolean("mapred.reducer.new-api", true)[ FD ]
Line_29 $$ while (mapTask1.getAttempts().size() != 2 && timeOut++ < 10) -->Line_31 $$ LOG.info("Waiting for next attempt to start")[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_44 $$ Assert.assertEquals(3, mapTask1.getAttempts().size())[ CD ]
Line_67 $$ long task1FinishTime = mapTask1.getReport().getFinishTime()-->Line_96 $$ Assert.assertEquals("Task Finish time not correct", task1FinishTime, mapTask1.getReport().getFinishTime())[ FD ]
Line_17 $$ Task mapTask2 = it.next()-->Line_88 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapTask2.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_65 $$ app.waitForState(mapTask1, TaskState.SUCCEEDED)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_92 $$ app.waitForState(job, JobState.SUCCEEDED)[ CD ]
Line_58 $$ itr = mapTask1.getAttempts().values().iterator()-->Line_60 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_29 $$ while (mapTask1.getAttempts().size() != 2 && timeOut++ < 10) [ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_7 $$ conf.setBoolean("mapred.mapper.new-api", true)[ CD ]
Line_71 $$ conf = new Configuration()-->Line_74 $$ conf.setBoolean("mapred.reducer.new-api", true)[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_19 $$ app.waitForState(mapTask1, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_66 $$ long task1StartTime = mapTask1.getReport().getStartTime()[ CD ]
Line_70 $$ app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), false, ++runCount)-->Line_90 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_60 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_76 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) [ CD ]
Line_82 $$ mapTask2 = it.next()-->Line_85 $$ app.waitForState(mapTask2, TaskState.RUNNING)[ FD ]
Line_86 $$ task2Attempt = mapTask2.getAttempts().values().iterator().next()-->Line_87 $$ app.waitForState(task2Attempt, TaskAttemptState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_81 $$ mapTask1 = it.next()[ CD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_11 $$ Job job = app.submit(conf)[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_40 $$ while (mapTask1.getAttempts().size() != 3 && timeOut++ < 10) [ FD ]
Line_71 $$ conf = new Configuration()-->Line_77 $$ job = app.submit(conf)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_21 $$ TaskAttempt task1Attempt1 = mapTask1.getAttempts().values().iterator().next()[ CD ]
Line_21 $$ TaskAttempt task1Attempt1 = mapTask1.getAttempts().values().iterator().next()-->Line_27 $$ app.waitForState(task1Attempt1, TaskAttemptState.FAILED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_38 $$ app.waitForState(task1Attempt2, TaskAttemptState.FAILED)[ CD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_81 $$ mapTask1 = it.next()[ FD ]
Line_11 $$ Job job = app.submit(conf)-->Line_12 $$ app.waitForState(job, JobState.RUNNING)[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_90 $$ app.waitForState(reduceTask, TaskState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_35 $$ itr.next()[ CD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_80 $$ it = job.getTasks().values().iterator()[ FD ]
Line_34 $$ Iterator<TaskAttempt> itr = mapTask1.getAttempts().values().iterator()-->Line_35 $$ itr.next()[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_95 $$ Assert.assertEquals("Task Start time not correct", task1StartTime, mapTask1.getReport().getStartTime())[ CD ]
Line_71 $$ conf = new Configuration()-->Line_75 $$ conf.set(FileOutputFormat.OUTDIR, outputDir.toString())[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_95 $$ Assert.assertEquals("Task Start time not correct", task1StartTime, mapTask1.getReport().getStartTime())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_9 $$ conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE, false)[ CD ]
Line_13 $$ long jobStartTime = job.getReport().getStartTime()-->Line_94 $$ Assert.assertEquals("Job Start time not correct", jobStartTime, job.getReport().getStartTime())[ FD ]
Line_66 $$ long task1StartTime = mapTask1.getReport().getStartTime()-->Line_95 $$ Assert.assertEquals("Task Start time not correct", task1StartTime, mapTask1.getReport().getStartTime())[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_3 $$ int runCount = 0[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_58 $$ itr = mapTask1.getAttempts().values().iterator()[ CD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_23 $$ app.waitForState(task1Attempt1, TaskAttemptState.RUNNING)[ FD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_66 $$ long task1StartTime = mapTask1.getReport().getStartTime()[ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_92 $$ app.waitForState(job, JobState.SUCCEEDED)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_23 $$ app.waitForState(task1Attempt1, TaskAttemptState.RUNNING)[ CD ]
Line_16 $$ Task mapTask1 = it.next()-->Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) [ FD ]
Line_5 $$ MRApp app = new MRAppWithHistory(2, 1, false, this.getClass().getName(), true, ++runCount)-->Line_63 $$ app.waitForState(task1Attempt4, TaskAttemptState.RUNNING)[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_47 $$ itr.next()[ CD ]
Line_6 $$ Configuration conf = new Configuration()-->Line_77 $$ job = app.submit(conf)[ FD ]
Line_99 $$ for (AMInfo amInfo : job.getAMInfos()) -->Line_100 $$ Assert.assertEquals(attemptNum++, amInfo.getAppAttemptId().getAttemptId())[ FD ]
Line_82 $$ mapTask2 = it.next()-->Line_88 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(mapTask2.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ FD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_53 $$ while (mapTask1.getAttempts().size() != 4 && timeOut++ < 10) [ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_51 $$ app.waitForState(task1Attempt3, TaskAttemptState.KILLED)[ CD ]
Line_2 $$ public void testCrashed() throws Exception -->Line_91 $$ app.getContext().getEventHandler().handle(new TaskAttemptEvent(reduceTask.getAttempts().values().iterator().next().getID(), TaskAttemptEventType.TA_DONE))[ CD ]
Line_82 $$ mapTask2 = it.next()-->Line_89 $$ app.waitForState(mapTask2, TaskState.SUCCEEDED)[ FD ]
Line_15 $$ Iterator<Task> it = job.getTasks().values().iterator()-->Line_82 $$ mapTask2 = it.next()[ FD ]
