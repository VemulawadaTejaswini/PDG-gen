Line_2 $$ public void testFormat() throws Exception -->Line_3 $$ JobConf job = new JobConf()[ CD ]
Line_3 $$ JobConf job = new JobConf()-->Line_5 $$ FileOutputFormat.setOutputPath(job, workDir.getParent().getParent())[ FD ]
Line_18 $$ Text val2 = new Text("val2")-->Line_39 $$ expectedOutput.append(key2).append('\t').append(val2).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_11 $$ String file = "test_format.txt"[ CD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_25 $$ theRecordWriter.write(key2, nullWritable)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_30 $$ theRecordWriter.close(reporter)[ FD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_35 $$ expectedOutput.append(val1).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_8 $$ if (!fs.mkdirs(workDir)) [ CD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_26 $$ theRecordWriter.write(key1, null)[ FD ]
Line_16 $$ Text key2 = new Text("key2")-->Line_37 $$ expectedOutput.append(key2).append("\n")[ FD ]
Line_8 $$ if (!fs.mkdirs(workDir)) -->Line_9 $$ fail("Failed to create output directory")[ CD ]
Line_15 $$ Text key1 = new Text("key1")-->Line_38 $$ expectedOutput.append(key1).append("\n")[ FD ]
Line_12 $$ Reporter reporter = Reporter.NULL-->Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_16 $$ Text key2 = new Text("key2")[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_36 $$ expectedOutput.append(val2).append("\n")[ CD ]
Line_16 $$ Text key2 = new Text("key2")-->Line_39 $$ expectedOutput.append(key2).append('\t').append(val2).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_38 $$ expectedOutput.append(key1).append("\n")[ CD ]
Line_3 $$ JobConf job = new JobConf()-->Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_24 $$ theRecordWriter.write(nullWritable, val2)[ FD ]
Line_16 $$ Text key2 = new Text("key2")-->Line_25 $$ theRecordWriter.write(key2, nullWritable)[ FD ]
Line_3 $$ JobConf job = new JobConf()-->Line_4 $$ job.set(JobContext.TASK_ATTEMPT_ID, attempt)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_18 $$ Text val2 = new Text("val2")[ CD ]
Line_19 $$ NullWritable nullWritable = NullWritable.get()-->Line_25 $$ theRecordWriter.write(key2, nullWritable)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_12 $$ Reporter reporter = Reporter.NULL[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_41 $$ assertEquals(expectedOutput.toString(), output)[ CD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_36 $$ expectedOutput.append(val2).append("\n")[ FD ]
Line_17 $$ Text val1 = new Text("val1")-->Line_21 $$ theRecordWriter.write(key1, val1)[ FD ]
Line_12 $$ Reporter reporter = Reporter.NULL-->Line_30 $$ theRecordWriter.close(reporter)[ FD ]
Line_18 $$ Text val2 = new Text("val2")-->Line_24 $$ theRecordWriter.write(nullWritable, val2)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_4 $$ job.set(JobContext.TASK_ATTEMPT_ID, attempt)[ CD ]
Line_15 $$ Text key1 = new Text("key1")-->Line_26 $$ theRecordWriter.write(key1, null)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_34 $$ expectedOutput.append(key1).append('\t').append(val1).append("\n")[ CD ]
Line_18 $$ Text val2 = new Text("val2")-->Line_28 $$ theRecordWriter.write(key2, val2)[ FD ]
Line_7 $$ FileSystem fs = workDir.getFileSystem(job)-->Line_8 $$ if (!fs.mkdirs(workDir)) [ FD ]
Line_15 $$ Text key1 = new Text("key1")-->Line_34 $$ expectedOutput.append(key1).append('\t').append(val1).append("\n")[ FD ]
Line_32 $$ File expectedFile = new File(new Path(workDir, file).toString())-->Line_40 $$ String output = UtilsForTests.slurp(expectedFile)[ FD ]
Line_17 $$ Text val1 = new Text("val1")-->Line_23 $$ theRecordWriter.write(null, val1)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_32 $$ File expectedFile = new File(new Path(workDir, file).toString())[ CD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_37 $$ expectedOutput.append(key2).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_40 $$ String output = UtilsForTests.slurp(expectedFile)[ CD ]
Line_17 $$ Text val1 = new Text("val1")-->Line_35 $$ expectedOutput.append(val1).append("\n")[ FD ]
Line_16 $$ Text key2 = new Text("key2")-->Line_28 $$ theRecordWriter.write(key2, val2)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_7 $$ FileSystem fs = workDir.getFileSystem(job)[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_19 $$ NullWritable nullWritable = NullWritable.get()[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)[ CD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_39 $$ expectedOutput.append(key2).append('\t').append(val2).append("\n")[ FD ]
Line_19 $$ NullWritable nullWritable = NullWritable.get()-->Line_22 $$ theRecordWriter.write(null, nullWritable)[ FD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_38 $$ expectedOutput.append(key1).append("\n")[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_27 $$ theRecordWriter.write(null, null)[ FD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_41 $$ assertEquals(expectedOutput.toString(), output)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_15 $$ Text key1 = new Text("key1")[ CD ]
Line_3 $$ JobConf job = new JobConf()-->Line_7 $$ FileSystem fs = workDir.getFileSystem(job)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_21 $$ theRecordWriter.write(key1, val1)[ FD ]
Line_40 $$ String output = UtilsForTests.slurp(expectedFile)-->Line_41 $$ assertEquals(expectedOutput.toString(), output)[ FD ]
Line_3 $$ JobConf job = new JobConf()-->Line_6 $$ FileOutputFormat.setWorkOutputPath(job, workDir)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_33 $$ StringBuffer expectedOutput = new StringBuffer()[ CD ]
Line_18 $$ Text val2 = new Text("val2")-->Line_36 $$ expectedOutput.append(val2).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_6 $$ FileOutputFormat.setWorkOutputPath(job, workDir)[ CD ]
Line_17 $$ Text val1 = new Text("val1")-->Line_34 $$ expectedOutput.append(key1).append('\t').append(val1).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_17 $$ Text val1 = new Text("val1")[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_37 $$ expectedOutput.append(key2).append("\n")[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_13 $$ TextOutputFormat<Object, Object> theOutputFormat = new TextOutputFormat<Object, Object>()[ CD ]
Line_13 $$ TextOutputFormat<Object, Object> theOutputFormat = new TextOutputFormat<Object, Object>()-->Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_22 $$ theRecordWriter.write(null, nullWritable)[ FD ]
Line_11 $$ String file = "test_format.txt"-->Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_35 $$ expectedOutput.append(val1).append("\n")[ CD ]
Line_15 $$ Text key1 = new Text("key1")-->Line_21 $$ theRecordWriter.write(key1, val1)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_23 $$ theRecordWriter.write(null, val1)[ FD ]
Line_33 $$ StringBuffer expectedOutput = new StringBuffer()-->Line_34 $$ expectedOutput.append(key1).append('\t').append(val1).append("\n")[ FD ]
Line_2 $$ public void testFormat() throws Exception -->Line_5 $$ FileOutputFormat.setOutputPath(job, workDir.getParent().getParent())[ CD ]
Line_2 $$ public void testFormat() throws Exception -->Line_39 $$ expectedOutput.append(key2).append('\t').append(val2).append("\n")[ CD ]
Line_19 $$ NullWritable nullWritable = NullWritable.get()-->Line_24 $$ theRecordWriter.write(nullWritable, val2)[ FD ]
Line_14 $$ RecordWriter<Object, Object> theRecordWriter = theOutputFormat.getRecordWriter(localFs, job, file, reporter)-->Line_28 $$ theRecordWriter.write(key2, val2)[ FD ]
