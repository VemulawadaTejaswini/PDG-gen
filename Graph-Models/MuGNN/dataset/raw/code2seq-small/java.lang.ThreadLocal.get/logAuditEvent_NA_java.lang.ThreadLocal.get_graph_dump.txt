Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_13 $$ sb.append("perm=null")[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_9 $$ sb.append("cmd=").append(cmd).append("\t")[ FD ]
Line_25 $$ if (tid instanceof DelegationTokenIdentifier) -->Line_26 $$ DelegationTokenIdentifier dtid = (DelegationTokenIdentifier) tid[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_10 $$ sb.append("src=").append(src).append("\t")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_11 $$ sb.append("dst=").append(dst).append("\t")[ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_10 $$ sb.append("src=").append(src).append("\t")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_4 $$ final StringBuilder sb = auditBuffer.get()[ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_9 $$ sb.append("cmd=").append(cmd).append("\t")[ FD ]
Line_20 $$ if (logTokenTrackingId) -->Line_22 $$ String trackingId = null[ CD ]
Line_20 $$ if (logTokenTrackingId) -->Line_23 $$ if (ugi != null && dtSecretManager != null && ugi.getAuthenticationMethod() == AuthenticationMethod.TOKEN) [ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_5 $$ sb.setLength(0)[ FD ]
Line_22 $$ String trackingId = null-->Line_27 $$ trackingId = dtSecretManager.getTokenTrackingId(dtid)[ FD ]
Line_27 $$ trackingId = dtSecretManager.getTokenTrackingId(dtid)-->Line_32 $$ sb.append(trackingId)[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_16 $$ sb.append(status.getOwner()).append(":")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_36 $$ logAuditMessage(sb.toString())[ CD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_6 $$ sb.append("allowed=").append(succeeded).append("\t")[ CD ]
Line_12 $$ if (null == status) -->Line_16 $$ sb.append(status.getOwner()).append(":")[ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_21 $$ sb.append("\t").append("trackingId=")[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_32 $$ sb.append(trackingId)[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_11 $$ sb.append("dst=").append(dst).append("\t")[ FD ]
Line_12 $$ if (null == status) -->Line_15 $$ sb.append("perm=")[ CD ]
Line_20 $$ if (logTokenTrackingId) -->Line_21 $$ sb.append("\t").append("trackingId=")[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_17 $$ sb.append(status.getGroup()).append(":")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_10 $$ sb.append("src=").append(src).append("\t")[ CD ]
Line_25 $$ if (tid instanceof DelegationTokenIdentifier) -->Line_27 $$ trackingId = dtSecretManager.getTokenTrackingId(dtid)[ CD ]
Line_22 $$ String trackingId = null-->Line_32 $$ sb.append(trackingId)[ FD ]
Line_24 $$ for (TokenIdentifier tid : ugi.getTokenIdentifiers()) -->Line_25 $$ if (tid instanceof DelegationTokenIdentifier) [ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_8 $$ sb.append("ip=").append(addr).append("\t")[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_18 $$ sb.append(status.getPermission())[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_35 $$ sb.append(NamenodeWebHdfsMethods.isWebHdfsInvocation() ? "webhdfs" : "rpc")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_7 $$ sb.append("ugi=").append(userName).append("\t")[ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_15 $$ sb.append("perm=")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_35 $$ sb.append(NamenodeWebHdfsMethods.isWebHdfsInvocation() ? "webhdfs" : "rpc")[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_12 $$ if (null == status) [ FD ]
Line_12 $$ if (null == status) -->Line_18 $$ sb.append(status.getPermission())[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_24 $$ for (TokenIdentifier tid : ugi.getTokenIdentifiers()) [ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_11 $$ sb.append("dst=").append(dst).append("\t")[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_7 $$ sb.append("ugi=").append(userName).append("\t")[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_23 $$ if (ugi != null && dtSecretManager != null && ugi.getAuthenticationMethod() == AuthenticationMethod.TOKEN) [ FD ]
Line_12 $$ if (null == status) -->Line_17 $$ sb.append(status.getGroup()).append(":")[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_27 $$ trackingId = dtSecretManager.getTokenTrackingId(dtid)[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_36 $$ logAuditMessage(sb.toString())[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_12 $$ if (null == status) [ CD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_34 $$ sb.append("\t").append("proto=")[ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_8 $$ sb.append("ip=").append(addr).append("\t")[ FD ]
Line_20 $$ if (logTokenTrackingId) -->Line_32 $$ sb.append(trackingId)[ CD ]
Line_12 $$ if (null == status) -->Line_13 $$ sb.append("perm=null")[ CD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_5 $$ sb.setLength(0)[ CD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_20 $$ if (logTokenTrackingId) [ CD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_34 $$ sb.append("\t").append("proto=")[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_6 $$ sb.append("allowed=").append(succeeded).append("\t")[ FD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_9 $$ sb.append("cmd=").append(cmd).append("\t")[ CD ]
Line_3 $$ if (auditLog.isInfoEnabled()) -->Line_8 $$ sb.append("ip=").append(addr).append("\t")[ CD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_18 $$ sb.append(status.getPermission())[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_17 $$ sb.append(status.getGroup()).append(":")[ FD ]
Line_26 $$ DelegationTokenIdentifier dtid = (DelegationTokenIdentifier) tid-->Line_27 $$ trackingId = dtSecretManager.getTokenTrackingId(dtid)[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_16 $$ sb.append(status.getOwner()).append(":")[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_6 $$ sb.append("allowed=").append(succeeded).append("\t")[ FD ]
Line_4 $$ final StringBuilder sb = auditBuffer.get()-->Line_7 $$ sb.append("ugi=").append(userName).append("\t")[ FD ]
Line_2 $$ public void logAuditEvent(boolean succeeded, String userName, InetAddress addr, String cmd, String src, String dst, FileStatus status, UserGroupInformation ugi, DelegationTokenSecretManager dtSecretManager) -->Line_3 $$ if (auditLog.isInfoEnabled()) [ CD ]
