Line_5 $$ List<Long> columnIds = ImmutableList.of(3L, 7L, 2L, 1L, 5L)-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_5 $$ List<Long> columnIds = ImmutableList.of(3L, 7L, 2L, 1L, 5L)-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
Line_8 $$ List<Integer> sortIndexes = sortColumnIds.stream().map(columnIds::<>indexOf).collect(toList())-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)-->Line_10 $$ assertEquals(inputShards.size(), 2)[ FD ]
Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)-->Line_11 $$ long totalRows = inputShards.stream().mapToLong(ShardInfo::<>getRowCount).sum()[ FD ]
Line_4 $$ List<Type> columnTypes = ImmutableList.of(BIGINT, VARCHAR, DATE, TIMESTAMP, DOUBLE)-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)-->Line_16 $$ List<UUID> outputUuids = outputShards.stream().map(ShardInfo::<>getShardUuid).collect(toList())[ FD ]
Line_6 $$ List<Long> sortColumnIds = ImmutableList.of(1L, 2L, 3L, 5L, 7L)-->Line_8 $$ List<Integer> sortIndexes = sortColumnIds.stream().map(columnIds::<>indexOf).collect(toList())[ FD ]
Line_16 $$ List<UUID> outputUuids = outputShards.stream().map(ShardInfo::<>getShardUuid).collect(toList())-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
Line_4 $$ List<Type> columnTypes = ImmutableList.of(BIGINT, VARCHAR, DATE, TIMESTAMP, DOUBLE)-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)-->Line_17 $$ assertEquals(outputShards.size(), expectedOutputShards)[ FD ]
Line_6 $$ List<Long> sortColumnIds = ImmutableList.of(1L, 2L, 3L, 5L, 7L)-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_7 $$ List<SortOrder> sortOrders = nCopies(sortColumnIds.size(), ASC_NULLS_FIRST)-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_8 $$ List<Integer> sortIndexes = sortColumnIds.stream().map(columnIds::<>indexOf).collect(toList())-->Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)[ FD ]
Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)-->Line_13 $$ Set<UUID> inputUuids = inputShards.stream().map(ShardInfo::<>getShardUuid).collect(toSet())[ FD ]
Line_14 $$ long transactionId = 1-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_13 $$ Set<UUID> inputUuids = inputShards.stream().map(ShardInfo::<>getShardUuid).collect(toSet())-->Line_15 $$ List<ShardInfo> outputShards = compactor.compactSorted(transactionId, inputUuids, getColumnInfo(columnIds, columnTypes), sortColumnIds, sortOrders)[ FD ]
Line_6 $$ List<Long> sortColumnIds = ImmutableList.of(1L, 2L, 3L, 5L, 7L)-->Line_7 $$ List<SortOrder> sortOrders = nCopies(sortColumnIds.size(), ASC_NULLS_FIRST)[ FD ]
Line_5 $$ List<Long> columnIds = ImmutableList.of(3L, 7L, 2L, 1L, 5L)-->Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)[ FD ]
Line_11 $$ long totalRows = inputShards.stream().mapToLong(ShardInfo::<>getRowCount).sum()-->Line_12 $$ long expectedOutputShards = computeExpectedOutputShards(totalRows)[ FD ]
Line_4 $$ List<Type> columnTypes = ImmutableList.of(BIGINT, VARCHAR, DATE, TIMESTAMP, DOUBLE)-->Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)[ FD ]
Line_7 $$ List<SortOrder> sortOrders = nCopies(sortColumnIds.size(), ASC_NULLS_FIRST)-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
Line_7 $$ List<SortOrder> sortOrders = nCopies(sortColumnIds.size(), ASC_NULLS_FIRST)-->Line_9 $$ List<ShardInfo> inputShards = createSortedShards(storageManager, columnIds, columnTypes, sortIndexes, sortOrders, 2)[ FD ]
Line_12 $$ long expectedOutputShards = computeExpectedOutputShards(totalRows)-->Line_17 $$ assertEquals(outputShards.size(), expectedOutputShards)[ FD ]
Line_13 $$ Set<UUID> inputUuids = inputShards.stream().map(ShardInfo::<>getShardUuid).collect(toSet())-->Line_18 $$ assertShardEqualsSorted(inputUuids, outputUuids, columnIds, columnTypes, sortIndexes, sortOrders)[ FD ]
