Line_3 $$ boolean upgradeToIdBasedLayout = false-->Line_11 $$ linkBlocksHelper(from, to, oldLV, hl, upgradeToIdBasedLayout, to, idBasedLayoutSingleLinks)[ FD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_14 $$ final int step = idBasedLayoutSingleLinks.size() / numLinkWorkers + 1[ CD ]
Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()-->Line_16 $$ for (int i = 0; i < idBasedLayoutSingleLinks.size(); i += step) [ FD ]
Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()-->Line_24 $$ LinkArgs cur = idBasedLayoutSingleLinks.get(j)[ FD ]
Line_22 $$ int upperBound = Math.min(iCopy + step, idBasedLayoutSingleLinks.size())-->Line_23 $$ for (int j = iCopy; j < upperBound; j++) [ FD ]
Line_16 $$ for (int i = 0; i < idBasedLayoutSingleLinks.size(); i += step) -->Line_17 $$ final int iCopy = i[ CD ]
Line_13 $$ ExecutorService linkWorkers = Executors.newFixedThreadPool(numLinkWorkers)-->Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() [ FD ]
Line_8 $$ upgradeToIdBasedLayout = true-->Line_11 $$ linkBlocksHelper(from, to, oldLV, hl, upgradeToIdBasedLayout, to, idBasedLayoutSingleLinks)[ FD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_3 $$ boolean upgradeToIdBasedLayout = false[ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_16 $$ for (int i = 0; i < idBasedLayoutSingleLinks.size(); i += step) [ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()[ CD ]
Line_13 $$ ExecutorService linkWorkers = Executors.newFixedThreadPool(numLinkWorkers)-->Line_31 $$ linkWorkers.shutdown()[ FD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_15 $$ List<Future<Void>> futures = Lists.newArrayList()[ CD ]
Line_3 $$ boolean upgradeToIdBasedLayout = false-->Line_8 $$ upgradeToIdBasedLayout = true[ FD ]
Line_16 $$ for (int i = 0; i < idBasedLayoutSingleLinks.size(); i += step) -->Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() [ CD ]
Line_14 $$ final int step = idBasedLayoutSingleLinks.size() / numLinkWorkers + 1-->Line_16 $$ for (int i = 0; i < idBasedLayoutSingleLinks.size(); i += step) [ FD ]
Line_12 $$ int numLinkWorkers = datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS_KEY, DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS)-->Line_13 $$ ExecutorService linkWorkers = Executors.newFixedThreadPool(numLinkWorkers)[ FD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_11 $$ linkBlocksHelper(from, to, oldLV, hl, upgradeToIdBasedLayout, to, idBasedLayoutSingleLinks)[ FD ]
Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()-->Line_22 $$ int upperBound = Math.min(iCopy + step, idBasedLayoutSingleLinks.size())[ FD ]
Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() -->Line_22 $$ int upperBound = Math.min(iCopy + step, idBasedLayoutSingleLinks.size())[ CD ]
Line_23 $$ for (int j = iCopy; j < upperBound; j++) -->Line_24 $$ LinkArgs cur = idBasedLayoutSingleLinks.get(j)[ FD ]
Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()-->Line_14 $$ final int step = idBasedLayoutSingleLinks.size() / numLinkWorkers + 1[ FD ]
Line_15 $$ List<Future<Void>> futures = Lists.newArrayList()-->Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() [ FD ]
Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() -->Line_27 $$ return null[ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_12 $$ int numLinkWorkers = datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS_KEY, DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS)[ CD ]
Line_23 $$ for (int j = iCopy; j < upperBound; j++) -->Line_24 $$ LinkArgs cur = idBasedLayoutSingleLinks.get(j)[ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_12 $$ int numLinkWorkers = datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS_KEY, DFSConfigKeys.DFS_DATANODE_BLOCK_ID_LAYOUT_UPGRADE_THREADS)[ FD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_31 $$ linkWorkers.shutdown()[ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_13 $$ ExecutorService linkWorkers = Executors.newFixedThreadPool(numLinkWorkers)[ CD ]
Line_23 $$ for (int j = iCopy; j < upperBound; j++) -->Line_25 $$ NativeIO.link(cur.src, cur.dst)[ CD ]
Line_18 $$ futures.add(linkWorkers.submit(new Callable<Void>() -->Line_23 $$ for (int j = iCopy; j < upperBound; j++) [ CD ]
Line_2 $$ static void linkBlocks(DataNode datanode, File from, File to, int oldLV, HardLink hl) throws IOException -->Line_11 $$ linkBlocksHelper(from, to, oldLV, hl, upgradeToIdBasedLayout, to, idBasedLayoutSingleLinks)[ CD ]
Line_10 $$ final List<LinkArgs> idBasedLayoutSingleLinks = Lists.newArrayList()-->Line_11 $$ linkBlocksHelper(from, to, oldLV, hl, upgradeToIdBasedLayout, to, idBasedLayoutSingleLinks)[ FD ]
