Line_39 $$ int totalMaps = job.getTotalMaps()-->Line_40 $$ if (totalMaps < splitsList.size()) [ FD ]
Line_45 $$ avgHostPerSplit = 3-->Line_49 $$ avgHostPerSplit = 3[ FD ]
Line_43 $$ int avgHostPerSplit-->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ FD ]
Line_3 $$ if (splits == null) -->Line_40 $$ if (totalMaps < splitsList.size()) [ CD ]
Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()-->Line_48 $$ if (avgHostPerSplit == 0) [ FD ]
Line_58 $$ for (int j = 0; j < hosts.length; ++j) -->Line_59 $$ hosts[j] = mNodes[j].getName()[ CD ]
Line_2 $$ public InputSplit[] getInputSplits() -->Line_3 $$ if (splits == null) [ CD ]
Line_43 $$ int avgHostPerSplit-->Line_56 $$ MachineNode[] mNodes = cluster.getRandomMachines(avgHostPerSplit, random)[ FD ]
Line_3 $$ if (splits == null) -->Line_64 $$ splits = splitsList.toArray(new InputSplit[splitsList.size()])[ CD ]
Line_45 $$ avgHostPerSplit = 3-->Line_48 $$ if (avgHostPerSplit == 0) [ FD ]
Line_3 $$ if (splits == null) -->Line_44 $$ if (splitsList.size() == 0) [ CD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_34 $$ LOG.warn("InputBytes for task " + mapTask.getTaskID() + " is not defined.")[ FD ]
Line_53 $$ if (cluster == null) -->Line_54 $$ splitsList.add(new FileSplit(emptyPath, 0, 0, new String[0]))[ CD ]
Line_18 $$ if (layers.size() == 0) -->Line_19 $$ LOG.warn("Bad location layer format for task " + mapTask.getTaskID())[ CD ]
Line_31 $$ totalHosts += hosts.length-->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ FD ]
Line_3 $$ if (splits == null) -->Line_6 $$ int totalHosts = 0[ CD ]
Line_49 $$ avgHostPerSplit = 3-->Line_56 $$ MachineNode[] mNodes = cluster.getRandomMachines(avgHostPerSplit, random)[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_61 $$ splitsList.add(new FileSplit(emptyPath, 0, 0, hosts))[ FD ]
Line_22 $$ String host = layers.get(layers.size() - 1).getValue()-->Line_23 $$ if (host == null) [ FD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_13 $$ List<LoggedLocation> locations = mapTask.getPreferredLocations()[ FD ]
Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()-->Line_56 $$ MachineNode[] mNodes = cluster.getRandomMachines(avgHostPerSplit, random)[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_41 $$ LOG.warn("TotalMaps for job " + job.getJobID() + " is less than the total number of map task descriptions (" + totalMaps + "<" + splitsList.size() + ").")[ FD ]
Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()-->Line_49 $$ avgHostPerSplit = 3[ FD ]
Line_8 $$ Pre21JobHistoryConstants.Values taskType = mapTask.getTaskType()-->Line_10 $$ LOG.warn("TaskType for a MapTask is not Map. task=" + mapTask.getTaskID() + " type=" + ((taskType == null) ? "null" : taskType.toString()))[ FD ]
Line_2 $$ public InputSplit[] getInputSplits() -->Line_66 $$ return splits[ CD ]
Line_23 $$ if (host == null) -->Line_24 $$ LOG.warn("Bad location layer format for task " + mapTask.getTaskID() + ": " + layers)[ CD ]
Line_3 $$ if (splits == null) -->Line_39 $$ int totalMaps = job.getTotalMaps()[ CD ]
Line_33 $$ if (mapInputBytes < 0) -->Line_34 $$ LOG.warn("InputBytes for task " + mapTask.getTaskID() + " is not defined.")[ CD ]
Line_3 $$ if (splits == null) -->Line_5 $$ Path emptyPath = new Path("/")[ CD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_24 $$ LOG.warn("Bad location layer format for task " + mapTask.getTaskID() + ": " + layers)[ FD ]
Line_43 $$ int avgHostPerSplit-->Line_45 $$ avgHostPerSplit = 3[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_64 $$ splits = splitsList.toArray(new InputSplit[splitsList.size()])[ FD ]
Line_45 $$ avgHostPerSplit = 3-->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ FD ]
Line_9 $$ if (taskType != Pre21JobHistoryConstants.Values.MAP) -->Line_10 $$ LOG.warn("TaskType for a MapTask is not Map. task=" + mapTask.getTaskID() + " type=" + ((taskType == null) ? "null" : taskType.toString()))[ CD ]
Line_53 $$ if (cluster == null) -->Line_56 $$ MachineNode[] mNodes = cluster.getRandomMachines(avgHostPerSplit, random)[ CD ]
Line_3 $$ if (splits == null) -->Line_43 $$ int avgHostPerSplit[ CD ]
Line_22 $$ String host = layers.get(layers.size() - 1).getValue()-->Line_27 $$ hostList.add(host)[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_37 $$ splitsList.add(new FileSplit(emptyPath, 0, mapInputBytes, hosts))[ FD ]
Line_8 $$ Pre21JobHistoryConstants.Values taskType = mapTask.getTaskType()-->Line_9 $$ if (taskType != Pre21JobHistoryConstants.Values.MAP) [ FD ]
Line_3 $$ if (splits == null) -->Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()[ CD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_10 $$ LOG.warn("TaskType for a MapTask is not Map. task=" + mapTask.getTaskID() + " type=" + ((taskType == null) ? "null" : taskType.toString()))[ FD ]
Line_43 $$ int avgHostPerSplit-->Line_48 $$ if (avgHostPerSplit == 0) [ FD ]
Line_43 $$ int avgHostPerSplit-->Line_49 $$ avgHostPerSplit = 3[ FD ]
Line_33 $$ if (mapInputBytes < 0) -->Line_35 $$ mapInputBytes = 0[ CD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_8 $$ Pre21JobHistoryConstants.Values taskType = mapTask.getTaskType()[ FD ]
Line_17 $$ List<NodeName> layers = location.getLayers()-->Line_18 $$ if (layers.size() == 0) [ FD ]
Line_52 $$ for (int i = splitsList.size(); i < totalMaps; i++) -->Line_53 $$ if (cluster == null) [ CD ]
Line_6 $$ int totalHosts = 0-->Line_31 $$ totalHosts += hosts.length[ FD ]
Line_32 $$ long mapInputBytes = getTaskInfo(mapTask).getInputBytes()-->Line_35 $$ mapInputBytes = 0[ FD ]
Line_6 $$ int totalHosts = 0-->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_54 $$ splitsList.add(new FileSplit(emptyPath, 0, 0, new String[0]))[ FD ]
Line_14 $$ List<String> hostList = new ArrayList<String>()-->Line_30 $$ String[] hosts = hostList.toArray(new String[hostList.size()])[ FD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_19 $$ LOG.warn("Bad location layer format for task " + mapTask.getTaskID())[ FD ]
Line_53 $$ if (cluster == null) -->Line_57 $$ String[] hosts = new String[mNodes.length][ CD ]
Line_44 $$ if (splitsList.size() == 0) -->Line_48 $$ if (avgHostPerSplit == 0) [ CD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_44 $$ if (splitsList.size() == 0) [ FD ]
Line_14 $$ List<String> hostList = new ArrayList<String>()-->Line_27 $$ hostList.add(host)[ FD ]
Line_17 $$ List<NodeName> layers = location.getLayers()-->Line_22 $$ String host = layers.get(layers.size() - 1).getValue()[ FD ]
Line_16 $$ for (LoggedLocation location : locations) -->Line_17 $$ List<NodeName> layers = location.getLayers()[ FD ]
Line_44 $$ if (splitsList.size() == 0) -->Line_47 $$ avgHostPerSplit = totalHosts / splitsList.size()[ CD ]
Line_53 $$ if (cluster == null) -->Line_58 $$ for (int j = 0; j < hosts.length; ++j) [ CD ]
Line_32 $$ long mapInputBytes = getTaskInfo(mapTask).getInputBytes()-->Line_33 $$ if (mapInputBytes < 0) [ FD ]
Line_40 $$ if (totalMaps < splitsList.size()) -->Line_41 $$ LOG.warn("TotalMaps for job " + job.getJobID() + " is less than the total number of map task descriptions (" + totalMaps + "<" + splitsList.size() + ").")[ CD ]
Line_44 $$ if (splitsList.size() == 0) -->Line_45 $$ avgHostPerSplit = 3[ CD ]
Line_7 $$ for (LoggedTask mapTask : job.getMapTasks()) -->Line_32 $$ long mapInputBytes = getTaskInfo(mapTask).getInputBytes()[ FD ]
Line_13 $$ List<LoggedLocation> locations = mapTask.getPreferredLocations()-->Line_15 $$ if (locations != null) [ FD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_40 $$ if (totalMaps < splitsList.size()) [ FD ]
Line_3 $$ if (splits == null) -->Line_52 $$ for (int i = splitsList.size(); i < totalMaps; i++) [ CD ]
Line_39 $$ int totalMaps = job.getTotalMaps()-->Line_52 $$ for (int i = splitsList.size(); i < totalMaps; i++) [ FD ]
Line_48 $$ if (avgHostPerSplit == 0) -->Line_49 $$ avgHostPerSplit = 3[ CD ]
Line_53 $$ if (cluster == null) -->Line_61 $$ splitsList.add(new FileSplit(emptyPath, 0, 0, hosts))[ CD ]
Line_4 $$ List<InputSplit> splitsList = new ArrayList<InputSplit>()-->Line_52 $$ for (int i = splitsList.size(); i < totalMaps; i++) [ FD ]
Line_45 $$ avgHostPerSplit = 3-->Line_56 $$ MachineNode[] mNodes = cluster.getRandomMachines(avgHostPerSplit, random)[ FD ]
