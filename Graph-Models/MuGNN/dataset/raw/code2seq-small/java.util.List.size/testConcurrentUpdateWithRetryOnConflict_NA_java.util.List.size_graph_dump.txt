Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()[ FD ]
Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()-->Line_54 $$ assertThat((Integer) response.getSource().get("field"), equalTo(numberOfThreads))[ FD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_54 $$ assertThat((Integer) response.getSource().get("field"), equalTo(numberOfThreads))[ CD ]
Line_10 $$ final List<Throwable> failures = new CopyOnWriteArrayList()-->Line_33 $$ failures.add(e)[ FD ]
Line_9 $$ final int numberOfUpdatesPerThread = scaledRandomIntBetween(100, 500)-->Line_18 $$ logger.debug("Client [[ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ FD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_52 $$ assertThat(response.isExists(), equalTo(true))[ CD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_12 $$ Runnable r = new Runnable() [ CD ]
Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()-->Line_53 $$ assertThat(response.getVersion(), equalTo((long) numberOfThreads))[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_44 $$ latch.await()[ CD ]
Line_21 $$ UpdateRequestBuilder updateRequestBuilder = client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject())-->Line_22 $$ client().prepareBulk().add(updateRequestBuilder).execute().actionGet()[ FD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_51 $$ assertThat(response.getId(), equalTo(Integer.toString(i)))[ CD ]
Line_20 $$ if (useBulkApi) -->Line_22 $$ client().prepareBulk().add(updateRequestBuilder).execute().actionGet()[ CD ]
Line_6 $$ int numberOfThreads = scaledRandomIntBetween(2, 5)-->Line_11 $$ for (int i = 0; i < numberOfThreads; i++) [ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ FD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_17 $$ if (i % 100 == 0) [ CD ]
Line_17 $$ if (i % 100 == 0) -->Line_18 $$ logger.debug("Client [[ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_3 $$ final boolean useBulkApi = randomBoolean()[ CD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_21 $$ UpdateRequestBuilder updateRequestBuilder = client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject())[ FD ]
Line_20 $$ if (useBulkApi) -->Line_24 $$ client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject()).execute().actionGet()[ CD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_24 $$ client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject()).execute().actionGet()[ FD ]
Line_9 $$ final int numberOfUpdatesPerThread = scaledRandomIntBetween(100, 500)-->Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ FD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()[ FD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_51 $$ assertThat(response.getId(), equalTo(Integer.toString(i)))[ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_21 $$ UpdateRequestBuilder updateRequestBuilder = client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject())[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_43 $$ startLatch.countDown()[ CD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_51 $$ assertThat(response.getId(), equalTo(Integer.toString(i)))[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_48 $$ assertThat(failures.size(), equalTo(0))[ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_9 $$ final int numberOfUpdatesPerThread = scaledRandomIntBetween(100, 500)[ CD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ FD ]
Line_10 $$ final List<Throwable> failures = new CopyOnWriteArrayList()-->Line_30 $$ failures.add(e)[ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()[ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_18 $$ logger.debug("Client [[ FD ]
Line_8 $$ final CountDownLatch startLatch = new CountDownLatch(1)-->Line_43 $$ startLatch.countDown()[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_5 $$ ensureGreen()[ CD ]
Line_10 $$ final List<Throwable> failures = new CopyOnWriteArrayList()-->Line_48 $$ assertThat(failures.size(), equalTo(0))[ FD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_18 $$ logger.debug("Client [[ FD ]
Line_9 $$ final int numberOfUpdatesPerThread = scaledRandomIntBetween(100, 500)-->Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) [ FD ]
Line_6 $$ int numberOfThreads = scaledRandomIntBetween(2, 5)-->Line_54 $$ assertThat((Integer) response.getSource().get("field"), equalTo(numberOfThreads))[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_4 $$ createTestIndex()[ CD ]
Line_20 $$ if (useBulkApi) -->Line_21 $$ UpdateRequestBuilder updateRequestBuilder = client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject())[ CD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_53 $$ assertThat(response.getVersion(), equalTo((long) numberOfThreads))[ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_10 $$ final List<Throwable> failures = new CopyOnWriteArrayList()[ CD ]
Line_9 $$ final int numberOfUpdatesPerThread = scaledRandomIntBetween(100, 500)-->Line_27 $$ logger.info("Client [[ FD ]
Line_7 $$ final CountDownLatch latch = new CountDownLatch(numberOfThreads)-->Line_44 $$ latch.await()[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_8 $$ final CountDownLatch startLatch = new CountDownLatch(1)[ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_11 $$ for (int i = 0; i < numberOfThreads; i++) [ CD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_24 $$ client().prepareUpdate(indexOrAlias(), "type1", Integer.toString(i)).setScript(new Script("field", ScriptService.ScriptType.INLINE, "field_inc", null)).setRetryOnConflict(Integer.MAX_VALUE).setUpsert(jsonBuilder().startObject().field("field", 1).endObject()).execute().actionGet()[ FD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_51 $$ assertThat(response.getId(), equalTo(Integer.toString(i)))[ FD ]
Line_8 $$ final CountDownLatch startLatch = new CountDownLatch(1)-->Line_15 $$ startLatch.await()[ FD ]
Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()-->Line_51 $$ assertThat(response.getId(), equalTo(Integer.toString(i)))[ FD ]
Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()-->Line_52 $$ assertThat(response.isExists(), equalTo(true))[ FD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_7 $$ final CountDownLatch latch = new CountDownLatch(numberOfThreads)[ CD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_40 $$ updater.setName("UpdateIT-Client-" + i)[ CD ]
Line_2 $$ public void testConcurrentUpdateWithRetryOnConflict() throws Exception -->Line_6 $$ int numberOfThreads = scaledRandomIntBetween(2, 5)[ CD ]
Line_11 $$ for (int i = 0; i < numberOfThreads; i++) -->Line_41 $$ updater.start()[ CD ]
Line_49 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_50 $$ GetResponse response = client().prepareGet("test", "type1", Integer.toString(i)).execute().actionGet()[ CD ]
Line_7 $$ final CountDownLatch latch = new CountDownLatch(numberOfThreads)-->Line_35 $$ latch.countDown()[ FD ]
Line_16 $$ for (int i = 0; i < numberOfUpdatesPerThread; i++) -->Line_20 $$ if (useBulkApi) [ CD ]
