Line_19 $$ while (recordReader.nextKeyValue()) -->Line_28 $$ previousProgressValue = progress[ CD ]
Line_9 $$ DynamicInputFormat<Text, CopyListingFileStatus> inputFormat = new DynamicInputFormat<Text, CopyListingFileStatus>()-->Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)[ FD ]
Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)-->Line_31 $$ Assert.assertTrue(recordReader.getProgress() == 1.0f)[ FD ]
Line_11 $$ int nFiles = 0-->Line_29 $$ ++nFiles[ FD ]
Line_24 $$ final float progress = recordReader.getProgress()-->Line_28 $$ previousProgressValue = progress[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_27 $$ Assert.assertTrue(progress <= 1.0f)[ CD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_29 $$ ++nFiles[ CD ]
Line_8 $$ JobContext jobContext = new JobContextImpl(configuration, new JobID())-->Line_10 $$ List<InputSplit> splits = inputFormat.getSplits(jobContext)[ FD ]
Line_9 $$ DynamicInputFormat<Text, CopyListingFileStatus> inputFormat = new DynamicInputFormat<Text, CopyListingFileStatus>()-->Line_10 $$ List<InputSplit> splits = inputFormat.getSplits(jobContext)[ FD ]
Line_10 $$ List<InputSplit> splits = inputFormat.getSplits(jobContext)-->Line_17 $$ recordReader.initialize(splits.get(0), taskAttemptContext)[ FD ]
Line_4 $$ DistCpOptions options = getOptions()-->Line_6 $$ configuration.set("mapred.map.tasks", String.valueOf(options.getMaxMaps()))[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_23 $$ Assert.assertTrue(expectedFilePaths.contains(source))[ CD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_25 $$ Assert.assertTrue(progress >= previousProgressValue)[ CD ]
Line_16 $$ final TaskAttemptContext taskAttemptContext = stubContext.getContext()-->Line_17 $$ recordReader.initialize(splits.get(0), taskAttemptContext)[ FD ]
Line_13 $$ for (InputSplit split : splits) -->Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_20 $$ CopyListingFileStatus fileStatus = recordReader.getCurrentValue()[ CD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_22 $$ System.out.println(source)[ CD ]
Line_21 $$ String source = fileStatus.getPath().toString()-->Line_23 $$ Assert.assertTrue(expectedFilePaths.contains(source))[ FD ]
Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)-->Line_17 $$ recordReader.initialize(splits.get(0), taskAttemptContext)[ FD ]
Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)-->Line_24 $$ final float progress = recordReader.getProgress()[ FD ]
Line_15 $$ StubContext stubContext = new StubContext(jobContext.getConfiguration(), recordReader, taskId)-->Line_16 $$ final TaskAttemptContext taskAttemptContext = stubContext.getContext()[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_21 $$ String source = fileStatus.getPath().toString()[ CD ]
Line_20 $$ CopyListingFileStatus fileStatus = recordReader.getCurrentValue()-->Line_21 $$ String source = fileStatus.getPath().toString()[ FD ]
Line_18 $$ float previousProgressValue = 0f-->Line_28 $$ previousProgressValue = progress[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_24 $$ final float progress = recordReader.getProgress()[ CD ]
Line_5 $$ Configuration configuration = new Configuration()-->Line_7 $$ CopyListing.getCopyListing(configuration, CREDENTIALS, options).buildListing(new Path(cluster.getFileSystem().getUri().toString() + "/tmp/testDynInputFormat/fileList.seq"), options)[ FD ]
Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)-->Line_19 $$ while (recordReader.nextKeyValue()) [ FD ]
Line_8 $$ JobContext jobContext = new JobContextImpl(configuration, new JobID())-->Line_15 $$ StubContext stubContext = new StubContext(jobContext.getConfiguration(), recordReader, taskId)[ FD ]
Line_4 $$ DistCpOptions options = getOptions()-->Line_7 $$ CopyListing.getCopyListing(configuration, CREDENTIALS, options).buildListing(new Path(cluster.getFileSystem().getUri().toString() + "/tmp/testDynInputFormat/fileList.seq"), options)[ FD ]
Line_19 $$ while (recordReader.nextKeyValue()) -->Line_26 $$ Assert.assertTrue(progress >= 0.0f)[ CD ]
Line_5 $$ Configuration configuration = new Configuration()-->Line_6 $$ configuration.set("mapred.map.tasks", String.valueOf(options.getMaxMaps()))[ FD ]
Line_21 $$ String source = fileStatus.getPath().toString()-->Line_22 $$ System.out.println(source)[ FD ]
Line_11 $$ int nFiles = 0-->Line_34 $$ Assert.assertEquals(expectedFilePaths.size(), nFiles)[ FD ]
Line_12 $$ int taskId = 0-->Line_32 $$ ++taskId[ FD ]
Line_14 $$ RecordReader<Text, CopyListingFileStatus> recordReader = inputFormat.createRecordReader(split, null)-->Line_20 $$ CopyListingFileStatus fileStatus = recordReader.getCurrentValue()[ FD ]
