Line_2 $$ public void testBulkProcessorFlush() throws InterruptedException -->Line_5 $$ int numDocs = randomIntBetween(10, 100)[ CD ]
Line_2 $$ public void testBulkProcessorFlush() throws InterruptedException -->Line_3 $$ final CountDownLatch latch = new CountDownLatch(1)[ CD ]
Line_6 $$ try (BulkProcessor processor = BulkProcessor.builder(client(), listener).setName("foo").setConcurrentRequests(randomIntBetween(0, 10)).setBulkActions(numDocs + randomIntBetween(1, 100)).setFlushInterval(TimeValue.timeValueHours(24)).setBulkSize(new ByteSizeValue(1, ByteSizeUnit.GB)).build()) -->Line_8 $$ MultiGetRequestBuilder multiGetRequestBuilder = indexDocs(client(), processor, numDocs)[ FD ]
Line_5 $$ int numDocs = randomIntBetween(10, 100)-->Line_8 $$ MultiGetRequestBuilder multiGetRequestBuilder = indexDocs(client(), processor, numDocs)[ FD ]
Line_2 $$ public void testBulkProcessorFlush() throws InterruptedException -->Line_4 $$ BulkProcessorTestListener listener = new BulkProcessorTestListener(latch)[ CD ]
Line_5 $$ int numDocs = randomIntBetween(10, 100)-->Line_16 $$ assertMultiGetResponse(multiGetRequestBuilder.get(), numDocs)[ FD ]
Line_6 $$ try (BulkProcessor processor = BulkProcessor.builder(client(), listener).setName("foo").setConcurrentRequests(randomIntBetween(0, 10)).setBulkActions(numDocs + randomIntBetween(1, 100)).setFlushInterval(TimeValue.timeValueHours(24)).setBulkSize(new ByteSizeValue(1, ByteSizeUnit.GB)).build()) -->Line_10 $$ processor.flush()[ FD ]
Line_4 $$ BulkProcessorTestListener listener = new BulkProcessorTestListener(latch)-->Line_6 $$ try (BulkProcessor processor = BulkProcessor.builder(client(), listener).setName("foo").setConcurrentRequests(randomIntBetween(0, 10)).setBulkActions(numDocs + randomIntBetween(1, 100)).setFlushInterval(TimeValue.timeValueHours(24)).setBulkSize(new ByteSizeValue(1, ByteSizeUnit.GB)).build()) [ FD ]
Line_3 $$ final CountDownLatch latch = new CountDownLatch(1)-->Line_9 $$ assertThat(latch.await(randomInt(500), TimeUnit.MILLISECONDS), equalTo(false))[ FD ]
Line_8 $$ MultiGetRequestBuilder multiGetRequestBuilder = indexDocs(client(), processor, numDocs)-->Line_16 $$ assertMultiGetResponse(multiGetRequestBuilder.get(), numDocs)[ FD ]
Line_5 $$ int numDocs = randomIntBetween(10, 100)-->Line_15 $$ assertResponseItems(listener.bulkItems, numDocs)[ FD ]
Line_3 $$ final CountDownLatch latch = new CountDownLatch(1)-->Line_11 $$ latch.await()[ FD ]
