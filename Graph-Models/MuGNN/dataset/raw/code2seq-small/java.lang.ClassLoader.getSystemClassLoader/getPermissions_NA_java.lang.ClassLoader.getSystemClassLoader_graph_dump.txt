Line_61 $$ URL url = enumeration.nextElement()-->Line_64 $$ JarURLConnection jarURLConnection = (JarURLConnection) url.openConnection()[ FD ]
Line_10 $$ String fullPropertyName = _ENV_PREFIX + propertyName + StringPool.CLOSE_CURLY_BRACE-->Line_11 $$ if (!ArrayUtil.contains(_defaultReadPathsFromArray, fullPropertyName)) [ FD ]
Line_18 $$ String[] paths = StringUtil.split(value)-->Line_57 $$ addCanonicalPaths(paths, file)[ FD ]
Line_15 $$ x = value.indexOf(_ENV_PREFIX, y + 1)-->Line_6 $$ while (x >= 0) [ FD ]
Line_5 $$ int x = value.indexOf(_ENV_PREFIX)-->Line_6 $$ while (x >= 0) [ FD ]
Line_56 $$ File file = new File(System.getProperty("java.home") + "/lib")-->Line_57 $$ addCanonicalPaths(paths, file)[ FD ]
Line_77 $$ if (ServerDetector.isResin()) -->Line_78 $$ String resinHome = System.getProperty("resin.home")[ CD ]
Line_11 $$ if (!ArrayUtil.contains(_defaultReadPathsFromArray, fullPropertyName)) -->Line_13 $$ _defaultReadPathsToArray = ArrayUtil.append(_defaultReadPathsToArray, propertyValue)[ CD ]
Line_69 $$ fileName = fileName.substring(0, pos + 1)-->Line_79 $$ if (fileName.startsWith(resinHome)) [ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) [ CD ]
Line_66 $$ String fileName = jarFileURL.getFile()-->Line_83 $$ addCanonicalPath(paths, fileName)[ FD ]
Line_15 $$ x = value.indexOf(_ENV_PREFIX, y + 1)-->Line_7 $$ int y = value.indexOf(StringPool.CLOSE_CURLY_BRACE, x)[ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_25 $$ addPermission(path, actions)[ FD ]
Line_61 $$ URL url = enumeration.nextElement()-->Line_62 $$ URLConnection urlConnection = url.openConnection()[ FD ]
Line_71 $$ if (ServerDetector.isJetty()) -->Line_72 $$ String jettyHome = System.getProperty("jetty.home")[ CD ]
Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) -->Line_36 $$ if (servletContext != null) [ CD ]
Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) -->Line_32 $$ addPermission(_workDir + "/-", actions)[ CD ]
Line_3 $$ String value = getProperty(key)-->Line_17 $$ value = StringUtil.replace(value, _defaultReadPathsFromArray, _defaultReadPathsToArray)[ FD ]
Line_36 $$ if (servletContext != null) -->Line_37 $$ File tempDir = (File) servletContext.getAttribute(JavaConstants.JAVAX_SERVLET_CONTEXT_TEMPDIR)[ CD ]
Line_69 $$ fileName = fileName.substring(0, pos + 1)-->Line_73 $$ if (fileName.startsWith(jettyHome)) [ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_31 $$ addPermission(_workDir, actions)[ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_3 $$ String value = getProperty(key)[ CD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_64 $$ JarURLConnection jarURLConnection = (JarURLConnection) url.openConnection()[ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_48 $$ if (!actions.equals(FILE_PERMISSION_ACTION_READ)) [ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_32 $$ addPermission(_workDir + "/-", actions)[ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_45 $$ addPermission(tempDirAbsolutePath + "/-", actions)[ FD ]
Line_4 $$ if (value != null) -->Line_18 $$ String[] paths = StringUtil.split(value)[ CD ]
Line_6 $$ while (x >= 0) -->Line_8 $$ String propertyName = value.substring(x + 6, y)[ CD ]
Line_69 $$ fileName = fileName.substring(0, pos + 1)-->Line_67 $$ int pos = fileName.lastIndexOf(File.separatorChar)[ FD ]
Line_6 $$ while (x >= 0) -->Line_10 $$ String fullPropertyName = _ENV_PREFIX + propertyName + StringPool.CLOSE_CURLY_BRACE[ CD ]
Line_77 $$ if (ServerDetector.isResin()) -->Line_79 $$ if (fileName.startsWith(resinHome)) [ CD ]
Line_18 $$ String[] paths = StringUtil.split(value)-->Line_83 $$ addCanonicalPath(paths, fileName)[ FD ]
Line_5 $$ int x = value.indexOf(_ENV_PREFIX)-->Line_7 $$ int y = value.indexOf(StringPool.CLOSE_CURLY_BRACE, x)[ FD ]
Line_6 $$ while (x >= 0) -->Line_7 $$ int y = value.indexOf(StringPool.CLOSE_CURLY_BRACE, x)[ CD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_77 $$ if (ServerDetector.isResin()) [ CD ]
Line_68 $$ if (pos != -1) -->Line_69 $$ fileName = fileName.substring(0, pos + 1)[ CD ]
Line_36 $$ if (servletContext != null) -->Line_39 $$ if (_log.isDebugEnabled()) [ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) [ FD ]
Line_33 $$ if (ServerDetector.isWebLogic()) -->Line_34 $$ addPermission(_workDir + "/../-", actions)[ CD ]
Line_17 $$ value = StringUtil.replace(value, _defaultReadPathsFromArray, _defaultReadPathsToArray)-->Line_19 $$ if (value.contains("$[ FD ]
Line_71 $$ if (ServerDetector.isJetty()) -->Line_73 $$ if (fileName.startsWith(jettyHome)) [ CD ]
Line_3 $$ String value = getProperty(key)-->Line_7 $$ int y = value.indexOf(StringPool.CLOSE_CURLY_BRACE, x)[ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_42 $$ if (actions.equals(FILE_PERMISSION_ACTION_READ)) [ FD ]
Line_36 $$ if (servletContext != null) -->Line_45 $$ addPermission(tempDirAbsolutePath + "/-", actions)[ CD ]
Line_17 $$ value = StringUtil.replace(value, _defaultReadPathsFromArray, _defaultReadPathsToArray)-->Line_18 $$ String[] paths = StringUtil.split(value)[ FD ]
Line_59 $$ Enumeration<URL> enumeration = classLoader.getResources("META-INF/MANIFEST.MF")-->Line_60 $$ while (enumeration.hasMoreElements()) [ FD ]
Line_60 $$ while (enumeration.hasMoreElements()) -->Line_62 $$ URLConnection urlConnection = url.openConnection()[ CD ]
Line_42 $$ if (actions.equals(FILE_PERMISSION_ACTION_READ)) -->Line_43 $$ addPermission(tempDirAbsolutePath, actions)[ CD ]
Line_36 $$ if (servletContext != null) -->Line_38 $$ String tempDirAbsolutePath = tempDir.getAbsolutePath()[ CD ]
Line_66 $$ String fileName = jarFileURL.getFile()-->Line_73 $$ if (fileName.startsWith(jettyHome)) [ FD ]
Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) -->Line_31 $$ addPermission(_workDir, actions)[ CD ]
Line_3 $$ String value = getProperty(key)-->Line_8 $$ String propertyName = value.substring(x + 6, y)[ FD ]
Line_39 $$ if (_log.isDebugEnabled()) -->Line_40 $$ _log.debug("Temp directory " + tempDirAbsolutePath)[ CD ]
Line_4 $$ if (value != null) -->Line_19 $$ if (value.contains("$[ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_101 $$ addPermission(path, actions)[ FD ]
Line_72 $$ String jettyHome = System.getProperty("jetty.home")-->Line_73 $$ if (fileName.startsWith(jettyHome)) [ FD ]
Line_62 $$ URLConnection urlConnection = url.openConnection()-->Line_63 $$ if (urlConnection instanceof JarURLConnection) [ FD ]
Line_3 $$ String value = getProperty(key)-->Line_4 $$ if (value != null) [ FD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_68 $$ if (pos != -1) [ CD ]
Line_58 $$ ClassLoader classLoader = ClassLoader.getSystemClassLoader()-->Line_59 $$ Enumeration<URL> enumeration = classLoader.getResources("META-INF/MANIFEST.MF")[ FD ]
Line_36 $$ if (servletContext != null) -->Line_42 $$ if (actions.equals(FILE_PERMISSION_ACTION_READ)) [ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_4 $$ if (value != null) [ CD ]
Line_5 $$ int x = value.indexOf(_ENV_PREFIX)-->Line_15 $$ x = value.indexOf(_ENV_PREFIX, y + 1)[ FD ]
Line_3 $$ String value = getProperty(key)-->Line_5 $$ int x = value.indexOf(_ENV_PREFIX)[ FD ]
Line_11 $$ if (!ArrayUtil.contains(_defaultReadPathsFromArray, fullPropertyName)) -->Line_12 $$ _defaultReadPathsFromArray = ArrayUtil.append(_defaultReadPathsFromArray, fullPropertyName)[ CD ]
Line_20 $$ for (int i = 0; i < paths.length; i++) -->Line_21 $$ paths[i] = StringUtil.replace(paths[i], "$[ CD ]
Line_67 $$ int pos = fileName.lastIndexOf(File.separatorChar)-->Line_68 $$ if (pos != -1) [ FD ]
Line_18 $$ String[] paths = StringUtil.split(value)-->Line_91 $$ paths.add(_GLOBAL_SHARED_LIB_DIR + "-")[ FD ]
Line_3 $$ String value = getProperty(key)-->Line_19 $$ if (value.contains("$[ FD ]
Line_4 $$ if (value != null) -->Line_6 $$ while (x >= 0) [ CD ]
Line_9 $$ String propertyValue = GetterUtil.getString(System.getenv(propertyName))-->Line_13 $$ _defaultReadPathsToArray = ArrayUtil.append(_defaultReadPathsToArray, propertyValue)[ FD ]
Line_6 $$ while (x >= 0) -->Line_11 $$ if (!ArrayUtil.contains(_defaultReadPathsFromArray, fullPropertyName)) [ CD ]
Line_6 $$ while (x >= 0) -->Line_9 $$ String propertyValue = GetterUtil.getString(System.getenv(propertyName))[ CD ]
Line_60 $$ while (enumeration.hasMoreElements()) -->Line_61 $$ URL url = enumeration.nextElement()[ CD ]
Line_4 $$ if (value != null) -->Line_5 $$ int x = value.indexOf(_ENV_PREFIX)[ CD ]
Line_3 $$ String value = getProperty(key)-->Line_18 $$ String[] paths = StringUtil.split(value)[ FD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_67 $$ int pos = fileName.lastIndexOf(File.separatorChar)[ CD ]
Line_59 $$ Enumeration<URL> enumeration = classLoader.getResources("META-INF/MANIFEST.MF")-->Line_61 $$ URL url = enumeration.nextElement()[ FD ]
Line_4 $$ if (value != null) -->Line_17 $$ value = StringUtil.replace(value, _defaultReadPathsFromArray, _defaultReadPathsToArray)[ CD ]
Line_38 $$ String tempDirAbsolutePath = tempDir.getAbsolutePath()-->Line_43 $$ addPermission(tempDirAbsolutePath, actions)[ FD ]
Line_6 $$ while (x >= 0) -->Line_15 $$ x = value.indexOf(_ENV_PREFIX, y + 1)[ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_48 $$ if (!actions.equals(FILE_PERMISSION_ACTION_READ)) [ CD ]
Line_60 $$ while (enumeration.hasMoreElements()) -->Line_63 $$ if (urlConnection instanceof JarURLConnection) [ CD ]
Line_3 $$ String value = getProperty(key)-->Line_15 $$ x = value.indexOf(_ENV_PREFIX, y + 1)[ FD ]
Line_48 $$ if (!actions.equals(FILE_PERMISSION_ACTION_READ)) -->Line_49 $$ return[ CD ]
Line_18 $$ String[] paths = StringUtil.split(value)-->Line_95 $$ paths.add(_rootDir)[ FD ]
Line_66 $$ String fileName = jarFileURL.getFile()-->Line_69 $$ fileName = fileName.substring(0, pos + 1)[ FD ]
Line_64 $$ JarURLConnection jarURLConnection = (JarURLConnection) url.openConnection()-->Line_65 $$ URL jarFileURL = jarURLConnection.getJarFileURL()[ FD ]
Line_66 $$ String fileName = jarFileURL.getFile()-->Line_67 $$ int pos = fileName.lastIndexOf(File.separatorChar)[ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_43 $$ addPermission(tempDirAbsolutePath, actions)[ FD ]
Line_65 $$ URL jarFileURL = jarURLConnection.getJarFileURL()-->Line_66 $$ String fileName = jarFileURL.getFile()[ FD ]
Line_18 $$ String[] paths = StringUtil.split(value)-->Line_96 $$ paths.add(_rootDir + "-")[ FD ]
Line_69 $$ fileName = fileName.substring(0, pos + 1)-->Line_83 $$ addCanonicalPath(paths, fileName)[ FD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_65 $$ URL jarFileURL = jarURLConnection.getJarFileURL()[ CD ]
Line_24 $$ for (String path : paths) -->Line_25 $$ addPermission(path, actions)[ FD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_83 $$ addCanonicalPath(paths, fileName)[ CD ]
Line_30 $$ if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) -->Line_33 $$ if (ServerDetector.isWebLogic()) [ CD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_3 $$ String value = getProperty(key)[ FD ]
Line_8 $$ String propertyName = value.substring(x + 6, y)-->Line_9 $$ String propertyValue = GetterUtil.getString(System.getenv(propertyName))[ FD ]
Line_37 $$ File tempDir = (File) servletContext.getAttribute(JavaConstants.JAVAX_SERVLET_CONTEXT_TEMPDIR)-->Line_38 $$ String tempDirAbsolutePath = tempDir.getAbsolutePath()[ FD ]
Line_24 $$ for (String path : paths) -->Line_101 $$ addPermission(path, actions)[ FD ]
Line_19 $$ if (value.contains("$-->Line_20 $$ for (int i = 0; i < paths.length; i++) [ CD ]
Line_10 $$ String fullPropertyName = _ENV_PREFIX + propertyName + StringPool.CLOSE_CURLY_BRACE-->Line_12 $$ _defaultReadPathsFromArray = ArrayUtil.append(_defaultReadPathsFromArray, fullPropertyName)[ FD ]
Line_7 $$ int y = value.indexOf(StringPool.CLOSE_CURLY_BRACE, x)-->Line_8 $$ String propertyName = value.substring(x + 6, y)[ FD ]
Line_78 $$ String resinHome = System.getProperty("resin.home")-->Line_79 $$ if (fileName.startsWith(resinHome)) [ FD ]
Line_2 $$ protected void getPermissions(String key, String actions) -->Line_34 $$ addPermission(_workDir + "/../-", actions)[ FD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_71 $$ if (ServerDetector.isJetty()) [ CD ]
Line_63 $$ if (urlConnection instanceof JarURLConnection) -->Line_66 $$ String fileName = jarFileURL.getFile()[ CD ]
Line_66 $$ String fileName = jarFileURL.getFile()-->Line_79 $$ if (fileName.startsWith(resinHome)) [ FD ]
