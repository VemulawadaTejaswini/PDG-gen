Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_20 $$ if (i == 0) [ FD ]
Line_3 $$ SearchResponse searchResponse = client().prepareSearch("empty_bucket_idx").setQuery(matchAllQuery()).addAggregation(histogram("histo").field(SINGLE_VALUED_FIELD_NAME).interval(1).subAggregation(sum("sum").field(SINGLE_VALUED_FIELD_NAME)).subAggregation(derivative("deriv").setBucketsPaths("sum"))).execute().actionGet()-->Line_5 $$ InternalHistogram<Bucket> deriv = searchResponse.getAggregations().get("histo")[ FD ]
Line_19 $$ SimpleValue sumDeriv = bucket.getAggregations().get("deriv")-->Line_27 $$ assertThat(sumDeriv.value(), closeTo(expectedDerivative, 0.00001))[ FD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_9 $$ assertThat(buckets.size(), equalTo(valueCounts_empty.length))[ CD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_13 $$ checkBucketKeyAndDocCount("InternalBucket " + i, bucket, i, valueCounts_empty[i])[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_16 $$ if (bucket.getDocCount() == 0) [ CD ]
Line_3 $$ SearchResponse searchResponse = client().prepareSearch("empty_bucket_idx").setQuery(matchAllQuery()).addAggregation(histogram("histo").field(SINGLE_VALUED_FIELD_NAME).interval(1).subAggregation(sum("sum").field(SINGLE_VALUED_FIELD_NAME)).subAggregation(derivative("deriv").setBucketsPaths("sum"))).execute().actionGet()-->Line_4 $$ assertThat(searchResponse.getHits().getTotalHits(), equalTo(numDocsEmptyIdx))[ FD ]
Line_5 $$ InternalHistogram<Bucket> deriv = searchResponse.getAggregations().get("histo")-->Line_6 $$ assertThat(deriv, Matchers.notNullValue())[ FD ]
Line_5 $$ InternalHistogram<Bucket> deriv = searchResponse.getAggregations().get("histo")-->Line_7 $$ assertThat(deriv.getName(), equalTo("histo"))[ FD ]
Line_24 $$ if (Double.isNaN(expectedDerivative)) -->Line_25 $$ assertThat(sumDeriv.value(), equalTo(expectedDerivative))[ CD ]
Line_23 $$ double expectedDerivative = thisSumValue - lastSumValue-->Line_27 $$ assertThat(sumDeriv.value(), closeTo(expectedDerivative, 0.00001))[ FD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_3 $$ SearchResponse searchResponse = client().prepareSearch("empty_bucket_idx").setQuery(matchAllQuery()).addAggregation(histogram("histo").field(SINGLE_VALUED_FIELD_NAME).interval(1).subAggregation(sum("sum").field(SINGLE_VALUED_FIELD_NAME)).subAggregation(derivative("deriv").setBucketsPaths("sum"))).execute().actionGet()[ CD ]
Line_12 $$ Histogram.Bucket bucket = buckets.get(i)-->Line_13 $$ checkBucketKeyAndDocCount("InternalBucket " + i, bucket, i, valueCounts_empty[i])[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_14 $$ Sum sum = bucket.getAggregations().get("sum")[ CD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_6 $$ assertThat(deriv, Matchers.notNullValue())[ CD ]
Line_17 $$ thisSumValue = Double.NaN-->Line_30 $$ lastSumValue = thisSumValue[ FD ]
Line_15 $$ double thisSumValue = sum.value()-->Line_17 $$ thisSumValue = Double.NaN[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_20 $$ if (i == 0) [ CD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_13 $$ checkBucketKeyAndDocCount("InternalBucket " + i, bucket, i, valueCounts_empty[i])[ CD ]
Line_19 $$ SimpleValue sumDeriv = bucket.getAggregations().get("deriv")-->Line_25 $$ assertThat(sumDeriv.value(), equalTo(expectedDerivative))[ FD ]
Line_15 $$ double thisSumValue = sum.value()-->Line_30 $$ lastSumValue = thisSumValue[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_30 $$ lastSumValue = thisSumValue[ CD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_4 $$ assertThat(searchResponse.getHits().getTotalHits(), equalTo(numDocsEmptyIdx))[ CD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_15 $$ double thisSumValue = sum.value()[ CD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_12 $$ Histogram.Bucket bucket = buckets.get(i)[ CD ]
Line_5 $$ InternalHistogram<Bucket> deriv = searchResponse.getAggregations().get("histo")-->Line_8 $$ List<Bucket> buckets = deriv.getBuckets()[ FD ]
Line_20 $$ if (i == 0) -->Line_24 $$ if (Double.isNaN(expectedDerivative)) [ CD ]
Line_24 $$ if (Double.isNaN(expectedDerivative)) -->Line_27 $$ assertThat(sumDeriv.value(), closeTo(expectedDerivative, 0.00001))[ CD ]
Line_23 $$ double expectedDerivative = thisSumValue - lastSumValue-->Line_24 $$ if (Double.isNaN(expectedDerivative)) [ FD ]
Line_12 $$ Histogram.Bucket bucket = buckets.get(i)-->Line_16 $$ if (bucket.getDocCount() == 0) [ FD ]
Line_12 $$ Histogram.Bucket bucket = buckets.get(i)-->Line_19 $$ SimpleValue sumDeriv = bucket.getAggregations().get("deriv")[ FD ]
Line_8 $$ List<Bucket> buckets = deriv.getBuckets()-->Line_9 $$ assertThat(buckets.size(), equalTo(valueCounts_empty.length))[ FD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_7 $$ assertThat(deriv.getName(), equalTo("histo"))[ CD ]
Line_20 $$ if (i == 0) -->Line_21 $$ assertThat(sumDeriv, nullValue())[ CD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_8 $$ List<Bucket> buckets = deriv.getBuckets()[ CD ]
Line_10 $$ double lastSumValue = Double.NaN-->Line_30 $$ lastSumValue = thisSumValue[ FD ]
Line_16 $$ if (bucket.getDocCount() == 0) -->Line_17 $$ thisSumValue = Double.NaN[ CD ]
Line_20 $$ if (i == 0) -->Line_23 $$ double expectedDerivative = thisSumValue - lastSumValue[ CD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_5 $$ InternalHistogram<Bucket> deriv = searchResponse.getAggregations().get("histo")[ CD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) [ CD ]
Line_23 $$ double expectedDerivative = thisSumValue - lastSumValue-->Line_25 $$ assertThat(sumDeriv.value(), equalTo(expectedDerivative))[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_12 $$ Histogram.Bucket bucket = buckets.get(i)[ FD ]
Line_8 $$ List<Bucket> buckets = deriv.getBuckets()-->Line_12 $$ Histogram.Bucket bucket = buckets.get(i)[ FD ]
Line_2 $$ public void testSingleValueAggDerivativeWithGaps() throws Exception -->Line_10 $$ double lastSumValue = Double.NaN[ CD ]
Line_12 $$ Histogram.Bucket bucket = buckets.get(i)-->Line_14 $$ Sum sum = bucket.getAggregations().get("sum")[ FD ]
Line_11 $$ for (int i = 0; i < valueCounts_empty.length; i++) -->Line_19 $$ SimpleValue sumDeriv = bucket.getAggregations().get("deriv")[ CD ]
Line_14 $$ Sum sum = bucket.getAggregations().get("sum")-->Line_15 $$ double thisSumValue = sum.value()[ FD ]
Line_19 $$ SimpleValue sumDeriv = bucket.getAggregations().get("deriv")-->Line_21 $$ assertThat(sumDeriv, nullValue())[ FD ]
