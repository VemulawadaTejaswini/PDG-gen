Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_61 $$ cluster.shutdown()[ FD ]
Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_14 $$ cluster.waitActive()[ FD ]
Line_10 $$ FileSystem fileSys = null-->Line_58 $$ if (fileSys != null)[ FD ]
Line_27 $$ for (int i = 0; i < NUM_THREADS; i++) -->Line_29 $$ threadId[i] = new Thread(trans, "TransactionThread-" + i)[ CD ]
Line_50 $$ for (StorageDirectory sd : fsimage.getStorage().dirIterable(NameNodeDirType.EDITS)) -->Line_51 $$ File editFile = NNStorage.getFinalizedEditsFile(sd, 1, 1 + expectedTransactions - 1)[ FD ]
Line_21 $$ FSImage fsimage = namesystem.getFSImage()-->Line_50 $$ for (StorageDirectory sd : fsimage.getStorage().dirIterable(NameNodeDirType.EDITS)) [ FD ]
Line_27 $$ for (int i = 0; i < NUM_THREADS; i++) -->Line_30 $$ threadId[i].start()[ CD ]
Line_60 $$ if (cluster != null)-->Line_61 $$ cluster.shutdown()[ CD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_61 $$ cluster.shutdown()[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_16 $$ final FSNamesystem namesystem = cluster.getNamesystem()[ FD ]
Line_17 $$ for (Iterator<URI> it = cluster.getNameDirs(0).iterator(); it.hasNext(); ) -->Line_18 $$ File dir = new File(it.next().getPath())[ CD ]
Line_15 $$ fileSys = cluster.getFileSystem()-->Line_59 $$ fileSys.close()[ FD ]
Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_16 $$ final FSNamesystem namesystem = cluster.getNamesystem()[ FD ]
Line_27 $$ for (int i = 0; i < NUM_THREADS; i++) -->Line_38 $$ i--[ FD ]
Line_21 $$ FSImage fsimage = namesystem.getFSImage()-->Line_22 $$ FSEditLog editLog = fsimage.getEditLog()[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_17 $$ for (Iterator<URI> it = cluster.getNameDirs(0).iterator(); it.hasNext(); ) [ FD ]
Line_17 $$ for (Iterator<URI> it = cluster.getNameDirs(0).iterator(); it.hasNext(); ) -->Line_18 $$ File dir = new File(it.next().getPath())[ FD ]
Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_15 $$ fileSys = cluster.getFileSystem()[ FD ]
Line_22 $$ FSEditLog editLog = fsimage.getEditLog()-->Line_41 $$ editLog.close()[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_60 $$ if (cluster != null)[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()[ FD ]
Line_27 $$ for (int i = 0; i < NUM_THREADS; i++) -->Line_28 $$ Transactions trans = new Transactions(namesystem, NUM_TRANSACTIONS)[ CD ]
Line_10 $$ FileSystem fileSys = null-->Line_15 $$ fileSys = cluster.getFileSystem()[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_14 $$ cluster.waitActive()[ FD ]
Line_18 $$ File dir = new File(it.next().getPath())-->Line_19 $$ System.out.println(dir)[ FD ]
Line_9 $$ MiniDFSCluster cluster = null-->Line_15 $$ fileSys = cluster.getFileSystem()[ FD ]
Line_16 $$ final FSNamesystem namesystem = cluster.getNamesystem()-->Line_47 $$ int numKeys = namesystem.getDelegationTokenSecretManager().getNumberOfKeys()[ FD ]
Line_54 $$ long numEdits = loader.loadFSEdits(new EditLogFileInputStream(editFile), 1)-->Line_55 $$ assertEquals("Verification for " + editFile, expectedTransactions, numEdits)[ FD ]
Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_17 $$ for (Iterator<URI> it = cluster.getNameDirs(0).iterator(); it.hasNext(); ) [ FD ]
Line_53 $$ FSEditLogLoader loader = new FSEditLogLoader(namesystem, 0)-->Line_54 $$ long numEdits = loader.loadFSEdits(new EditLogFileInputStream(editFile), 1)[ FD ]
Line_10 $$ FileSystem fileSys = null-->Line_59 $$ fileSys.close()[ FD ]
Line_15 $$ fileSys = cluster.getFileSystem()-->Line_58 $$ if (fileSys != null)[ FD ]
Line_16 $$ final FSNamesystem namesystem = cluster.getNamesystem()-->Line_21 $$ FSImage fsimage = namesystem.getFSImage()[ FD ]
Line_58 $$ if (fileSys != null)-->Line_59 $$ fileSys.close()[ CD ]
Line_17 $$ for (Iterator<URI> it = cluster.getNameDirs(0).iterator(); it.hasNext(); ) -->Line_19 $$ System.out.println(dir)[ CD ]
Line_13 $$ cluster = new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build()-->Line_60 $$ if (cluster != null)[ FD ]
Line_48 $$ int expectedTransactions = // + 2 for BEGIN and END txns-->Line_55 $$ assertEquals("Verification for " + editFile, expectedTransactions, numEdits)[ FD ]
