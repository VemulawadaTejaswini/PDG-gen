Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_21 $$ if (!parentToChildren.containsKey(previousParentId)) [ CD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_28 $$ for (Map.Entry<String, Set<String>> parentToChildrenEntry : parentToChildren.entrySet()) [ FD ]
Line_9 $$ String previousParentId = null-->Line_22 $$ parentToChildren.put(previousParentId, new HashSet<String>())[ FD ]
Line_10 $$ int numChildDocs = 32-->Line_13 $$ for (int i = 1; i <= numChildDocs; i++) [ FD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_24 $$ assertThat(parentToChildren.get(previousParentId).add(childId), is(true))[ CD ]
Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()-->Line_30 $$ assertNoFailures(searchResponse)[ FD ]
Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) -->Line_34 $$ assertThat(childIds.remove(searchResponse.getHits().getAt(i).id()), is(true))[ CD ]
Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()-->Line_35 $$ assertThat(searchResponse.getHits().getAt(i).score(), is(1.0f))[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_9 $$ String previousParentId = null[ CD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_19 $$ String childId = "c" + i[ CD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_21 $$ if (!parentToChildren.containsKey(previousParentId)) [ FD ]
Line_21 $$ if (!parentToChildren.containsKey(previousParentId)) -->Line_22 $$ parentToChildren.put(previousParentId, new HashSet<String>())[ CD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_24 $$ assertThat(parentToChildren.get(previousParentId).add(childId), is(true))[ FD ]
Line_14 $$ if (previousParentId == null || i % numChildDocsPerParent == 0) -->Line_17 $$ numChildDocsPerParent++[ CD ]
Line_15 $$ previousParentId = "p" + i-->Line_21 $$ if (!parentToChildren.containsKey(previousParentId)) [ FD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_14 $$ if (previousParentId == null || i % numChildDocsPerParent == 0) [ CD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_26 $$ indexRandom(true, builders.toArray(new IndexRequestBuilder[builders.size()]))[ CD ]
Line_28 $$ for (Map.Entry<String, Set<String>> parentToChildrenEntry : parentToChildren.entrySet()) -->Line_31 $$ Set<String> childIds = parentToChildrenEntry.getValue()[ FD ]
Line_31 $$ Set<String> childIds = parentToChildrenEntry.getValue()-->Line_34 $$ assertThat(childIds.remove(searchResponse.getHits().getAt(i).id()), is(true))[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_8 $$ parentToChildren.put("p0", new HashSet<String>())[ CD ]
Line_15 $$ previousParentId = "p" + i-->Line_16 $$ builders.add(client().prepareIndex("test", "parent", previousParentId).setSource("p_field", previousParentId))[ FD ]
Line_9 $$ String previousParentId = null-->Line_16 $$ builders.add(client().prepareIndex("test", "parent", previousParentId).setSource("p_field", previousParentId))[ FD ]
Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()-->Line_32 $$ assertThat(searchResponse.getHits().totalHits(), equalTo((long) childIds.size()))[ FD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_22 $$ parentToChildren.put(previousParentId, new HashSet<String>())[ FD ]
Line_14 $$ if (previousParentId == null || i % numChildDocsPerParent == 0) -->Line_15 $$ previousParentId = "p" + i[ CD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_34 $$ assertThat(childIds.remove(searchResponse.getHits().getAt(i).id()), is(true))[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()[ CD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_15 $$ previousParentId = "p" + i[ FD ]
Line_15 $$ previousParentId = "p" + i-->Line_22 $$ parentToChildren.put(previousParentId, new HashSet<String>())[ FD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_35 $$ assertThat(searchResponse.getHits().getAt(i).score(), is(1.0f))[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_11 $$ int numChildDocsPerParent = 0[ CD ]
Line_11 $$ int numChildDocsPerParent = 0-->Line_17 $$ numChildDocsPerParent++[ FD ]
Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) -->Line_35 $$ assertThat(searchResponse.getHits().getAt(i).score(), is(1.0f))[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_13 $$ for (int i = 1; i <= numChildDocs; i++) [ CD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) [ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_4 $$ ensureGreen()[ CD ]
Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) -->Line_35 $$ assertThat(searchResponse.getHits().getAt(i).score(), is(1.0f))[ CD ]
Line_13 $$ for (int i = 1; i <= numChildDocs; i++) -->Line_20 $$ builders.add(client().prepareIndex("test", "child", childId).setSource("c_field", childId).setParent(previousParentId))[ CD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_3 $$ assertAcked(prepareCreate("test").addMapping("parent").addMapping("child", "_parent", "type=parent"))[ CD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_27 $$ assertThat(parentToChildren.isEmpty(), equalTo(false))[ CD ]
Line_28 $$ for (Map.Entry<String, Set<String>> parentToChildrenEntry : parentToChildren.entrySet()) -->Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_10 $$ int numChildDocs = 32[ CD ]
Line_9 $$ String previousParentId = null-->Line_24 $$ assertThat(parentToChildren.get(previousParentId).add(childId), is(true))[ FD ]
Line_19 $$ String childId = "c" + i-->Line_24 $$ assertThat(parentToChildren.get(previousParentId).add(childId), is(true))[ FD ]
Line_31 $$ Set<String> childIds = parentToChildrenEntry.getValue()-->Line_37 $$ assertThat(childIds.size(), is(0))[ FD ]
Line_19 $$ String childId = "c" + i-->Line_20 $$ builders.add(client().prepareIndex("test", "child", childId).setSource("c_field", childId).setParent(previousParentId))[ FD ]
Line_11 $$ int numChildDocsPerParent = 0-->Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()[ FD ]
Line_15 $$ previousParentId = "p" + i-->Line_24 $$ assertThat(parentToChildren.get(previousParentId).add(childId), is(true))[ FD ]
Line_9 $$ String previousParentId = null-->Line_20 $$ builders.add(client().prepareIndex("test", "child", childId).setSource("c_field", childId).setParent(previousParentId))[ FD ]
Line_14 $$ if (previousParentId == null || i % numChildDocsPerParent == 0) -->Line_16 $$ builders.add(client().prepareIndex("test", "parent", previousParentId).setSource("p_field", previousParentId))[ CD ]
Line_9 $$ String previousParentId = null-->Line_21 $$ if (!parentToChildren.containsKey(previousParentId)) [ FD ]
Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()-->Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) [ FD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_27 $$ assertThat(parentToChildren.isEmpty(), equalTo(false))[ FD ]
Line_12 $$ List<IndexRequestBuilder> builders = new ArrayList()-->Line_16 $$ builders.add(client().prepareIndex("test", "parent", previousParentId).setSource("p_field", previousParentId))[ FD ]
Line_31 $$ Set<String> childIds = parentToChildrenEntry.getValue()-->Line_32 $$ assertThat(searchResponse.getHits().totalHits(), equalTo((long) childIds.size()))[ FD ]
Line_15 $$ previousParentId = "p" + i-->Line_20 $$ builders.add(client().prepareIndex("test", "child", childId).setSource("c_field", childId).setParent(previousParentId))[ FD ]
Line_12 $$ List<IndexRequestBuilder> builders = new ArrayList()-->Line_20 $$ builders.add(client().prepareIndex("test", "child", childId).setSource("c_field", childId).setParent(previousParentId))[ FD ]
Line_5 $$ Map<String, Set<String>> parentToChildren = new HashMap()-->Line_8 $$ parentToChildren.put("p0", new HashSet<String>())[ FD ]
Line_2 $$ public void testHasParentFilter() throws Exception -->Line_12 $$ List<IndexRequestBuilder> builders = new ArrayList()[ CD ]
Line_33 $$ for (int i = 0; i < searchResponse.getHits().totalHits(); i++) -->Line_34 $$ assertThat(childIds.remove(searchResponse.getHits().getAt(i).id()), is(true))[ FD ]
Line_29 $$ SearchResponse searchResponse = client().prepareSearch("test").setQuery(constantScoreQuery(hasParentQuery("parent", termQuery("p_field", parentToChildrenEntry.getKey())))).setSize(numChildDocsPerParent).get()-->Line_34 $$ assertThat(childIds.remove(searchResponse.getHits().getAt(i).id()), is(true))[ FD ]
Line_12 $$ List<IndexRequestBuilder> builders = new ArrayList()-->Line_26 $$ indexRandom(true, builders.toArray(new IndexRequestBuilder[builders.size()]))[ FD ]
Line_9 $$ String previousParentId = null-->Line_15 $$ previousParentId = "p" + i[ FD ]
