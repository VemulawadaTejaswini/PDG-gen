Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))[ CD ]
Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_15 $$ Iterables.addAll(explicitColumnOrder, filter(columnNames, not(in(explicitColumnOrder))))[ CD ]
Line_13 $$ List<String> explicitColumnOrder = new ArrayList(ImmutableList.copyOf(transform(extras, ExtraColumnMetadata::<>getName)))-->Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)[ FD ]
Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_11 $$ String columnOrderingString = comment.substring(PRESTO_COMMENT_METADATA.length())[ CD ]
Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))-->Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_29 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, true, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_18 $$ ImmutableList.Builder<CassandraColumnHandle> columnHandles = ImmutableList.builder()[ CD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_33 $$ if (!primaryKeySet.contains(columnMeta.getName())) [ FD ]
Line_33 $$ if (!primaryKeySet.contains(columnMeta.getName())) -->Line_36 $$ columnHandles.add(columnHandle)[ CD ]
Line_18 $$ ImmutableList.Builder<CassandraColumnHandle> columnHandles = ImmutableList.builder()-->Line_36 $$ columnHandles.add(columnHandle)[ FD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_8 $$ String comment = tableMeta.getOptions().getComment()[ FD ]
Line_8 $$ String comment = tableMeta.getOptions().getComment()-->Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) [ FD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_21 $$ primaryKeySet.add(columnMeta.getName())[ FD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_26 $$ for (ColumnMetadata columnMeta : tableMeta.getClusteringColumns()) [ FD ]
Line_12 $$ List<ExtraColumnMetadata> extras = extraColumnMetadataCodec.fromJson(columnOrderingString)-->Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))[ FD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_8 $$ String comment = tableMeta.getOptions().getComment()-->Line_11 $$ String columnOrderingString = comment.substring(PRESTO_COMMENT_METADATA.length())[ FD ]
Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)-->Line_35 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_18 $$ ImmutableList.Builder<CassandraColumnHandle> columnHandles = ImmutableList.builder()-->Line_39 $$ List<CassandraColumnHandle> sortedColumnHandles = columnHandles.build().stream().sorted(comparing(CassandraColumnHandle::<>getOrdinalPosition)).collect(toList())[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)[ FD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_32 $$ for (ColumnMetadata columnMeta : tableMeta.getColumns()) [ FD ]
Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())-->Line_35 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_40 $$ CassandraTableHandle tableHandle = new CassandraTableHandle(connectorId, tableMeta.getKeyspace().getName(), tableMeta.getName())[ FD ]
Line_33 $$ if (!primaryKeySet.contains(columnMeta.getName())) -->Line_35 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, false, columnNames.indexOf(columnMeta.getName()), hidden)[ CD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_5 $$ for (ColumnMetadata columnMetadata : tableMeta.getColumns()) -->Line_6 $$ columnNames.add(columnMetadata.getName())[ FD ]
Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)-->Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_33 $$ if (!primaryKeySet.contains(columnMeta.getName())) -->Line_34 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ CD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_41 $$ return new CassandraTable(tableHandle, sortedColumnHandles)[ CD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_5 $$ for (ColumnMetadata columnMetadata : tableMeta.getColumns()) [ FD ]
Line_19 $$ Set<String> primaryKeySet = new HashSet()-->Line_21 $$ primaryKeySet.add(columnMeta.getName())[ FD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_29 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, true, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_35 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)[ CD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)[ FD ]
Line_9 $$ Set<String> hiddenColumns = ImmutableSet.of()-->Line_34 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_13 $$ List<String> explicitColumnOrder = new ArrayList(ImmutableList.copyOf(transform(extras, ExtraColumnMetadata::<>getName)))-->Line_15 $$ Iterables.addAll(explicitColumnOrder, filter(columnNames, not(in(explicitColumnOrder))))[ FD ]
Line_18 $$ ImmutableList.Builder<CassandraColumnHandle> columnHandles = ImmutableList.builder()-->Line_30 $$ columnHandles.add(columnHandle)[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_39 $$ List<CassandraColumnHandle> sortedColumnHandles = columnHandles.build().stream().sorted(comparing(CassandraColumnHandle::<>getOrdinalPosition)).collect(toList())[ CD ]
Line_11 $$ String columnOrderingString = comment.substring(PRESTO_COMMENT_METADATA.length())-->Line_12 $$ List<ExtraColumnMetadata> extras = extraColumnMetadataCodec.fromJson(columnOrderingString)[ FD ]
Line_9 $$ Set<String> hiddenColumns = ImmutableSet.of()-->Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))[ FD ]
Line_9 $$ Set<String> hiddenColumns = ImmutableSet.of()-->Line_28 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)-->Line_29 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, true, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) [ CD ]
Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)-->Line_36 $$ columnHandles.add(columnHandle)[ FD ]
Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())-->Line_29 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, true, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_34 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_13 $$ List<String> explicitColumnOrder = new ArrayList(ImmutableList.copyOf(transform(extras, ExtraColumnMetadata::<>getName)))[ CD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_19 $$ Set<String> primaryKeySet = new HashSet()[ CD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_35 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, false, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_9 $$ Set<String> hiddenColumns = ImmutableSet.of()[ CD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_6 $$ columnNames.add(columnMetadata.getName())[ FD ]
Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)-->Line_24 $$ columnHandles.add(columnHandle)[ FD ]
Line_19 $$ Set<String> primaryKeySet = new HashSet()-->Line_33 $$ if (!primaryKeySet.contains(columnMeta.getName())) [ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_8 $$ String comment = tableMeta.getOptions().getComment()[ CD ]
Line_18 $$ ImmutableList.Builder<CassandraColumnHandle> columnHandles = ImmutableList.builder()-->Line_24 $$ columnHandles.add(columnHandle)[ FD ]
Line_4 $$ List<String> columnNames = new ArrayList()-->Line_15 $$ Iterables.addAll(explicitColumnOrder, filter(columnNames, not(in(explicitColumnOrder))))[ FD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_4 $$ List<String> columnNames = new ArrayList()[ CD ]
Line_2 $$ public CassandraTable getTable(SchemaTableName tableName) throws TableNotFoundException -->Line_40 $$ CassandraTableHandle tableHandle = new CassandraTableHandle(connectorId, tableMeta.getKeyspace().getName(), tableMeta.getName())[ CD ]
Line_3 $$ TableMetadata tableMeta = getTableMetadata(tableName)-->Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) [ FD ]
Line_19 $$ Set<String> primaryKeySet = new HashSet()-->Line_27 $$ primaryKeySet.add(columnMeta.getName())[ FD ]
Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_16 $$ columnNames = Ordering.explicit(explicitColumnOrder).sortedCopy(columnNames)[ CD ]
Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())-->Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)[ FD ]
Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))-->Line_34 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_23 $$ CassandraColumnHandle columnHandle = buildColumnHandle(columnMeta, true, false, columnNames.indexOf(columnMeta.getName()), hidden)-->Line_30 $$ columnHandles.add(columnHandle)[ FD ]
Line_14 $$ hiddenColumns = ImmutableSet.copyOf(transform(filter(extras, ExtraColumnMetadata::<>isHidden), ExtraColumnMetadata::<>getName))-->Line_28 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_9 $$ Set<String> hiddenColumns = ImmutableSet.of()-->Line_22 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_28 $$ boolean hidden = hiddenColumns.contains(columnMeta.getName())[ FD ]
Line_12 $$ List<ExtraColumnMetadata> extras = extraColumnMetadataCodec.fromJson(columnOrderingString)-->Line_13 $$ List<String> explicitColumnOrder = new ArrayList(ImmutableList.copyOf(transform(extras, ExtraColumnMetadata::<>getName)))[ FD ]
Line_10 $$ if (comment != null && comment.startsWith(PRESTO_COMMENT_METADATA)) -->Line_12 $$ List<ExtraColumnMetadata> extras = extraColumnMetadataCodec.fromJson(columnOrderingString)[ CD ]
Line_20 $$ for (ColumnMetadata columnMeta : tableMeta.getPartitionKey()) -->Line_27 $$ primaryKeySet.add(columnMeta.getName())[ FD ]
