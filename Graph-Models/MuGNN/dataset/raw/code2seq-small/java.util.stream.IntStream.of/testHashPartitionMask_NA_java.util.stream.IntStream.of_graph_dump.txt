Line_7 $$ int[] rowPartition = new int[ROW_COUNT]-->Line_26 $$ assertTrue(IntStream.of(rowPartition).noneMatch( partition -> partition == -1))[ FD ]
Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)-->Line_16 $$ rawHash &= Integer.MAX_VALUE[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_17 $$ boolean active = (rawHash % PARTITION_COUNT == partition)[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)[ FD ]
Line_4 $$ RowPagesBuilder rowPagesBuilder = rowPagesBuilder(hashEnabled, Ints.asList(0), BIGINT)-->Line_6 $$ OperatorFactory operatorFactory = new HashPartitionMaskOperatorFactory(0, PARTITION_COUNT, rowPagesBuilder.getTypes(), ImmutableList.of(), ImmutableList.of(0), rowPagesBuilder.getHashChannel())[ FD ]
Line_6 $$ OperatorFactory operatorFactory = new HashPartitionMaskOperatorFactory(0, PARTITION_COUNT, rowPagesBuilder.getTypes(), ImmutableList.of(), ImmutableList.of(0), rowPagesBuilder.getHashChannel())-->Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())[ FD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) [ CD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN)[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_18 $$ expected.row(i, active)[ FD ]
Line_19 $$ if (active) -->Line_20 $$ assertEquals(rowPartition[i], -1)[ CD ]
Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())-->Line_24 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(1))[ FD ]
Line_7 $$ int[] rowPartition = new int[ROW_COUNT]-->Line_8 $$ Arrays.fill(rowPartition, -1)[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_18 $$ expected.row(i, active)[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_16 $$ rawHash &= Integer.MAX_VALUE[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_19 $$ if (active) [ CD ]
Line_19 $$ if (active) -->Line_21 $$ rowPartition[i] = partition[ CD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())[ CD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_24 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(1))[ CD ]
Line_4 $$ RowPagesBuilder rowPagesBuilder = rowPagesBuilder(hashEnabled, Ints.asList(0), BIGINT)-->Line_5 $$ List<Page> input = rowPagesBuilder.addSequencePage(ROW_COUNT, 0).build()[ FD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_21 $$ rowPartition[i] = partition[ FD ]
Line_5 $$ List<Page> input = rowPagesBuilder.addSequencePage(ROW_COUNT, 0).build()-->Line_24 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(1))[ FD ]
Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN)-->Line_18 $$ expected.row(i, active)[ FD ]
Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN)-->Line_24 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(1))[ FD ]
Line_17 $$ boolean active = (rawHash % PARTITION_COUNT == partition)-->Line_18 $$ expected.row(i, active)[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)[ CD ]
