Line_20 $$ if (active) -->Line_22 $$ rowPartition[i] = partition[ CD ]
Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)-->Line_16 $$ rawHash &= Integer.MAX_VALUE[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_17 $$ boolean active = (rawHash % PARTITION_COUNT == partition)[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_20 $$ if (active) [ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)[ FD ]
Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())-->Line_25 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(3))[ FD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_25 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(3))[ CD ]
Line_4 $$ RowPagesBuilder rowPagesBuilder = rowPagesBuilder(hashEnabled, Ints.asList(0), BIGINT, BOOLEAN, BOOLEAN)-->Line_5 $$ List<Page> input = rowPagesBuilder.addSequencePage(ROW_COUNT, 0, 0, 1).build()[ FD ]
Line_18 $$ boolean maskValue = i % 2 == 0-->Line_19 $$ expected.row(i, active && maskValue, active && !maskValue, active)[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_18 $$ boolean maskValue = i % 2 == 0[ CD ]
Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN, BOOLEAN, BOOLEAN)-->Line_25 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(3))[ FD ]
Line_17 $$ boolean active = (rawHash % PARTITION_COUNT == partition)-->Line_19 $$ expected.row(i, active && maskValue, active && !maskValue, active)[ FD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) [ CD ]
Line_6 $$ OperatorFactory operatorFactory = new HashPartitionMaskOperatorFactory(0, PARTITION_COUNT, rowPagesBuilder.getTypes(), ImmutableList.of(1, 2), ImmutableList.of(0), rowPagesBuilder.getHashChannel())-->Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())[ FD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN, BOOLEAN, BOOLEAN)[ CD ]
Line_5 $$ List<Page> input = rowPagesBuilder.addSequencePage(ROW_COUNT, 0, 0, 1).build()-->Line_25 $$ OperatorAssertion.assertOperatorEqualsIgnoreOrder(operator, input, expected.build(), hashEnabled, Optional.of(3))[ FD ]
Line_7 $$ int[] rowPartition = new int[ROW_COUNT]-->Line_8 $$ Arrays.fill(rowPartition, -1)[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_19 $$ expected.row(i, active && maskValue, active && !maskValue, active)[ FD ]
Line_7 $$ int[] rowPartition = new int[ROW_COUNT]-->Line_27 $$ assertTrue(IntStream.of(rowPartition).noneMatch( partition -> partition == -1))[ FD ]
Line_20 $$ if (active) -->Line_21 $$ assertEquals(rowPartition[i], -1)[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_16 $$ rawHash &= Integer.MAX_VALUE[ CD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_19 $$ expected.row(i, active && maskValue, active && !maskValue, active)[ CD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_10 $$ Operator operator = operatorFactory.createOperator(createDriverContext())[ CD ]
Line_9 $$ for (int partition = 0; partition < PARTITION_COUNT; partition++) -->Line_22 $$ rowPartition[i] = partition[ FD ]
Line_12 $$ for (int i = 0; i < ROW_COUNT; i++) -->Line_13 $$ int rawHash = (int) BigintOperators.hashCode(i)[ CD ]
Line_11 $$ MaterializedResult.Builder expected = resultBuilder(TEST_SESSION, BIGINT, BOOLEAN, BOOLEAN, BOOLEAN)-->Line_19 $$ expected.row(i, active && maskValue, active && !maskValue, active)[ FD ]
Line_4 $$ RowPagesBuilder rowPagesBuilder = rowPagesBuilder(hashEnabled, Ints.asList(0), BIGINT, BOOLEAN, BOOLEAN)-->Line_6 $$ OperatorFactory operatorFactory = new HashPartitionMaskOperatorFactory(0, PARTITION_COUNT, rowPagesBuilder.getTypes(), ImmutableList.of(1, 2), ImmutableList.of(0), rowPagesBuilder.getHashChannel())[ FD ]
