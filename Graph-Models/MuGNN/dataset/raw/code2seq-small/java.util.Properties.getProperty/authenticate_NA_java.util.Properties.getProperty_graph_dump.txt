Line_26 $$ String errorMessage = ldapAuthResult.getErrorMessage()-->Line_27 $$ if (errorMessage != null) [ FD ]
Line_21 $$ SearchResult result = enu.nextElement()-->Line_22 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ FD ]
Line_13 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))-->Line_14 $$ userMappingsScreenName = StringUtil.toLowerCase(userMappingsScreenName)[ FD ]
Line_10 $$ String baseDN = ldapServerConfiguration.baseDN()-->Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_11 $$ String filter = _ldapSettings.getAuthSearchFilter(ldapServerId, companyId, emailAddress, screenName, String.valueOf(userId))[ FD ]
Line_27 $$ if (errorMessage != null) -->Line_33 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_61 $$ if (ldapContext != null) [ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_41 $$ String resultCode = ldapAuthResult.getResponseControl()[ CD ]
Line_9 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)-->Line_10 $$ String baseDN = ldapServerConfiguration.baseDN()[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_49 $$ return DNE[ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ FD ]
Line_61 $$ if (ldapContext != null) -->Line_62 $$ ldapContext.close()[ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_58 $$ if (enu != null) [ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_9 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_18 $$ if (_log.isDebugEnabled()) [ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_59 $$ enu.close()[ FD ]
Line_18 $$ if (_log.isDebugEnabled()) -->Line_19 $$ _log.debug("Search filter returned at least one result")[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ CD ]
Line_27 $$ if (errorMessage != null) -->Line_28 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ CD ]
Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)-->Line_24 $$ User user = _ldapUserImporter.importUser(ldapServerId, companyId, ldapContext, attributes, password)[ FD ]
Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_30 $$ if (pos != -1) [ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_22 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_12 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_24 $$ User user = _ldapUserImporter.importUser(ldapServerId, companyId, ldapContext, attributes, password)[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_24 $$ User user = _ldapUserImporter.importUser(ldapServerId, companyId, ldapContext, attributes, password)[ FD ]
Line_28 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)-->Line_33 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ FD ]
Line_22 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)-->Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_21 $$ SearchResult result = enu.nextElement()[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_7 $$ NamingEnumeration<SearchResult> enu = null[ CD ]
Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)-->Line_38 $$ if (!ldapAuthResult.isAuthenticated()) [ FD ]
Line_11 $$ String filter = _ldapSettings.getAuthSearchFilter(ldapServerId, companyId, emailAddress, screenName, String.valueOf(userId))-->Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_34 $$ if (pos != -1) [ FD ]
Line_46 $$ if (_log.isDebugEnabled()) -->Line_47 $$ _log.debug("Search filter did not return any results")[ CD ]
Line_28 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)-->Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())[ FD ]
Line_27 $$ if (errorMessage != null) -->Line_30 $$ if (pos != -1) [ CD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_21 $$ SearchResult result = enu.nextElement()[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_38 $$ if (!ldapAuthResult.isAuthenticated()) -->Line_39 $$ return FAILURE[ CD ]
Line_41 $$ String resultCode = ldapAuthResult.getResponseControl()-->Line_42 $$ if (resultCode.equals(LDAPAuth.RESULT_PASSWORD_RESET)) [ FD ]
Line_58 $$ if (enu != null) -->Line_59 $$ enu.close()[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_4 $$ if (ldapContext == null) [ CD ]
Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_21 $$ SearchResult result = enu.nextElement()[ FD ]
Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)-->Line_26 $$ String errorMessage = ldapAuthResult.getErrorMessage()[ FD ]
Line_27 $$ if (errorMessage != null) -->Line_34 $$ if (pos != -1) [ CD ]
Line_42 $$ if (resultCode.equals(LDAPAuth.RESULT_PASSWORD_RESET)) -->Line_43 $$ _userLocalService.updatePasswordReset(user.getUserId(), true)[ CD ]
Line_24 $$ User user = _ldapUserImporter.importUser(ldapServerId, companyId, ldapContext, attributes, password)-->Line_43 $$ _userLocalService.updatePasswordReset(user.getUserId(), true)[ FD ]
Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)-->Line_41 $$ String resultCode = ldapAuthResult.getResponseControl()[ FD ]
Line_22 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)-->Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_65 $$ return SUCCESS[ CD ]
Line_26 $$ String errorMessage = ldapAuthResult.getErrorMessage()-->Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())[ FD ]
Line_26 $$ String errorMessage = ldapAuthResult.getErrorMessage()-->Line_33 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ FD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_4 $$ if (ldapContext == null) [ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_46 $$ if (_log.isDebugEnabled()) [ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_22 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ CD ]
Line_33 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())-->Line_34 $$ if (pos != -1) [ FD ]
Line_12 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)-->Line_13 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))[ FD ]
Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_33 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_42 $$ if (resultCode.equals(LDAPAuth.RESULT_PASSWORD_RESET)) [ CD ]
Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_59 $$ enu.close()[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_26 $$ String errorMessage = ldapAuthResult.getErrorMessage()[ CD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_27 $$ if (errorMessage != null) [ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_28 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ FD ]
Line_27 $$ if (errorMessage != null) -->Line_29 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())[ CD ]
Line_15 $$ SearchControls searchControls = new SearchControls(SearchControls.SUBTREE_SCOPE, 1, 0, new String[] -->Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_17 $$ if (enu.hasMoreElements()) [ FD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_4 $$ if (ldapContext == null) -->Line_5 $$ return FAILURE[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_24 $$ User user = _ldapUserImporter.importUser(ldapServerId, companyId, ldapContext, attributes, password)[ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_38 $$ if (!ldapAuthResult.isAuthenticated()) [ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_17 $$ if (enu.hasMoreElements()) [ FD ]
Line_17 $$ if (enu.hasMoreElements()) -->Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_62 $$ ldapContext.close()[ FD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)[ FD ]
Line_16 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_58 $$ if (enu != null) [ FD ]
Line_23 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)-->Line_25 $$ LDAPAuthResult ldapAuthResult = authenticate(ldapContext, companyId, attributes, fullUserDN, password)[ FD ]
