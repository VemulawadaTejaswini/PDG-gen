Line_9 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)-->Line_10 $$ String baseDN = ldapServerConfiguration.baseDN()[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_70 $$ return SUCCESS[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_24 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_32 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)-->Line_37 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ FD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_31 $$ if (errorMessage != null) -->Line_32 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ CD ]
Line_31 $$ if (errorMessage != null) -->Line_34 $$ if (pos != -1) [ CD ]
Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_22 $$ SearchResult result = enu.nextElement()[ FD ]
Line_10 $$ String baseDN = ldapServerConfiguration.baseDN()-->Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_13 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)[ FD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_22 $$ SearchResult result = enu.nextElement()[ FD ]
Line_51 $$ if (_log.isDebugEnabled()) -->Line_52 $$ _log.debug("Search filter did not return any results")[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_24 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_31 $$ if (errorMessage != null) -->Line_38 $$ if (pos != -1) [ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_4 $$ if (ldapContext == null) [ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_9 $$ LDAPServerConfiguration ldapServerConfiguration = _ldapServerConfigurationProvider.getConfiguration(companyId, ldapServerId)[ FD ]
Line_16 $$ SearchControls searchControls = new SearchControls(SearchControls.SUBTREE_SCOPE, 1, 0, new String[] -->Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_24 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_64 $$ enu.close()[ FD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_66 $$ if (ldapContext != null) [ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_54 $$ return DNE[ CD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_23 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_42 $$ if (!ldapAuthResult.isAuthenticated()) [ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ CD ]
Line_14 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))-->Line_15 $$ userMappingsScreenName = StringUtil.toLowerCase(userMappingsScreenName)[ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_51 $$ if (_log.isDebugEnabled()) [ CD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_22 $$ SearchResult result = enu.nextElement()[ CD ]
Line_63 $$ if (enu != null) -->Line_64 $$ enu.close()[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_4 $$ if (ldapContext == null) [ CD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_23 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ CD ]
Line_37 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())-->Line_38 $$ if (pos != -1) [ FD ]
Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_64 $$ enu.close()[ FD ]
Line_19 $$ if (_log.isDebugEnabled()) -->Line_20 $$ _log.debug("Search filter returned at least one result")[ CD ]
Line_22 $$ SearchResult result = enu.nextElement()-->Line_23 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)[ FD ]
Line_23 $$ String fullUserDN = _portalLDAP.getNameInNamespace(ldapServerId, companyId, result)-->Line_24 $$ Attributes attributes = _portalLDAP.getUserAttributes(ldapServerId, companyId, ldapContext, fullUserDN)[ FD ]
Line_32 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)-->Line_33 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())[ FD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_32 $$ SystemLDAPConfiguration systemLDAPConfiguration = _systemLDAPConfigurationProvider.getConfiguration(companyId)[ FD ]
Line_33 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_34 $$ if (pos != -1) [ FD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_63 $$ if (enu != null) [ FD ]
Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)-->Line_67 $$ ldapContext.close()[ FD ]
Line_31 $$ if (errorMessage != null) -->Line_33 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_7 $$ NamingEnumeration<SearchResult> enu = null[ CD ]
Line_7 $$ NamingEnumeration<SearchResult> enu = null-->Line_18 $$ if (enu.hasMoreElements()) [ FD ]
Line_31 $$ if (errorMessage != null) -->Line_37 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ CD ]
Line_2 $$ protected int authenticate(long ldapServerId, long companyId, String emailAddress, String screenName, long userId, String password) throws Exception -->Line_3 $$ LdapContext ldapContext = _portalLDAP.getContext(ldapServerId, companyId)[ FD ]
Line_66 $$ if (ldapContext != null) -->Line_67 $$ ldapContext.close()[ CD ]
Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_18 $$ if (enu.hasMoreElements()) [ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_19 $$ if (_log.isDebugEnabled()) [ CD ]
Line_33 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_38 $$ if (pos != -1) [ FD ]
Line_47 $$ if (resultCode.equals(LDAPAuth.RESULT_PASSWORD_RESET)) -->Line_48 $$ _userLocalService.updatePasswordReset(user.getUserId(), true)[ CD ]
Line_13 $$ Properties userMappings = _ldapSettings.getUserMappings(ldapServerId, companyId)-->Line_14 $$ String userMappingsScreenName = GetterUtil.getString(userMappings.getProperty("screenName"))[ FD ]
Line_17 $$ enu = ldapContext.search(baseDN, filter, searchControls)-->Line_63 $$ if (enu != null) [ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_31 $$ if (errorMessage != null) [ CD ]
Line_42 $$ if (!ldapAuthResult.isAuthenticated()) -->Line_43 $$ return FAILURE[ CD ]
Line_33 $$ int pos = errorMessage.indexOf(systemLDAPConfiguration.errorUserLockout())-->Line_37 $$ pos = errorMessage.indexOf(systemLDAPConfiguration.errorPasswordExpired())[ FD ]
Line_18 $$ if (enu.hasMoreElements()) -->Line_47 $$ if (resultCode.equals(LDAPAuth.RESULT_PASSWORD_RESET)) [ CD ]
Line_4 $$ if (ldapContext == null) -->Line_5 $$ return FAILURE[ CD ]
