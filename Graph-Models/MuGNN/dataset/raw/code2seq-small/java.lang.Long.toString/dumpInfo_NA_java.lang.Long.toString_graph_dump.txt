Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_15 $$ properties.put("File Length", Long.toString(length))[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_66 $$ maxKeyLength = e.getKey().length()[ FD ]
Line_65 $$ if (e.getKey().length() > maxKeyLength) -->Line_66 $$ maxKeyLength = e.getKey().length()[ CD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_20 $$ properties.put("Comparator", reader.getComparatorName())[ FD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_90 $$ for (int i = 0; i < blockCnt; ++i) [ FD ]
Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_83 $$ String rawSize = "Raw-Size"-->Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)[ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_126 $$ maxNameLen = e.getKey().length()[ FD ]
Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_3 $$ final int maxKeySampleLen = 16[ CD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_78 $$ int blkIDWidth2 = Align.calculateWidth("", blockCnt)[ FD ]
Line_62 $$ Set<Map.Entry<String, String>> entrySet = properties.entrySet()-->Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) [ FD ]
Line_100 $$ asAscii = false-->Line_103 $$ if (!asAscii) [ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_133 $$ int blkLenWidth = Align.calculateWidth(blkLen, metaSize / metaBlkCnt * 10)[ CD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_112 $$ if (sampleLen < key.length) [ CD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_73 $$ out.println()[ FD ]
Line_79 $$ String offset = "Offset"-->Line_131 $$ int offsetWidth = Align.calculateWidth(offset, length)[ FD ]
Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_55 $$ properties.put("Meta-Data Size Ratio", String.format("1:%.1f", (double) dataSize / metaSize))[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_22 $$ properties.put("Data Block Count", Integer.toString(blockCnt))[ FD ]
Line_3 $$ final int maxKeySampleLen = 16-->Line_96 $$ int sampleLen = Math.min(maxKeySampleLen, key.length)[ FD ]
Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_90 $$ for (int i = 0; i < blockCnt; ++i) [ FD ]
Line_5 $$ FileSystem fs = path.getFileSystem(conf)-->Line_7 $$ FSDataInputStream fsdis = fs.open(path)[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_113 $$ out.print("...")[ FD ]
Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ FD ]
Line_137 $$ int compressionWidth = compression.length()-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_57 $$ long miscSize = BCFile.Magic.size() * 2 + Long.SIZE / Byte.SIZE + Version.size()-->Line_60 $$ properties.put("Headers Etc Bytes", Long.toString(miscSize))[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ FD ]
Line_38 $$ if (metaBlkCnt > 0) -->Line_40 $$ boolean calculateCompression = false[ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_51 $$ properties.put("Meta Block Uncompressed Bytes", Long.toString(metaSizeUncompressed))[ FD ]
Line_37 $$ long metaSize = 0, metaSizeUncompressed = 0-->Line_51 $$ properties.put("Meta Block Uncompressed Bytes", Long.toString(metaSizeUncompressed))[ FD ]
Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_95 $$ boolean asAscii = true[ CD ]
Line_103 $$ if (!asAscii) -->Line_105 $$ for (int j = 0; j < sampleLen; ++j) [ CD ]
Line_28 $$ dataSizeUncompressed += region.getRawSize()-->Line_32 $$ properties.put("Data Block Uncompressed Bytes", Long.toString(dataSizeUncompressed))[ FD ]
Line_61 $$ int maxKeyLength = 0-->Line_66 $$ maxKeyLength = e.getKey().length()[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)[ CD ]
Line_81 $$ String blkLen = "Length"-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_79 $$ String offset = "Offset"[ CD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ CD ]
Line_50 $$ if (calculateCompression) -->Line_51 $$ properties.put("Meta Block Uncompressed Bytes", Long.toString(metaSizeUncompressed))[ CD ]
Line_6 $$ long length = fs.getFileStatus(path).getLen()-->Line_131 $$ int offsetWidth = Align.calculateWidth(offset, length)[ FD ]
Line_24 $$ if (blockCnt > 0) -->Line_31 $$ if (!reader.readerBCF.getDefaultCompressionName().equals("none")) [ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_13 $$ properties.put("BCFile Version", reader.readerBCF.version.toString())[ FD ]
Line_7 $$ FSDataInputStream fsdis = fs.open(path)-->Line_148 $$ IOUtils.cleanup(LOG, reader, fsdis)[ FD ]
Line_98 $$ byte b = key[j]-->Line_107 $$ out.printf("%X", b)[ FD ]
Line_96 $$ int sampleLen = Math.min(maxKeySampleLen, key.length)-->Line_97 $$ for (int j = 0; j < sampleLen; ++j) [ FD ]
Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_141 $$ String blkName = e.getValue().getMetaName()[ FD ]
Line_38 $$ if (metaBlkCnt > 0) -->Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) [ CD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)[ CD ]
Line_23 $$ long dataSize = 0, dataSizeUncompressed = 0-->Line_27 $$ dataSize += region.getCompressedSize()[ FD ]
Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_91 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_118 $$ out.println()[ FD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_64 $$ Map.Entry<String, String> e = it.next()[ FD ]
Line_31 $$ if (!reader.readerBCF.getDefaultCompressionName().equals("none")) -->Line_32 $$ properties.put("Data Block Uncompressed Bytes", Long.toString(dataSizeUncompressed))[ CD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_81 $$ String blkLen = "Length"[ CD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_96 $$ int sampleLen = Math.min(maxKeySampleLen, key.length)[ CD ]
Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_70 $$ Map.Entry<String, String> e = it.next()[ FD ]
Line_85 $$ String records = "Records"-->Line_86 $$ int recordsWidth = Align.calculateWidth(records, reader.getEntryCount() / blockCnt * 10)[ FD ]
Line_27 $$ dataSize += region.getCompressedSize()-->Line_30 $$ properties.put("Data Block Bytes", Long.toString(dataSize))[ FD ]
Line_95 $$ boolean asAscii = true-->Line_100 $$ asAscii = false[ FD ]
Line_121 $$ int maxNameLen = 0-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_12 $$ int metaBlkCnt = reader.readerBCF.metaIndex.index.size()-->Line_119 $$ if (metaBlkCnt > 0) [ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_17 $$ properties.put("Record Count", Long.toString(reader.getEntryCount()))[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ FD ]
Line_136 $$ String compression = "Compression"-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_125 $$ if (e.getKey().length() > maxNameLen) -->Line_126 $$ maxNameLen = e.getKey().length()[ CD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_115 $$ out.println()[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) [ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_42 $$ MetaIndexEntry e = it.next()[ CD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_22 $$ properties.put("Data Block Count", Integer.toString(blockCnt))[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_6 $$ long length = fs.getFileStatus(path).getLen()[ CD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_43 $$ metaSize += e.getRegion().getCompressedSize()[ FD ]
Line_76 $$ String blkID = "Data-Block"-->Line_77 $$ int blkIDWidth = Align.calculateWidth(blkID, blockCnt)[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_14 $$ properties.put("TFile Version", reader.tfileMeta.version.toString())[ FD ]
Line_38 $$ if (metaBlkCnt > 0) -->Line_39 $$ Collection<MetaIndexEntry> metaBlks = reader.readerBCF.metaIndex.index.values()[ CD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_74 $$ reader.checkTFileDataIndex()[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_122 $$ Set<Map.Entry<String, MetaIndexEntry>> metaBlkEntrySet = reader.readerBCF.metaIndex.index.entrySet()[ CD ]
Line_96 $$ int sampleLen = Math.min(maxKeySampleLen, key.length)-->Line_105 $$ for (int j = 0; j < sampleLen; ++j) [ FD ]
Line_79 $$ String offset = "Offset"-->Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_36 $$ properties.put("Meta Block Count", Integer.toString(metaBlkCnt))[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_44 $$ metaSizeUncompressed += e.getRegion().getRawSize()[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_65 $$ if (e.getKey().length() > maxKeyLength) [ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_66 $$ maxKeyLength = e.getKey().length()[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ CD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_33 $$ properties.put("Data Block Compression Ratio", String.format("1:%.1f", (double) dataSizeUncompressed / dataSize))[ FD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ FD ]
Line_122 $$ Set<Map.Entry<String, MetaIndexEntry>> metaBlkEntrySet = reader.readerBCF.metaIndex.index.entrySet()-->Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ FD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_27 $$ dataSize += region.getCompressedSize()[ CD ]
Line_37 $$ long metaSize = 0, metaSizeUncompressed = 0-->Line_44 $$ metaSizeUncompressed += e.getRegion().getRawSize()[ FD ]
Line_103 $$ if (!asAscii) -->Line_104 $$ out.print("0X")[ CD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) [ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_92 $$ TFileIndexEntry indexEntry = reader.tfileIndex.getEntry(i)[ CD ]
Line_76 $$ String blkID = "Data-Block"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ CD ]
Line_38 $$ if (metaBlkCnt > 0) -->Line_50 $$ if (calculateCompression) [ CD ]
Line_83 $$ String rawSize = "Raw-Size"-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_88 $$ int endKeyWidth = Math.max(endKey.length(), maxKeySampleLen * 2 + 5)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_112 $$ if (sampleLen < key.length) -->Line_113 $$ out.print("...")[ CD ]
Line_105 $$ for (int j = 0; j < sampleLen; ++j) -->Line_106 $$ byte b = key[i][ CD ]
Line_23 $$ long dataSize = 0, dataSizeUncompressed = 0-->Line_30 $$ properties.put("Data Block Bytes", Long.toString(dataSize))[ FD ]
Line_121 $$ int maxNameLen = 0-->Line_126 $$ maxNameLen = e.getKey().length()[ FD ]
Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_24 $$ if (blockCnt > 0) [ FD ]
Line_66 $$ maxKeyLength = e.getKey().length()-->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_78 $$ int blkIDWidth2 = Align.calculateWidth("", blockCnt)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_91 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_37 $$ long metaSize = 0, metaSizeUncompressed = 0-->Line_49 $$ properties.put("Meta Block Bytes", Long.toString(metaSize))[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_110 $$ out.print(new String(key, 0, sampleLen))[ FD ]
Line_6 $$ long length = fs.getFileStatus(path).getLen()-->Line_15 $$ properties.put("File Length", Long.toString(length))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_43 $$ metaSize += e.getRegion().getCompressedSize()[ CD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ CD ]
Line_6 $$ long length = fs.getFileStatus(path).getLen()-->Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_16 $$ properties.put("Data Compression", reader.readerBCF.getDefaultCompressionName())[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_49 $$ properties.put("Meta Block Bytes", Long.toString(metaSize))[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_62 $$ Set<Map.Entry<String, String>> entrySet = properties.entrySet()[ FD ]
Line_62 $$ Set<Map.Entry<String, String>> entrySet = properties.entrySet()-->Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) [ FD ]
Line_81 $$ String blkLen = "Length"-->Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)[ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_52 $$ properties.put("Meta Block Compression Ratio", String.format("1:%.1f", (double) metaSizeUncompressed / metaSize))[ FD ]
Line_87 $$ String endKey = "End-Key"-->Line_88 $$ int endKeyWidth = Math.max(endKey.length(), maxKeySampleLen * 2 + 5)[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_97 $$ for (int j = 0; j < sampleLen; ++j) [ CD ]
Line_75 $$ if (blockCnt > 0) -->Line_87 $$ String endKey = "End-Key"[ CD ]
Line_95 $$ boolean asAscii = true-->Line_103 $$ if (!asAscii) [ FD ]
Line_103 $$ if (!asAscii) -->Line_110 $$ out.print(new String(key, 0, sampleLen))[ CD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_126 $$ maxNameLen = e.getKey().length()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_5 $$ FileSystem fs = path.getFileSystem(conf)[ FD ]
Line_120 $$ String name = "Meta-Block"-->Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)[ FD ]
Line_81 $$ String blkLen = "Length"-->Line_133 $$ int blkLenWidth = Align.calculateWidth(blkLen, metaSize / metaBlkCnt * 10)[ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_25 $$ for (int i = 0; i < blockCnt; ++i) [ FD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_70 $$ Map.Entry<String, String> e = it.next()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_7 $$ FSDataInputStream fsdis = fs.open(path)[ CD ]
Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_115 $$ out.println()[ CD ]
Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_126 $$ maxNameLen = e.getKey().length()-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_107 $$ out.printf("%X", b)[ FD ]
Line_40 $$ boolean calculateCompression = false-->Line_46 $$ calculateCompression = true[ FD ]
Line_4 $$ Path path = new Path(file)-->Line_5 $$ FileSystem fs = path.getFileSystem(conf)[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_30 $$ properties.put("Data Block Bytes", Long.toString(dataSize))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_64 $$ Map.Entry<String, String> e = it.next()[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_83 $$ String rawSize = "Raw-Size"[ CD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_4 $$ Path path = new Path(file)[ CD ]
Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_126 $$ maxNameLen = e.getKey().length()[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ CD ]
Line_142 $$ BlockRegion region = e.getValue().getRegion()-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_77 $$ int blkIDWidth = Align.calculateWidth(blkID, blockCnt)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_20 $$ properties.put("Comparator", reader.getComparatorName())[ FD ]
Line_79 $$ String offset = "Offset"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_137 $$ int compressionWidth = compression.length()-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_135 $$ int rawSizeWidth = Align.calculateWidth(rawSize, metaSizeUncompressed / metaBlkCnt * 10)[ CD ]
Line_83 $$ String rawSize = "Raw-Size"-->Line_135 $$ int rawSizeWidth = Align.calculateWidth(rawSize, metaSizeUncompressed / metaBlkCnt * 10)[ FD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ CD ]
Line_43 $$ metaSize += e.getRegion().getCompressedSize()-->Line_49 $$ properties.put("Meta Block Bytes", Long.toString(metaSize))[ FD ]
Line_66 $$ maxKeyLength = e.getKey().length()-->Line_65 $$ if (e.getKey().length() > maxKeyLength) [ FD ]
Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_141 $$ String blkName = e.getValue().getMetaName()[ FD ]
Line_24 $$ if (blockCnt > 0) -->Line_25 $$ for (int i = 0; i < blockCnt; ++i) [ CD ]
Line_121 $$ int maxNameLen = 0-->Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_136 $$ String compression = "Compression"[ CD ]
Line_58 $$ long metaIndexSize = leftOverBytes - miscSize-->Line_59 $$ properties.put("Meta Block Index Bytes", Long.toString(metaIndexSize))[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_103 $$ if (!asAscii) [ CD ]
Line_85 $$ String records = "Records"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_120 $$ String name = "Meta-Block"-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_44 $$ metaSizeUncompressed += e.getRegion().getRawSize()[ CD ]
Line_24 $$ if (blockCnt > 0) -->Line_30 $$ properties.put("Data Block Bytes", Long.toString(dataSize))[ CD ]
Line_105 $$ for (int j = 0; j < sampleLen; ++j) -->Line_107 $$ out.printf("%X", b)[ CD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_37 $$ long metaSize = 0, metaSizeUncompressed = 0-->Line_43 $$ metaSize += e.getRegion().getCompressedSize()[ FD ]
Line_141 $$ String blkName = e.getValue().getMetaName()-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_126 $$ maxNameLen = e.getKey().length()-->Line_129 $$ int nameWidth = Math.max(name.length(), maxNameLen)[ FD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_64 $$ Map.Entry<String, String> e = it.next()[ CD ]
Line_106 $$ byte b = key[i]-->Line_107 $$ out.printf("%X", b)[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_92 $$ TFileIndexEntry indexEntry = reader.tfileIndex.getEntry(i)[ FD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ CD ]
Line_12 $$ int metaBlkCnt = reader.readerBCF.metaIndex.index.size()-->Line_38 $$ if (metaBlkCnt > 0) [ FD ]
Line_5 $$ FileSystem fs = path.getFileSystem(conf)-->Line_6 $$ long length = fs.getFileStatus(path).getLen()[ FD ]
Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ CD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_91 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)[ CD ]
Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ FD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)[ CD ]
Line_97 $$ for (int j = 0; j < sampleLen; ++j) -->Line_105 $$ for (int j = 0; j < sampleLen; ++j) [ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) [ FD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_18 $$ properties.put("Sorted", Boolean.toString(reader.isSorted()))[ FD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_86 $$ int recordsWidth = Align.calculateWidth(records, reader.getEntryCount() / blockCnt * 10)[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_76 $$ String blkID = "Data-Block"[ CD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_141 $$ String blkName = e.getValue().getMetaName()[ CD ]
Line_75 $$ if (blockCnt > 0) -->Line_78 $$ int blkIDWidth2 = Align.calculateWidth("", blockCnt)[ CD ]
Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_141 $$ String blkName = e.getValue().getMetaName()[ FD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_122 $$ Set<Map.Entry<String, MetaIndexEntry>> metaBlkEntrySet = reader.readerBCF.metaIndex.index.entrySet()-->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_84 $$ int rawSizeWidth = Align.calculateWidth(rawSize, dataSizeUncompressed / blockCnt * 10)-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_28 $$ dataSizeUncompressed += region.getRawSize()[ FD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_137 $$ int compressionWidth = compression.length()[ CD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_65 $$ if (e.getKey().length() > maxKeyLength) [ CD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_75 $$ if (blockCnt > 0) [ FD ]
Line_39 $$ Collection<MetaIndexEntry> metaBlks = reader.readerBCF.metaIndex.index.values()-->Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) [ FD ]
Line_50 $$ if (calculateCompression) -->Line_52 $$ properties.put("Meta Block Compression Ratio", String.format("1:%.1f", (double) metaSizeUncompressed / metaSize))[ CD ]
Line_4 $$ Path path = new Path(file)-->Line_7 $$ FSDataInputStream fsdis = fs.open(path)[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_59 $$ properties.put("Meta Block Index Bytes", Long.toString(metaIndexSize))[ FD ]
Line_38 $$ if (metaBlkCnt > 0) -->Line_49 $$ properties.put("Meta Block Bytes", Long.toString(metaSize))[ CD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_141 $$ String blkName = e.getValue().getMetaName()[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_88 $$ int endKeyWidth = Math.max(endKey.length(), maxKeySampleLen * 2 + 5)[ CD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_28 $$ dataSizeUncompressed += region.getRawSize()[ CD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ CD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_42 $$ MetaIndexEntry e = it.next()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_5 $$ FileSystem fs = path.getFileSystem(conf)[ CD ]
Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_79 $$ String offset = "Offset"-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_17 $$ properties.put("Record Count", Long.toString(reader.getEntryCount()))[ FD ]
Line_11 $$ int blockCnt = reader.readerBCF.getBlockCount()-->Line_77 $$ int blkIDWidth = Align.calculateWidth(blkID, blockCnt)[ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_45 $$ if (e.getCompressionAlgorithm() != Compression.Algorithm.NONE) [ FD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_141 $$ String blkName = e.getValue().getMetaName()[ FD ]
Line_77 $$ int blkIDWidth = Align.calculateWidth(blkID, blockCnt)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_31 $$ if (!reader.readerBCF.getDefaultCompressionName().equals("none")) -->Line_33 $$ properties.put("Data Block Compression Ratio", String.format("1:%.1f", (double) dataSizeUncompressed / dataSize))[ CD ]
Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_61 $$ int maxKeyLength = 0-->Line_65 $$ if (e.getKey().length() > maxKeyLength) [ FD ]
Line_25 $$ for (int i = 0; i < blockCnt; ++i) -->Line_92 $$ TFileIndexEntry indexEntry = reader.tfileIndex.getEntry(i)[ FD ]
Line_99 $$ if ((b < 32 && b != 9) || (b == 127)) -->Line_100 $$ asAscii = false[ CD ]
Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_142 $$ BlockRegion region = e.getValue().getRegion()[ FD ]
Line_70 $$ Map.Entry<String, String> e = it.next()-->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_70 $$ Map.Entry<String, String> e = it.next()[ CD ]
Line_75 $$ if (blockCnt > 0) -->Line_86 $$ int recordsWidth = Align.calculateWidth(records, reader.getEntryCount() / blockCnt * 10)[ CD ]
Line_75 $$ if (blockCnt > 0) -->Line_90 $$ for (int i = 0; i < blockCnt; ++i) [ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_18 $$ properties.put("Sorted", Boolean.toString(reader.isSorted()))[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_45 $$ if (e.getCompressionAlgorithm() != Compression.Algorithm.NONE) -->Line_46 $$ calculateCompression = true[ CD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_94 $$ byte[] key = indexEntry.key[ CD ]
Line_23 $$ long dataSize = 0, dataSizeUncompressed = 0-->Line_28 $$ dataSizeUncompressed += region.getRawSize()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)[ CD ]
Line_75 $$ if (blockCnt > 0) -->Line_77 $$ int blkIDWidth = Align.calculateWidth(blkID, blockCnt)[ CD ]
Line_80 $$ int offsetWidth = Align.calculateWidth(offset, length)-->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_65 $$ if (e.getKey().length() > maxKeyLength) [ FD ]
Line_23 $$ long dataSize = 0, dataSizeUncompressed = 0-->Line_32 $$ properties.put("Data Block Uncompressed Bytes", Long.toString(dataSizeUncompressed))[ FD ]
Line_64 $$ Map.Entry<String, String> e = it.next()-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_87 $$ String endKey = "End-Key"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_91 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()-->Line_144 $$ out.printf("%s %s %s %s %s\n", Align.format(blkName, nameWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(blkCompression, compressionWidth, Align.LEFT))[ FD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_32 $$ properties.put("Data Block Uncompressed Bytes", Long.toString(dataSizeUncompressed))[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_82 $$ int blkLenWidth = Align.calculateWidth(blkLen, dataSize / blockCnt * 10)[ CD ]
Line_83 $$ String rawSize = "Raw-Size"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_97 $$ for (int j = 0; j < sampleLen; ++j) -->Line_98 $$ byte b = key[j][ CD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_45 $$ if (e.getCompressionAlgorithm() != Compression.Algorithm.NONE) [ CD ]
Line_97 $$ for (int j = 0; j < sampleLen; ++j) -->Line_99 $$ if ((b < 32 && b != 9) || (b == 127)) [ CD ]
Line_81 $$ String blkLen = "Length"-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_120 $$ String name = "Meta-Block"[ CD ]
Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_125 $$ if (e.getKey().length() > maxNameLen) [ FD ]
Line_136 $$ String compression = "Compression"-->Line_137 $$ int compressionWidth = compression.length()[ FD ]
Line_96 $$ int sampleLen = Math.min(maxKeySampleLen, key.length)-->Line_112 $$ if (sampleLen < key.length) [ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_104 $$ out.print("0X")[ FD ]
Line_90 $$ for (int i = 0; i < blockCnt; ++i) -->Line_91 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_131 $$ int offsetWidth = Align.calculateWidth(offset, length)[ CD ]
Line_86 $$ int recordsWidth = Align.calculateWidth(records, reader.getEntryCount() / blockCnt * 10)-->Line_93 $$ out.printf("%s %s %s %s %s ", Align.format(Align.format(i, blkIDWidth2, Align.ZERO_PADDED), blkIDWidth, Align.LEFT), Align.format(region.getOffset(), offsetWidth, Align.LEFT), Align.format(region.getCompressedSize(), blkLenWidth, Align.LEFT), Align.format(region.getRawSize(), rawSizeWidth, Align.LEFT), Align.format(indexEntry.kvEntries, recordsWidth, Align.LEFT))[ FD ]
Line_61 $$ int maxKeyLength = 0-->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_75 $$ if (blockCnt > 0) -->Line_85 $$ String records = "Records"[ CD ]
Line_4 $$ Path path = new Path(file)-->Line_6 $$ long length = fs.getFileStatus(path).getLen()[ FD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_126 $$ maxNameLen = e.getKey().length()[ FD ]
Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_140 $$ Map.Entry<String, MetaIndexEntry> e = it.next()[ CD ]
Line_12 $$ int metaBlkCnt = reader.readerBCF.metaIndex.index.size()-->Line_36 $$ properties.put("Meta Block Count", Integer.toString(metaBlkCnt))[ FD ]
Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) -->Line_125 $$ if (e.getKey().length() > maxNameLen) [ CD ]
Line_26 $$ BlockRegion region = reader.readerBCF.dataIndex.getBlockRegionList().get(i)-->Line_27 $$ dataSize += region.getCompressedSize()[ FD ]
Line_69 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_139 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_19 $$ if (reader.isSorted()) -->Line_20 $$ properties.put("Comparator", reader.getComparatorName())[ CD ]
Line_2 $$ public static void dumpInfo(String file, PrintStream out, Configuration conf) throws IOException -->Line_138 $$ out.printf("%s %s %s %s %s\n", Align.format(name, nameWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(compression, compressionWidth, Align.LEFT))[ FD ]
Line_41 $$ for (Iterator<MetaIndexEntry> it = metaBlks.iterator(); it.hasNext(); ) -->Line_70 $$ Map.Entry<String, String> e = it.next()[ FD ]
Line_42 $$ MetaIndexEntry e = it.next()-->Line_71 $$ out.printf("%s : %s\n", Align.format(e.getKey(), maxKeyLength, Align.LEFT), e.getValue())[ FD ]
Line_119 $$ if (metaBlkCnt > 0) -->Line_121 $$ int maxNameLen = 0[ CD ]
Line_10 $$ LinkedHashMap<String, String> properties = new LinkedHashMap<String, String>()-->Line_60 $$ properties.put("Headers Etc Bytes", Long.toString(miscSize))[ FD ]
Line_63 $$ for (Iterator<Map.Entry<String, String>> it = entrySet.iterator(); it.hasNext(); ) -->Line_123 $$ for (Iterator<Map.Entry<String, MetaIndexEntry>> it = metaBlkEntrySet.iterator(); it.hasNext(); ) [ FD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_19 $$ if (reader.isSorted()) [ FD ]
Line_86 $$ int recordsWidth = Align.calculateWidth(records, reader.getEntryCount() / blockCnt * 10)-->Line_89 $$ out.printf("%s %s %s %s %s %s\n", Align.format(blkID, blkIDWidth, Align.CENTER), Align.format(offset, offsetWidth, Align.CENTER), Align.format(blkLen, blkLenWidth, Align.CENTER), Align.format(rawSize, rawSizeWidth, Align.CENTER), Align.format(records, recordsWidth, Align.CENTER), Align.format(endKey, endKeyWidth, Align.LEFT))[ FD ]
Line_44 $$ metaSizeUncompressed += e.getRegion().getRawSize()-->Line_51 $$ properties.put("Meta Block Uncompressed Bytes", Long.toString(metaSizeUncompressed))[ FD ]
Line_8 $$ TFile.Reader reader = new TFile.Reader(fsdis, length, conf)-->Line_148 $$ IOUtils.cleanup(LOG, reader, fsdis)[ FD ]
Line_124 $$ Map.Entry<String, MetaIndexEntry> e = it.next()-->Line_143 $$ String blkCompression = e.getValue().getCompressionAlgorithm().getName()[ FD ]
