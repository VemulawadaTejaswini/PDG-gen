Line_8 $$ final DistributedFileSystem fs = cluster.getFileSystem()-->Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)[ FD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_16 $$ RAN.nextBytes(bytes)[ CD ]
Line_13 $$ final FSDataOutputStream out = fs.create(p, REPLICATION)-->Line_18 $$ out.write(bytes, 0, len)[ FD ]
Line_17 $$ final int len = bytes.length < remaining ? bytes.length : remaining-->Line_20 $$ remaining -= len[ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_36 $$ final DatanodeInfo[] datatnodeinfos = cluster.getNameNodeRpc().getDatanodeReport(DatanodeReportType.LIVE)[ FD ]
Line_33 $$ newnode = cluster.getDataNodes().get(REPLICATION)-->Line_39 $$ for (DatanodeRegistration dnReg = newnode.getDNRegistrationForBP(bpid); i < datatnodeinfos.length && !datatnodeinfos[i].equals(dnReg); i++) [ FD ]
Line_38 $$ int i = 0-->Line_39 $$ for (DatanodeRegistration dnReg = newnode.getDNRegistrationForBP(bpid); i < datatnodeinfos.length && !datatnodeinfos[i].equals(dnReg); i++) [ FD ]
Line_14 $$ final byte[] bytes = new byte[1024]-->Line_18 $$ out.write(bytes, 0, len)[ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_26 $$ final String bpid = cluster.getNamesystem().getBlockPoolId()[ FD ]
Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)-->Line_47 $$ Assert.assertEquals(Status.SUCCESS, s.getStatus())[ FD ]
Line_34 $$ final DatanodeInfo oldnodeinfo-->Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)[ FD ]
Line_14 $$ final byte[] bytes = new byte[1024]-->Line_16 $$ RAN.nextBytes(bytes)[ FD ]
Line_29 $$ oldrbw = getRbw(oldnode, bpid)-->Line_53 $$ Assert.assertEquals(oldrbw.getGenerationStamp(), newrbw.getGenerationStamp())[ FD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_18 $$ out.write(bytes, 0, len)[ CD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_20 $$ remaining -= len[ FD ]
Line_28 $$ final DataNode oldnode = cluster.getDataNodes().get(0)-->Line_29 $$ oldrbw = getRbw(oldnode, bpid)[ FD ]
Line_34 $$ final DatanodeInfo oldnodeinfo-->Line_42 $$ oldnodeinfo = datatnodeinfos[1 - i][ FD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_19 $$ out.hflush()[ CD ]
Line_26 $$ final String bpid = cluster.getNamesystem().getBlockPoolId()-->Line_39 $$ for (DatanodeRegistration dnReg = newnode.getDNRegistrationForBP(bpid); i < datatnodeinfos.length && !datatnodeinfos[i].equals(dnReg); i++) [ FD ]
Line_20 $$ remaining -= len-->Line_15 $$ for (int remaining = size; remaining > 0; ) [ FD ]
Line_41 $$ newnodeinfo = datatnodeinfos[i]-->Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)[ FD ]
Line_25 $$ final DatanodeInfo newnodeinfo-->Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)[ FD ]
Line_26 $$ final String bpid = cluster.getNamesystem().getBlockPoolId()-->Line_29 $$ oldrbw = getRbw(oldnode, bpid)[ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_8 $$ final DistributedFileSystem fs = cluster.getFileSystem()[ FD ]
Line_29 $$ oldrbw = getRbw(oldnode, bpid)-->Line_54 $$ Assert.assertEquals(oldrbw.getVisibleLength(), newrbw.getVisibleLength())[ FD ]
Line_8 $$ final DistributedFileSystem fs = cluster.getFileSystem()-->Line_13 $$ final FSDataOutputStream out = fs.create(p, REPLICATION)[ FD ]
Line_29 $$ oldrbw = getRbw(oldnode, bpid)-->Line_52 $$ Assert.assertEquals(oldrbw.getBlockId(), newrbw.getBlockId())[ FD ]
Line_13 $$ final FSDataOutputStream out = fs.create(p, REPLICATION)-->Line_19 $$ out.hflush()[ FD ]
Line_42 $$ oldnodeinfo = datatnodeinfos[1 - i]-->Line_46 $$ final BlockOpResponseProto s = DFSTestUtil.transferRbw(b, DFSClientAdapter.getDFSClient(fs), oldnodeinfo, newnodeinfo)[ FD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_17 $$ final int len = bytes.length < remaining ? bytes.length : remaining[ CD ]
Line_24 $$ final DataNode newnode-->Line_39 $$ for (DatanodeRegistration dnReg = newnode.getDNRegistrationForBP(bpid); i < datatnodeinfos.length && !datatnodeinfos[i].equals(dnReg); i++) [ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_33 $$ newnode = cluster.getDataNodes().get(REPLICATION)[ FD ]
Line_15 $$ for (int remaining = size; remaining > 0; ) -->Line_20 $$ remaining -= len[ CD ]
Line_25 $$ final DatanodeInfo newnodeinfo-->Line_41 $$ newnodeinfo = datatnodeinfos[i][ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_28 $$ final DataNode oldnode = cluster.getDataNodes().get(0)[ FD ]
Line_17 $$ final int len = bytes.length < remaining ? bytes.length : remaining-->Line_18 $$ out.write(bytes, 0, len)[ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_57 $$ cluster.shutdown()[ FD ]
Line_24 $$ final DataNode newnode-->Line_33 $$ newnode = cluster.getDataNodes().get(REPLICATION)[ FD ]
Line_5 $$ final MiniDFSCluster cluster = new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build()-->Line_7 $$ cluster.waitActive()[ FD ]
