Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_3 $$ client().admin().indices().prepareCreate("test").setSettings(Settings.settingsBuilder().put("index.number_of_shards", 5)).execute().actionGet()[ CD ]
Line_18 $$ Map<String, Object> map = searchHit.sourceAsMap()-->Line_19 $$ map.put("message", "update")[ FD ]
Line_22 $$ searchResponse = client().prepareSearchScroll(searchResponse.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).execute().actionGet()-->Line_16 $$ do [ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_4 $$ client().admin().cluster().prepareHealth().setWaitForEvents(Priority.LANGUID).setWaitForGreenStatus().execute().actionGet()[ CD ]
Line_14 $$ SearchResponse searchResponse = client().prepareSearch().setQuery(queryStringQuery("user:kimchy")).setSize(35).setScroll(TimeValue.timeValueMinutes(2)).addSort("postDate", SortOrder.ASC).execute().actionGet()-->Line_17 $$ for (SearchHit searchHit : searchResponse.getHits().hits()) [ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_10 $$ assertThat(client().prepareSearch().setSize(0).setQuery(termQuery("message", "test")).execute().actionGet().getHits().totalHits(), equalTo(500l))[ CD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_5 $$ for (int i = 0; i < 500; i++) [ CD ]
Line_14 $$ SearchResponse searchResponse = client().prepareSearch().setQuery(queryStringQuery("user:kimchy")).setSize(35).setScroll(TimeValue.timeValueMinutes(2)).addSort("postDate", SortOrder.ASC).execute().actionGet()-->Line_16 $$ do [ FD ]
Line_5 $$ for (int i = 0; i < 500; i++) -->Line_6 $$ client().prepareIndex("test", "tweet", Integer.toString(i)).setSource(jsonBuilder().startObject().field("user", "kimchy").field("postDate", System.currentTimeMillis()).field("message", "test").endObject()).execute().actionGet()[ CD ]
Line_22 $$ searchResponse = client().prepareSearchScroll(searchResponse.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).execute().actionGet()-->Line_17 $$ for (SearchHit searchHit : searchResponse.getHits().hits()) [ FD ]
Line_17 $$ for (SearchHit searchHit : searchResponse.getHits().hits()) -->Line_20 $$ client().prepareIndex("test", "tweet", searchHit.id()).setSource(map).execute().actionGet()[ FD ]
Line_18 $$ Map<String, Object> map = searchHit.sourceAsMap()-->Line_20 $$ client().prepareIndex("test", "tweet", searchHit.id()).setSource(map).execute().actionGet()[ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_13 $$ assertThat(client().prepareSearch().setSize(0).setQuery(termQuery("message", "update")).execute().actionGet().getHits().totalHits(), equalTo(0l))[ CD ]
Line_5 $$ for (int i = 0; i < 500; i++) -->Line_6 $$ client().prepareIndex("test", "tweet", Integer.toString(i)).setSource(jsonBuilder().startObject().field("user", "kimchy").field("postDate", System.currentTimeMillis()).field("message", "test").endObject()).execute().actionGet()[ FD ]
Line_14 $$ SearchResponse searchResponse = client().prepareSearch().setQuery(queryStringQuery("user:kimchy")).setSize(35).setScroll(TimeValue.timeValueMinutes(2)).addSort("postDate", SortOrder.ASC).execute().actionGet()-->Line_31 $$ clearScroll(searchResponse.getScrollId())[ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_9 $$ assertThat(client().prepareSearch().setSize(0).setQuery(matchAllQuery()).execute().actionGet().getHits().totalHits(), equalTo(500l))[ CD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_8 $$ client().admin().indices().prepareRefresh().execute().actionGet()[ CD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_14 $$ SearchResponse searchResponse = client().prepareSearch().setQuery(queryStringQuery("user:kimchy")).setSize(35).setScroll(TimeValue.timeValueMinutes(2)).addSort("postDate", SortOrder.ASC).execute().actionGet()[ CD ]
Line_17 $$ for (SearchHit searchHit : searchResponse.getHits().hits()) -->Line_18 $$ Map<String, Object> map = searchHit.sourceAsMap()[ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_12 $$ assertThat(client().prepareSearch().setSize(0).setQuery(termQuery("message", "update")).execute().actionGet().getHits().totalHits(), equalTo(0l))[ CD ]
Line_22 $$ searchResponse = client().prepareSearchScroll(searchResponse.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).execute().actionGet()-->Line_31 $$ clearScroll(searchResponse.getScrollId())[ FD ]
Line_2 $$ public void testScrollAndUpdateIndex() throws Exception -->Line_11 $$ assertThat(client().prepareSearch().setSize(0).setQuery(termQuery("message", "test")).execute().actionGet().getHits().totalHits(), equalTo(500l))[ CD ]
Line_14 $$ SearchResponse searchResponse = client().prepareSearch().setQuery(queryStringQuery("user:kimchy")).setSize(35).setScroll(TimeValue.timeValueMinutes(2)).addSort("postDate", SortOrder.ASC).execute().actionGet()-->Line_22 $$ searchResponse = client().prepareSearchScroll(searchResponse.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).execute().actionGet()[ FD ]
Line_16 $$ do -->Line_22 $$ searchResponse = client().prepareSearchScroll(searchResponse.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).execute().actionGet()[ CD ]
