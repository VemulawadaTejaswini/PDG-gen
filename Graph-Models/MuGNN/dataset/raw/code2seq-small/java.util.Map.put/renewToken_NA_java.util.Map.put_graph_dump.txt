Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_26 $$ long renewTime = Math.min(id.getMaxDate(), now + tokenRenewInterval)[ CD ]
Line_22 $$ byte[] password = createPassword(token.getIdentifier(), key.getKey())-->Line_23 $$ if (!Arrays.equals(password, token.getPassword())) [ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_15 $$ if (!id.getRenewer().toString().equals(renewer)) [ FD ]
Line_28 $$ DelegationTokenInformation info = new DelegationTokenInformation(renewTime, password, trackingId)-->Line_32 $$ currentTokens.put(id, info)[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_4 $$ DataInputStream in = new DataInputStream(buf)[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_3 $$ ByteArrayInputStream buf = new ByteArrayInputStream(token.getIdentifier())[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_6 $$ id.readFields(in)[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_22 $$ byte[] password = createPassword(token.getIdentifier(), key.getKey())[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_12 $$ if ((id.getRenewer() == null) || (id.getRenewer().toString().isEmpty())) [ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_22 $$ byte[] password = createPassword(token.getIdentifier(), key.getKey())[ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_16 $$ throw new AccessControlException(renewer + " tries to renew a token with renewer " + id.getRenewer())[ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_29 $$ if (currentTokens.get(id) == null) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_33 $$ updateStoredToken(id, renewTime)[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_3 $$ ByteArrayInputStream buf = new ByteArrayInputStream(token.getIdentifier())[ CD ]
Line_26 $$ long renewTime = Math.min(id.getMaxDate(), now + tokenRenewInterval)-->Line_33 $$ updateStoredToken(id, renewTime)[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_32 $$ currentTokens.put(id, info)[ CD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_18 $$ DelegationKey key = allKeys.get(id.getMasterKeyId())[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_15 $$ if (!id.getRenewer().toString().equals(renewer)) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_28 $$ DelegationTokenInformation info = new DelegationTokenInformation(renewTime, password, trackingId)[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_5 $$ TokenIdent id = createIdentifier()[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_34 $$ return renewTime[ CD ]
Line_18 $$ DelegationKey key = allKeys.get(id.getMasterKeyId())-->Line_22 $$ byte[] password = createPassword(token.getIdentifier(), key.getKey())[ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_6 $$ id.readFields(in)[ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_9 $$ if (id.getMaxDate() < now) [ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_20 $$ throw new InvalidToken("Unable to find master key for keyId=" + id.getMasterKeyId() + " from cache. Failed to renew an unexpired token" + " with sequenceNumber=" + id.getSequenceNumber())[ FD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_32 $$ currentTokens.put(id, info)[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_23 $$ if (!Arrays.equals(password, token.getPassword())) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_27 $$ String trackingId = getTrackingIdIfEnabled(id)[ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_8 $$ long now = Time.now()[ CD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_33 $$ updateStoredToken(id, renewTime)[ FD ]
Line_18 $$ DelegationKey key = allKeys.get(id.getMasterKeyId())-->Line_19 $$ if (key == null) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_23 $$ if (!Arrays.equals(password, token.getPassword())) [ CD ]
Line_8 $$ long now = Time.now()-->Line_9 $$ if (id.getMaxDate() < now) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_15 $$ if (!id.getRenewer().toString().equals(renewer)) [ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_9 $$ if (id.getMaxDate() < now) [ CD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_12 $$ if ((id.getRenewer() == null) || (id.getRenewer().toString().isEmpty())) [ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_7 $$ LOG.info("Token renewal for identifier: " + id + "; total currentTokens " + currentTokens.size())[ CD ]
Line_4 $$ DataInputStream in = new DataInputStream(buf)-->Line_6 $$ id.readFields(in)[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_19 $$ if (key == null) [ CD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_18 $$ DelegationKey key = allKeys.get(id.getMasterKeyId())[ CD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_26 $$ long renewTime = Math.min(id.getMaxDate(), now + tokenRenewInterval)[ FD ]
Line_2 $$ public synchronized long renewToken(Token<TokenIdent> token, String renewer) throws InvalidToken, IOException -->Line_29 $$ if (currentTokens.get(id) == null) [ CD ]
Line_5 $$ TokenIdent id = createIdentifier()-->Line_27 $$ String trackingId = getTrackingIdIfEnabled(id)[ FD ]
