Line_2 $$ public DataRecord addRecord(InputStream input) throws DataStoreException --> Line_3 $$ File temporary = null [CD]
Line_3 $$ File temporary = null --> Line_5 $$ temporary = newTemporaryFile() [FD]
Line_3 $$ File temporary = null --> Line_6 $$ DataIdentifier tempId = new DataIdentifier(temporary.getName()) [FD]
Line_5 $$ temporary = newTemporaryFile() --> Line_6 $$ DataIdentifier tempId = new DataIdentifier(temporary.getName()) [FD]
Line_6 $$ DataIdentifier tempId = new DataIdentifier(temporary.getName()) --> Line_7 $$ usesIdentifier(tempId) [FD]
Line_8 $$ long length = 0 --> Line_12 $$ length = IOUtils.copyLarge(input, output) [FD]
Line_2 $$ public DataRecord addRecord(InputStream input) throws DataStoreException --> Line_12 $$ length = IOUtils.copyLarge(input, output) [FD]
Line_10 $$ OutputStream output = new DigestOutputStream(new FileOutputStream(temporary), digest) --> Line_12 $$ length = IOUtils.copyLarge(input, output) [FD]
Line_10 $$ OutputStream output = new DigestOutputStream(new FileOutputStream(temporary), digest) --> Line_14 $$ output.close() [FD]
Line_9 $$ MessageDigest digest = MessageDigest.getInstance(DIGEST) --> Line_16 $$ DataIdentifier identifier = new DataIdentifier(digest.digest()) [FD]
Line_16 $$ DataIdentifier identifier = new DataIdentifier(digest.digest()) --> Line_19 $$ usesIdentifier(identifier) [FD]
Line_17 $$ File file --> Line_20 $$ file = getFile(identifier) [FD]
Line_16 $$ DataIdentifier identifier = new DataIdentifier(digest.digest()) --> Line_20 $$ file = getFile(identifier) [FD]
Line_17 $$ File file --> Line_21 $$ System.out.println("new file name: " + file.getName()) [FD]
Line_20 $$ file = getFile(identifier) --> Line_21 $$ System.out.println("new file name: " + file.getName()) [FD]
Line_17 $$ File file --> Line_22 $$ File parent = file.getParentFile() [FD]
Line_20 $$ file = getFile(identifier) --> Line_22 $$ File parent = file.getParentFile() [FD]
Line_17 $$ File file --> Line_23 $$ System.out.println("parent file: " + file.getParentFile().getName()) [FD]
Line_20 $$ file = getFile(identifier) --> Line_23 $$ System.out.println("parent file: " + file.getParentFile().getName()) [FD]
Line_22 $$ File parent = file.getParentFile() --> Line_24 $$ if (!parent.isDirectory()) [FD]
Line_24 $$ if (!parent.isDirectory()) --> Line_25 $$ parent.mkdirs() [CD]
Line_22 $$ File parent = file.getParentFile() --> Line_25 $$ parent.mkdirs() [FD]
Line_17 $$ File file --> Line_27 $$ if (!file.exists()) [FD]
Line_20 $$ file = getFile(identifier) --> Line_27 $$ if (!file.exists()) [FD]
Line_27 $$ if (!file.exists()) --> Line_28 $$ temporary.renameTo(file) [CD]
Line_3 $$ File temporary = null --> Line_28 $$ temporary.renameTo(file) [FD]
Line_5 $$ temporary = newTemporaryFile() --> Line_28 $$ temporary.renameTo(file) [FD]
Line_17 $$ File file --> Line_28 $$ temporary.renameTo(file) [FD]
Line_20 $$ file = getFile(identifier) --> Line_28 $$ temporary.renameTo(file) [FD]
Line_27 $$ if (!file.exists()) --> Line_29 $$ if (!file.exists()) [CD]
Line_17 $$ File file --> Line_29 $$ if (!file.exists()) [FD]
Line_20 $$ file = getFile(identifier) --> Line_29 $$ if (!file.exists()) [FD]
Line_3 $$ File temporary = null --> Line_30 $$ throw new IOException("Can not rename " + temporary.getAbsolutePath() + " to " + file.getAbsolutePath() + " (media read only?)") [FD]
Line_5 $$ temporary = newTemporaryFile() --> Line_30 $$ throw new IOException("Can not rename " + temporary.getAbsolutePath() + " to " + file.getAbsolutePath() + " (media read only?)") [FD]
Line_17 $$ File file --> Line_30 $$ throw new IOException("Can not rename " + temporary.getAbsolutePath() + " to " + file.getAbsolutePath() + " (media read only?)") [FD]
Line_20 $$ file = getFile(identifier) --> Line_30 $$ throw new IOException("Can not rename " + temporary.getAbsolutePath() + " to " + file.getAbsolutePath() + " (media read only?)") [FD]
Line_27 $$ if (!file.exists()) --> Line_33 $$ long now = System.currentTimeMillis() [CD]
Line_27 $$ if (!file.exists()) --> Line_34 $$ if (file.lastModified() < now) [CD]
Line_33 $$ long now = System.currentTimeMillis() --> Line_34 $$ if (file.lastModified() < now) [FD]
Line_17 $$ File file --> Line_34 $$ if (file.lastModified() < now) [FD]
Line_20 $$ file = getFile(identifier) --> Line_34 $$ if (file.lastModified() < now) [FD]
Line_34 $$ if (file.lastModified() < now) --> Line_35 $$ file.setLastModified(now) [CD]
Line_17 $$ File file --> Line_35 $$ file.setLastModified(now) [FD]
Line_20 $$ file = getFile(identifier) --> Line_35 $$ file.setLastModified(now) [FD]
Line_33 $$ long now = System.currentTimeMillis() --> Line_35 $$ file.setLastModified(now) [FD]
Line_17 $$ File file --> Line_38 $$ if (!file.isFile()) [FD]
Line_20 $$ file = getFile(identifier) --> Line_38 $$ if (!file.isFile()) [FD]
Line_8 $$ long length = 0 --> Line_41 $$ if (file.length() != length) [FD]
Line_12 $$ length = IOUtils.copyLarge(input, output) --> Line_41 $$ if (file.length() != length) [FD]
Line_17 $$ File file --> Line_41 $$ if (file.length() != length) [FD]
Line_20 $$ file = getFile(identifier) --> Line_41 $$ if (file.length() != length) [FD]
Line_6 $$ DataIdentifier tempId = new DataIdentifier(temporary.getName()) --> Line_45 $$ inUse.remove(tempId) [FD]
Line_3 $$ File temporary = null --> Line_52 $$ if (temporary != null) [FD]
Line_5 $$ temporary = newTemporaryFile() --> Line_52 $$ if (temporary != null) [FD]
Line_52 $$ if (temporary != null) --> Line_53 $$ temporary.delete() [CD]
Line_3 $$ File temporary = null --> Line_53 $$ temporary.delete() [FD]
Line_5 $$ temporary = newTemporaryFile() --> Line_53 $$ temporary.delete() [FD]
