Line_2 $$ public void aggregate() --> Line_3 $$ Connection connection = null [CD]
Line_2 $$ public void aggregate() --> Line_4 $$ PreparedStatement prestm = null [CD]
Line_3 $$ Connection connection = null --> Line_8 $$ connection = DriverManager.getConnection(url, username, password) [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") [FD]
Line_3 $$ Connection connection = null --> Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_11 $$ ResultSet rs = prestm.executeQuery() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_11 $$ ResultSet rs = prestm.executeQuery() [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_12 $$ tableExistsResult = rs.getString(1) [FD]
Line_9 $$ String tableExistsResult = "" --> Line_12 $$ tableExistsResult = rs.getString(1) [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_13 $$ rs.close() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_14 $$ prestm.close() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_14 $$ prestm.close() [FD]
Line_9 $$ String tableExistsResult = "" --> Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) [FD]
Line_12 $$ tableExistsResult = rs.getString(1) --> Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_16 $$ String createTableSql = "" [CD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") [FD]
Line_3 $$ Connection connection = null --> Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_18 $$ rs = prestm.executeQuery() [CD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_18 $$ rs = prestm.executeQuery() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_18 $$ rs = prestm.executeQuery() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_18 $$ rs = prestm.executeQuery() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_18 $$ rs = prestm.executeQuery() [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_19 $$ createTableSql = rs.getString(2) [CD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_19 $$ createTableSql = rs.getString(2) [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_19 $$ createTableSql = rs.getString(2) [FD]
Line_16 $$ String createTableSql = "" --> Line_19 $$ createTableSql = rs.getString(2) [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_20 $$ rs.close() [CD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_20 $$ rs.close() [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_20 $$ rs.close() [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_21 $$ prestm.close() [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_21 $$ prestm.close() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_21 $$ prestm.close() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_21 $$ prestm.close() [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") [CD]
Line_16 $$ String createTableSql = "" --> Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") [CD]
Line_16 $$ String createTableSql = "" --> Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") [CD]
Line_16 $$ String createTableSql = "" --> Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [CD]
Line_16 $$ String createTableSql = "" --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [FD]
Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") --> Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_26 $$ createTableSql = matcher.replaceAll("") [CD]
Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_16 $$ String createTableSql = "" --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") --> Line_26 $$ createTableSql = matcher.replaceAll("") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [CD]
Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_16 $$ String createTableSql = "" --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_26 $$ createTableSql = matcher.replaceAll("") --> Line_27 $$ matcher = normalizePattern.matcher(createTableSql) [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [CD]
Line_25 $$ Matcher matcher = stripRelationTablePattern.matcher(createTableSql) --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_27 $$ matcher = normalizePattern.matcher(createTableSql) --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_16 $$ String createTableSql = "" --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_26 $$ createTableSql = matcher.replaceAll("") --> Line_28 $$ createTableSql = matcher.replaceAll("\n )") [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_29 $$ Statement stm = connection.createStatement() [CD]
Line_3 $$ Connection connection = null --> Line_29 $$ Statement stm = connection.createStatement() [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_29 $$ Statement stm = connection.createStatement() [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_30 $$ stm.execute(createTableSql) [CD]
Line_29 $$ Statement stm = connection.createStatement() --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_16 $$ String createTableSql = "" --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_19 $$ createTableSql = rs.getString(2) --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_22 $$ createTableSql = createTableSql.replaceAll("`" + getOrigin() + "`", "`" + getDestination() + "`") --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_23 $$ createTableSql = createTableSql.replaceAll("auto_increment", "") --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_24 $$ createTableSql = createTableSql.replaceAll("AUTO_INCREMENT", "") --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_26 $$ createTableSql = matcher.replaceAll("") --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_28 $$ createTableSql = matcher.replaceAll("\n )") --> Line_30 $$ stm.execute(createTableSql) [FD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_31 $$ logger.debug("table '" + getDestination() + "' created!") [CD]
Line_15 $$ if (StringUtils.isBlank(tableExistsResult)) --> Line_32 $$ logger.debug("table '" + getDestination() + "' already exists") [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) [FD]
Line_3 $$ Connection connection = null --> Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_35 $$ rs = prestm.executeQuery() [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_36 $$ currentRows = rs.getLong(1) [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_36 $$ currentRows = rs.getLong(1) [FD]
Line_35 $$ rs = prestm.executeQuery() --> Line_36 $$ currentRows = rs.getLong(1) [FD]
Line_33 $$ long currentRows = 0L --> Line_36 $$ currentRows = rs.getLong(1) [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_37 $$ rs.close() [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_37 $$ rs.close() [FD]
Line_35 $$ rs = prestm.executeQuery() --> Line_37 $$ rs.close() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_38 $$ prestm.close() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_38 $$ prestm.close() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_38 $$ prestm.close() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_38 $$ prestm.close() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_3 $$ Connection connection = null --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_35 $$ rs = prestm.executeQuery() --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_41 $$ rs = prestm.executeQuery() [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_43 $$ from = rs.getTimestamp(1) [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_43 $$ from = rs.getTimestamp(1) [FD]
Line_35 $$ rs = prestm.executeQuery() --> Line_43 $$ from = rs.getTimestamp(1) [FD]
Line_41 $$ rs = prestm.executeQuery() --> Line_43 $$ from = rs.getTimestamp(1) [FD]
Line_42 $$ Date from = null --> Line_43 $$ from = rs.getTimestamp(1) [FD]
Line_11 $$ ResultSet rs = prestm.executeQuery() --> Line_44 $$ rs.close() [FD]
Line_18 $$ rs = prestm.executeQuery() --> Line_44 $$ rs.close() [FD]
Line_35 $$ rs = prestm.executeQuery() --> Line_44 $$ rs.close() [FD]
Line_41 $$ rs = prestm.executeQuery() --> Line_44 $$ rs.close() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_45 $$ prestm.close() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_45 $$ prestm.close() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_45 $$ prestm.close() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_45 $$ prestm.close() [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_45 $$ prestm.close() [FD]
Line_42 $$ Date from = null --> Line_48 $$ fromStr = sdf.format(from) [FD]
Line_43 $$ from = rs.getTimestamp(1) --> Line_48 $$ fromStr = sdf.format(from) [FD]
Line_47 $$ String fromStr = null --> Line_48 $$ fromStr = sdf.format(from) [FD]
Line_46 $$ SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss") --> Line_48 $$ fromStr = sdf.format(from) [FD]
Line_33 $$ long currentRows = 0L --> Line_50 $$ if (currentRows > 0) [FD]
Line_36 $$ currentRows = rs.getLong(1) --> Line_50 $$ if (currentRows > 0) [FD]
Line_50 $$ if (currentRows > 0) --> Line_51 $$ connection.setAutoCommit(false) [CD]
Line_3 $$ Connection connection = null --> Line_51 $$ connection.setAutoCommit(false) [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_51 $$ connection.setAutoCommit(false) [FD]
Line_50 $$ if (currentRows > 0) --> Line_52 $$ if (from != null && fromStr != null) [CD]
Line_52 $$ if (from != null && fromStr != null) --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_3 $$ Connection connection = null --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [FD]
Line_52 $$ if (from != null && fromStr != null) --> Line_54 $$ logger.debug("Query: INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") [CD]
Line_52 $$ if (from != null && fromStr != null) --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_3 $$ Connection connection = null --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) [FD]
Line_52 $$ if (from != null && fromStr != null) --> Line_57 $$ logger.debug("Query: INSERT INTO " + destination + " SELECT * FROM " + origin) [CD]
Line_50 $$ if (currentRows > 0) --> Line_59 $$ int rows = prestm.executeUpdate() [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) --> Line_59 $$ int rows = prestm.executeUpdate() [FD]
Line_50 $$ if (currentRows > 0) --> Line_60 $$ prestm.close() [CD]
Line_4 $$ PreparedStatement prestm = null --> Line_60 $$ prestm.close() [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_60 $$ prestm.close() [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_60 $$ prestm.close() [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_60 $$ prestm.close() [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_60 $$ prestm.close() [FD]
Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") --> Line_60 $$ prestm.close() [FD]
Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) --> Line_60 $$ prestm.close() [FD]
Line_50 $$ if (currentRows > 0) --> Line_61 $$ logger.info(" > " + rows + " rows aggregated") [CD]
Line_50 $$ if (currentRows > 0) --> Line_62 $$ connection.commit() [CD]
Line_3 $$ Connection connection = null --> Line_62 $$ connection.commit() [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_62 $$ connection.commit() [FD]
Line_50 $$ if (currentRows > 0) --> Line_63 $$ logger.info("no aggregation need") [CD]
Line_3 $$ Connection connection = null --> Line_69 $$ connection.rollback() [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_69 $$ connection.rollback() [FD]
Line_3 $$ Connection connection = null --> Line_76 $$ connection.rollback() [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_76 $$ connection.rollback() [FD]
Line_4 $$ PreparedStatement prestm = null --> Line_81 $$ if (prestm != null) [FD]
Line_10 $$ prestm = connection.prepareStatement("show tables from " + schema + " like '" + getDestination() + "';") --> Line_81 $$ if (prestm != null) [FD]
Line_17 $$ prestm = connection.prepareStatement("show create table " + getOrigin() + ";") --> Line_81 $$ if (prestm != null) [FD]
Line_34 $$ prestm = connection.prepareStatement("select count(*) from " + origin) --> Line_81 $$ if (prestm != null) [FD]
Line_40 $$ prestm = connection.prepareStatement("select max(d_insDate) from " + destination) --> Line_81 $$ if (prestm != null) [FD]
Line_53 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin + " WHERE d_insDate > '" + fromStr + "'") --> Line_81 $$ if (prestm != null) [FD]
Line_56 $$ prestm = connection.prepareStatement("INSERT INTO " + destination + " SELECT * FROM " + origin) --> Line_81 $$ if (prestm != null) [FD]
Line_3 $$ Connection connection = null --> Line_85 $$ if (connection != null) [FD]
Line_8 $$ connection = DriverManager.getConnection(url, username, password) --> Line_85 $$ if (connection != null) [FD]
