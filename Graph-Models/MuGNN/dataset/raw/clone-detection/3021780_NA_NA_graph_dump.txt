Line_2 $$ private Integer getInt(String sequence) throws NoSuchSequenceException --> Line_3 $$ Connection conn = null [CD]
Line_2 $$ private Integer getInt(String sequence) throws NoSuchSequenceException --> Line_4 $$ PreparedStatement read = null [CD]
Line_2 $$ private Integer getInt(String sequence) throws NoSuchSequenceException --> Line_5 $$ PreparedStatement write = null [CD]
Line_2 $$ private Integer getInt(String sequence) throws NoSuchSequenceException --> Line_6 $$ boolean success = false [CD]
Line_3 $$ Connection conn = null --> Line_8 $$ conn = ds.getConnection() [FD]
Line_3 $$ Connection conn = null --> Line_9 $$ conn.setTransactionIsolation(conn.TRANSACTION_REPEATABLE_READ) [FD]
Line_8 $$ conn = ds.getConnection() --> Line_9 $$ conn.setTransactionIsolation(conn.TRANSACTION_REPEATABLE_READ) [FD]
Line_3 $$ Connection conn = null --> Line_10 $$ conn.setAutoCommit(false) [FD]
Line_8 $$ conn = ds.getConnection() --> Line_10 $$ conn.setAutoCommit(false) [FD]
Line_4 $$ PreparedStatement read = null --> Line_11 $$ read = conn.prepareStatement(SELECT_SQL) [FD]
Line_3 $$ Connection conn = null --> Line_11 $$ read = conn.prepareStatement(SELECT_SQL) [FD]
Line_8 $$ conn = ds.getConnection() --> Line_11 $$ read = conn.prepareStatement(SELECT_SQL) [FD]
Line_4 $$ PreparedStatement read = null --> Line_12 $$ read.setString(1, sequence) [FD]
Line_11 $$ read = conn.prepareStatement(SELECT_SQL) --> Line_12 $$ read.setString(1, sequence) [FD]
Line_2 $$ private Integer getInt(String sequence) throws NoSuchSequenceException --> Line_12 $$ read.setString(1, sequence) [FD]
Line_4 $$ PreparedStatement read = null --> Line_13 $$ ResultSet readRs = read.executeQuery() [FD]
Line_11 $$ read = conn.prepareStatement(SELECT_SQL) --> Line_13 $$ ResultSet readRs = read.executeQuery() [FD]
Line_13 $$ ResultSet readRs = read.executeQuery() --> Line_14 $$ if (!readRs.next()) [FD]
Line_13 $$ ResultSet readRs = read.executeQuery() --> Line_17 $$ int currentSequenceId = readRs.getInt(1) [FD]
Line_13 $$ ResultSet readRs = read.executeQuery() --> Line_18 $$ int currentSequenceValue = readRs.getInt(2) [FD]
Line_5 $$ PreparedStatement write = null --> Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) [FD]
Line_3 $$ Connection conn = null --> Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) [FD]
Line_8 $$ conn = ds.getConnection() --> Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) [FD]
Line_5 $$ PreparedStatement write = null --> Line_21 $$ write.setInt(1, currentSequenceValue + 1) [FD]
Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) --> Line_21 $$ write.setInt(1, currentSequenceValue + 1) [FD]
Line_5 $$ PreparedStatement write = null --> Line_22 $$ write.setInt(2, currentSequenceId) [FD]
Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) --> Line_22 $$ write.setInt(2, currentSequenceId) [FD]
Line_17 $$ int currentSequenceId = readRs.getInt(1) --> Line_22 $$ write.setInt(2, currentSequenceId) [FD]
Line_5 $$ PreparedStatement write = null --> Line_23 $$ int rowsAffected = write.executeUpdate() [FD]
Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) --> Line_23 $$ int rowsAffected = write.executeUpdate() [FD]
Line_23 $$ int rowsAffected = write.executeUpdate() --> Line_24 $$ if (rowsAffected == 1) [FD]
Line_24 $$ if (rowsAffected == 1) --> Line_25 $$ success = true [CD]
Line_6 $$ boolean success = false --> Line_25 $$ success = true [FD]
Line_24 $$ if (rowsAffected == 1) --> Line_26 $$ return currentSequenceValueInteger [CD]
Line_24 $$ if (rowsAffected == 1) --> Line_28 $$ logger.error("Something strange has happened.  The row count was not 1, but was " + rowsAffected) [CD]
Line_24 $$ if (rowsAffected == 1) --> Line_29 $$ return currentSequenceValueInteger [CD]
Line_4 $$ PreparedStatement read = null --> Line_36 $$ if (read != null) [FD]
Line_11 $$ read = conn.prepareStatement(SELECT_SQL) --> Line_36 $$ if (read != null) [FD]
Line_4 $$ PreparedStatement read = null --> Line_38 $$ read.close() [FD]
Line_11 $$ read = conn.prepareStatement(SELECT_SQL) --> Line_38 $$ read.close() [FD]
Line_5 $$ PreparedStatement write = null --> Line_42 $$ if (write != null) [FD]
Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) --> Line_42 $$ if (write != null) [FD]
Line_5 $$ PreparedStatement write = null --> Line_44 $$ write.close() [FD]
Line_20 $$ write = conn.prepareStatement(UPDATE_SQL) --> Line_44 $$ write.close() [FD]
Line_3 $$ Connection conn = null --> Line_48 $$ if (conn != null) [FD]
Line_8 $$ conn = ds.getConnection() --> Line_48 $$ if (conn != null) [FD]
Line_50 $$ if (success) --> Line_51 $$ conn.commit() [CD]
Line_3 $$ Connection conn = null --> Line_51 $$ conn.commit() [FD]
Line_8 $$ conn = ds.getConnection() --> Line_51 $$ conn.commit() [FD]
Line_50 $$ if (success) --> Line_53 $$ conn.rollback() [CD]
Line_3 $$ Connection conn = null --> Line_53 $$ conn.rollback() [FD]
Line_8 $$ conn = ds.getConnection() --> Line_53 $$ conn.rollback() [FD]
Line_3 $$ Connection conn = null --> Line_55 $$ conn.close() [FD]
Line_8 $$ conn = ds.getConnection() --> Line_55 $$ conn.close() [FD]
