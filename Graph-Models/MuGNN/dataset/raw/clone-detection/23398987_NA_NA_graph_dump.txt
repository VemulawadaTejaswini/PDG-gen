Line_2 $$ public void updateItems(List<InputQueueItem> toUpdate) throws DatabaseException --> Line_3 $$ if (toUpdate == null) [CD]
Line_2 $$ public void updateItems(List<InputQueueItem> toUpdate) throws DatabaseException --> Line_3 $$ if (toUpdate == null) [FD]
Line_11 $$ PreparedStatement selectCount = getConnection().prepareStatement(SELECT_NUMBER_ITEMS_STATEMENT) --> Line_12 $$ ResultSet rs = selectCount.executeQuery() [FD]
Line_12 $$ ResultSet rs = selectCount.executeQuery() --> Line_13 $$ rs.next() [FD]
Line_12 $$ ResultSet rs = selectCount.executeQuery() --> Line_14 $$ int totalBefore = rs.getInt(1) [FD]
Line_10 $$ PreparedStatement deleteSt = getConnection().prepareStatement(DELETE_ALL_ITEMS_STATEMENT) --> Line_15 $$ int deleted = deleteSt.executeUpdate() [FD]
Line_16 $$ int updated = 0 --> Line_18 $$ updated += getItemInsertStatement(item).executeUpdate() [FD]
Line_17 $$ for (InputQueueItem item : toUpdate) --> Line_18 $$ updated += getItemInsertStatement(item).executeUpdate() [FD]
Line_2 $$ public void updateItems(List<InputQueueItem> toUpdate) throws DatabaseException --> Line_20 $$ if (totalBefore == deleted && updated == toUpdate.size()) [FD]
Line_20 $$ if (totalBefore == deleted && updated == toUpdate.size()) --> Line_21 $$ getConnection().commit() [CD]
Line_20 $$ if (totalBefore == deleted && updated == toUpdate.size()) --> Line_22 $$ LOGGER.debug("DB has been updated. Queries: \"" + selectCount + "\" and \"" + deleteSt + "\".") [CD]
Line_20 $$ if (totalBefore == deleted && updated == toUpdate.size()) --> Line_24 $$ getConnection().rollback() [CD]
Line_20 $$ if (totalBefore == deleted && updated == toUpdate.size()) --> Line_25 $$ LOGGER.error("DB has not been updated -> rollback! Queries: \"" + selectCount + "\" and \"" + deleteSt + "\".") [CD]
