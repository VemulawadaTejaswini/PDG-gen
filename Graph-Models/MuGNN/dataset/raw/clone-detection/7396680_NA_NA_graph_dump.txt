Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_3 $$ dstFile = checkDest(srcDir.getName(), dstFS, dstFile, false) [CD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_3 $$ dstFile = checkDest(srcDir.getName(), dstFS, dstFile, false) [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_4 $$ if (!srcFS.getFileStatus(srcDir).isDir()) [CD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_4 $$ if (!srcFS.getFileStatus(srcDir).isDir()) [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_5 $$ OutputStream out = dstFS.create(dstFile) [CD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_5 $$ OutputStream out = dstFS.create(dstFile) [FD]
Line_3 $$ dstFile = checkDest(srcDir.getName(), dstFS, dstFile, false) --> Line_5 $$ OutputStream out = dstFS.create(dstFile) [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_7 $$ FileStatus contents[] = srcFS.listStatus(srcDir) [FD]
Line_8 $$ for (int i = 0; i < contents.length; i++) --> Line_9 $$ if (!contents[i].isDir()) [CD]
Line_9 $$ if (!contents[i].isDir()) --> Line_10 $$ InputStream in = srcFS.open(contents[i].getPath()) [CD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_10 $$ InputStream in = srcFS.open(contents[i].getPath()) [FD]
Line_10 $$ InputStream in = srcFS.open(contents[i].getPath()) --> Line_12 $$ IOUtils.copyBytes(in, out, conf, false) [FD]
Line_5 $$ OutputStream out = dstFS.create(dstFile) --> Line_12 $$ IOUtils.copyBytes(in, out, conf, false) [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_12 $$ IOUtils.copyBytes(in, out, conf, false) [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_13 $$ out.write(addString.getBytes("UTF-8")) [FD]
Line_5 $$ OutputStream out = dstFS.create(dstFile) --> Line_13 $$ out.write(addString.getBytes("UTF-8")) [FD]
Line_10 $$ InputStream in = srcFS.open(contents[i].getPath()) --> Line_15 $$ in.close() [FD]
Line_5 $$ OutputStream out = dstFS.create(dstFile) --> Line_20 $$ out.close() [FD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_22 $$ if (deleteSource) [CD]
Line_22 $$ if (deleteSource) --> Line_23 $$ return srcFS.delete(srcDir, true) [CD]
Line_2 $$ public static boolean copyMerge(FileSystem srcFS, Path srcDir, FileSystem dstFS, Path dstFile, boolean deleteSource, Configuration conf, String addString) throws IOException --> Line_23 $$ return srcFS.delete(srcDir, true) [FD]
Line_22 $$ if (deleteSource) --> Line_25 $$ return true [CD]
