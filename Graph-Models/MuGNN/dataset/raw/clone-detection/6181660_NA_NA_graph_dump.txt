Line_2 $$ public void run() --> Line_3 $$ FTPClient ftp = null [CD]
Line_3 $$ FTPClient ftp = null --> Line_7 $$ ftp = new FTPClient() [FD]
Line_3 $$ FTPClient ftp = null --> Line_9 $$ ftp.connect(etcProperties.getHostname()) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_9 $$ ftp.connect(etcProperties.getHostname()) [FD]
Line_5 $$ StarkHhDownloaderEtcProperties etcProperties = new StarkHhDownloaderEtcProperties(getUri()) --> Line_9 $$ ftp.connect(etcProperties.getHostname()) [FD]
Line_5 $$ StarkHhDownloaderEtcProperties etcProperties = new StarkHhDownloaderEtcProperties(getUri()) --> Line_10 $$ log("Connecting to ftp server at " + etcProperties.getHostname() + ".") [FD]
Line_3 $$ FTPClient ftp = null --> Line_11 $$ log("Server replied with '" + ftp.getReplyString() + "'.") [FD]
Line_7 $$ ftp = new FTPClient() --> Line_11 $$ log("Server replied with '" + ftp.getReplyString() + "'.") [FD]
Line_8 $$ int reply --> Line_12 $$ reply = ftp.getReplyCode() [FD]
Line_3 $$ FTPClient ftp = null --> Line_12 $$ reply = ftp.getReplyCode() [FD]
Line_7 $$ ftp = new FTPClient() --> Line_12 $$ reply = ftp.getReplyCode() [FD]
Line_8 $$ int reply --> Line_13 $$ if (!FTPReply.isPositiveCompletion(reply)) [FD]
Line_12 $$ reply = ftp.getReplyCode() --> Line_13 $$ if (!FTPReply.isPositiveCompletion(reply)) [FD]
Line_3 $$ FTPClient ftp = null --> Line_17 $$ ftp.login(etcProperties.getUsername(), etcProperties.getPassword()) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_17 $$ ftp.login(etcProperties.getUsername(), etcProperties.getPassword()) [FD]
Line_5 $$ StarkHhDownloaderEtcProperties etcProperties = new StarkHhDownloaderEtcProperties(getUri()) --> Line_17 $$ ftp.login(etcProperties.getUsername(), etcProperties.getPassword()) [FD]
Line_3 $$ FTPClient ftp = null --> Line_18 $$ log("Server replied with '" + ftp.getReplyString() + "'.") [FD]
Line_7 $$ ftp = new FTPClient() --> Line_18 $$ log("Server replied with '" + ftp.getReplyString() + "'.") [FD]
Line_5 $$ StarkHhDownloaderEtcProperties etcProperties = new StarkHhDownloaderEtcProperties(getUri()) --> Line_19 $$ List<String> directories = etcProperties.getDirectories() [FD]
Line_19 $$ List<String> directories = etcProperties.getDirectories() --> Line_20 $$ for (int i = 0; i < directories.size(); i++) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_21 $$ log("Checking the directory '" + directories.get(i) + "'.") [CD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_21 $$ log("Checking the directory '" + directories.get(i) + "'.") [FD]
Line_19 $$ List<String> directories = etcProperties.getDirectories() --> Line_21 $$ log("Checking the directory '" + directories.get(i) + "'.") [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_22 $$ boolean found = false [CD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) [CD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) [FD]
Line_3 $$ FTPClient ftp = null --> Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) [FD]
Line_19 $$ List<String> directories = etcProperties.getDirectories() --> Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_24 $$ List<FTPFile> files = Arrays.asList(filesArray) [CD]
Line_23 $$ FTPFile[] filesArray = ftp.listFiles(directories.get(i)) --> Line_24 $$ List<FTPFile> files = Arrays.asList(filesArray) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() [CD]
Line_24 $$ List<FTPFile> files = Arrays.asList(filesArray) --> Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() [FD]
Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() --> Line_27 $$ if (file2.getTimestamp().getTime().equals(file1.getTimestamp().getTime())) [CD]
Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() --> Line_27 $$ if (file2.getTimestamp().getTime().equals(file1.getTimestamp().getTime())) [FD]
Line_27 $$ if (file2.getTimestamp().getTime().equals(file1.getTimestamp().getTime())) --> Line_28 $$ return file2.getName().compareTo(file1.getName()) [CD]
Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() --> Line_28 $$ return file2.getName().compareTo(file1.getName()) [FD]
Line_27 $$ if (file2.getTimestamp().getTime().equals(file1.getTimestamp().getTime())) --> Line_30 $$ return file1.getTimestamp().getTime().compareTo(file2.getTimestamp().getTime()) [CD]
Line_25 $$ Collections.sort(files, new Comparator<FTPFile>() --> Line_30 $$ return file1.getTimestamp().getTime().compareTo(file2.getTimestamp().getTime()) [FD]
Line_34 $$ for (FTPFile file : files) --> Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) [FD]
Line_6 $$ StarkHhDownloaderVarProperties varProperties = new StarkHhDownloaderVarProperties(getUri()) --> Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) [FD]
Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) --> Line_36 $$ String fileName = directories.get(i) + "\\" + file.getName() [CD]
Line_19 $$ List<String> directories = etcProperties.getDirectories() --> Line_36 $$ String fileName = directories.get(i) + "\\" + file.getName() [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_36 $$ String fileName = directories.get(i) + "\\" + file.getName() [FD]
Line_34 $$ for (FTPFile file : files) --> Line_36 $$ String fileName = directories.get(i) + "\\" + file.getName() [FD]
Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) --> Line_37 $$ if (file.getSize() == 0) [CD]
Line_34 $$ for (FTPFile file : files) --> Line_37 $$ if (file.getSize() == 0) [FD]
Line_37 $$ if (file.getSize() == 0) --> Line_38 $$ log("Ignoring '" + fileName + "'because it has zero length") [CD]
Line_37 $$ if (file.getSize() == 0) --> Line_40 $$ log("Attempting to download '" + fileName + "'.") [CD]
Line_37 $$ if (file.getSize() == 0) --> Line_41 $$ InputStream is = ftp.retrieveFileStream(fileName) [CD]
Line_3 $$ FTPClient ftp = null --> Line_41 $$ InputStream is = ftp.retrieveFileStream(fileName) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_41 $$ InputStream is = ftp.retrieveFileStream(fileName) [FD]
Line_36 $$ String fileName = directories.get(i) + "\\" + file.getName() --> Line_41 $$ InputStream is = ftp.retrieveFileStream(fileName) [FD]
Line_37 $$ if (file.getSize() == 0) --> Line_42 $$ if (is == null) [CD]
Line_41 $$ InputStream is = ftp.retrieveFileStream(fileName) --> Line_42 $$ if (is == null) [FD]
Line_42 $$ if (is == null) --> Line_43 $$ reply = ftp.getReplyCode() [CD]
Line_3 $$ FTPClient ftp = null --> Line_43 $$ reply = ftp.getReplyCode() [FD]
Line_7 $$ ftp = new FTPClient() --> Line_43 $$ reply = ftp.getReplyCode() [FD]
Line_34 $$ for (FTPFile file : files) --> Line_44 $$ throw UserException.newOk("Can't download the file '" + file.getName() + "', server says: " + reply + ".") [FD]
Line_37 $$ if (file.getSize() == 0) --> Line_46 $$ log("File stream obtained successfully.") [CD]
Line_34 $$ for (FTPFile file : files) --> Line_47 $$ hhImporter = new HhDataImportProcess(getContract().getId(), new Long(0), is, fileName + ".df2", file.getSize()) [FD]
Line_37 $$ if (file.getSize() == 0) --> Line_48 $$ hhImporter.run() [CD]
Line_37 $$ if (file.getSize() == 0) --> Line_49 $$ List<VFMessage> messages = hhImporter.getMessages() [CD]
Line_37 $$ if (file.getSize() == 0) --> Line_51 $$ if (messages.size() > 0) [CD]
Line_49 $$ List<VFMessage> messages = hhImporter.getMessages() --> Line_51 $$ if (messages.size() > 0) [FD]
Line_52 $$ for (VFMessage message : messages) --> Line_53 $$ log(message.getDescription()) [FD]
Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) --> Line_58 $$ if (!ftp.completePendingCommand()) [CD]
Line_3 $$ FTPClient ftp = null --> Line_58 $$ if (!ftp.completePendingCommand()) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_58 $$ if (!ftp.completePendingCommand()) [FD]
Line_3 $$ FTPClient ftp = null --> Line_59 $$ throw UserException.newOk("Couldn't complete ftp transaction: " + ftp.getReplyString()) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_59 $$ throw UserException.newOk("Couldn't complete ftp transaction: " + ftp.getReplyString()) [FD]
Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) --> Line_61 $$ varProperties.setLastImportDate(i, new MonadDate(file.getTimestamp().getTime())) [CD]
Line_6 $$ StarkHhDownloaderVarProperties varProperties = new StarkHhDownloaderVarProperties(getUri()) --> Line_61 $$ varProperties.setLastImportDate(i, new MonadDate(file.getTimestamp().getTime())) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_61 $$ varProperties.setLastImportDate(i, new MonadDate(file.getTimestamp().getTime())) [FD]
Line_34 $$ for (FTPFile file : files) --> Line_61 $$ varProperties.setLastImportDate(i, new MonadDate(file.getTimestamp().getTime())) [FD]
Line_35 $$ if (file.getType() == FTPFile.FILE_TYPE && (varProperties.getLastImportDate(i) == null ? true : (file.getTimestamp().getTime().equals(varProperties.getLastImportDate(i).getDate()) ? file.getName().compareTo(varProperties.getLastImportName(i)) < 0 : file.getTimestamp().getTime().after(varProperties.getLastImportDate(i).getDate())))) --> Line_62 $$ varProperties.setLastImportName(i, file.getName()) [CD]
Line_6 $$ StarkHhDownloaderVarProperties varProperties = new StarkHhDownloaderVarProperties(getUri()) --> Line_62 $$ varProperties.setLastImportName(i, file.getName()) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_62 $$ varProperties.setLastImportName(i, file.getName()) [FD]
Line_34 $$ for (FTPFile file : files) --> Line_62 $$ varProperties.setLastImportName(i, file.getName()) [FD]
Line_20 $$ for (int i = 0; i < directories.size(); i++) --> Line_66 $$ if (!found) [CD]
Line_22 $$ boolean found = false --> Line_66 $$ if (!found) [FD]
Line_66 $$ if (!found) --> Line_67 $$ log("No new files found.") [CD]
Line_3 $$ FTPClient ftp = null --> Line_96 $$ if (ftp != null && ftp.isConnected()) [FD]
Line_7 $$ ftp = new FTPClient() --> Line_96 $$ if (ftp != null && ftp.isConnected()) [FD]
Line_3 $$ FTPClient ftp = null --> Line_98 $$ ftp.logout() [FD]
Line_7 $$ ftp = new FTPClient() --> Line_98 $$ ftp.logout() [FD]
Line_3 $$ FTPClient ftp = null --> Line_99 $$ ftp.disconnect() [FD]
Line_7 $$ ftp = new FTPClient() --> Line_99 $$ ftp.disconnect() [FD]
